var $jscomp={scope:{},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return"jscomp_symbol_"+a+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();if(a[$jscomp.global.Symbol.iterator])return a[$jscomp.global.Symbol.iterator]();var e=0;return{next:function(){return e==a.length?{done:!0}:{done:!1,value:a[e++]}}}};
$jscomp.arrayFromIterator=function(a){for(var e,h=[];!(e=a.next()).done;)h.push(e.value);return h};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.inherits=function(a,e){function h(){}h.prototype=e.prototype;a.prototype=new h;a.prototype.constructor=a;for(var b in e)if($jscomp.global.Object.defineProperties){var g=$jscomp.global.Object.getOwnPropertyDescriptor(e,b);g&&$jscomp.global.Object.defineProperty(a,b,g)}else a[b]=e[b]};$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};
$jscomp.array.arrayIterator_=function(a,e){a instanceof String&&(a=String(a));var h=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={},g=(b.next=function(){if(h<a.length){var b=h++;return{value:e(b,a[b]),done:!1}}g.next=$jscomp.array.done_;return $jscomp.array.done_()},b[Symbol.iterator]=function(){return g},b);return g};
$jscomp.array.findInternal_=function(a,e,h){a instanceof String&&(a=String(a));for(var b=a.length,g=0;g<b;g++){var c=a[g];if(e.call(h,c,g,a))return{i:g,v:c}}return{i:-1,v:void 0}};
$jscomp.array.from=function(a,e,h){e=void 0===e?function(b){return b}:e;var b=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(a[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=a[Symbol.iterator]();for(var g;!(g=a.next()).done;)b.push(e.call(h,g.value))}else{g=a.length;for(var c=0;c<g;c++)b.push(e.call(h,a[c]))}return b};$jscomp.array.of=function(a){for(var e=[],h=0;h<arguments.length;++h)e[h-0]=arguments[h];return $jscomp.array.from(e)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(a,e){return[a,e]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(a){return a})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(a,e){return e})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(a,e,h){var b=this.length;a=Number(a);e=Number(e);h=Number(null!=h?h:b);if(a<e)for(h=Math.min(h,b);e<h;)e in this?this[a++]=this[e++]:(delete this[a++],e++);else for(h=Math.min(h,b+e-a),a+=h-e;h>e;)--h in this?this[--a]=this[h]:delete this[a];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(a,e,h){null!=h&&a.length||(h=this.length||0);h=Number(h);for(e=Number((void 0===e?0:e)||0);e<h;e++)this[e]=a;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(a,e){return $jscomp.array.findInternal_(this,a,e).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(a,e){return $jscomp.array.findInternal_(this,a,e).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(a){a=void 0===a?[]:a;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next())e=e.value,this.set(e[0],e[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var a=$jscomp.global.Map;if(!a||!a.prototype.entries||!Object.seal)return!1;try{var e=Object.seal({x:4}),h=new a($jscomp.makeIterator([[e,"s"]]));if("s"!=h.get(e)||1!=h.size||h.get({x:4})||h.set({x:4},"t")!=h||2!=h.size)return!1;var b=h.entries(),g=b.next();if(g.done||g.value[0]!=e||"s"!=g.value[1])return!1;g=b.next();return g.done||4!=g.value[0].x||"t"!=g.value[1]||!b.next().done?!1:!0}catch(c){return!1}};
$jscomp.Map.createHead_=function(){var a={};return a.previous=a.next=a.head=a};$jscomp.Map.getId_=function(a){if(!(a instanceof Object))return String(a);$jscomp.Map.key_ in a||a instanceof Object&&Object.isExtensible&&Object.isExtensible(a)&&$jscomp.Map.defineProperty_(a,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in a?a[$jscomp.Map.key_]:" "+a};
$jscomp.Map.prototype.set=function(a,e){var h=this.maybeGetEntry_(a),b=h.id,g=h.list,h=h.entry;g||(g=this.data_[b]=[]);h?h.value=e:(h={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:e},g.push(h),this.head_.previous.next=h,this.head_.previous=h,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(a){var e=this.maybeGetEntry_(a);a=e.id;var h=e.list,b=e.index;return(e=e.entry)&&h?(h.splice(b,1),h.length||delete this.data_[a],e.previous.next=e.next,e.next.previous=e.previous,e.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(a){return!!this.maybeGetEntry_(a).entry};
$jscomp.Map.prototype.get=function(a){return(a=this.maybeGetEntry_(a).entry)&&a.value};$jscomp.Map.prototype.maybeGetEntry_=function(a){var e=$jscomp.Map.getId_(a),h=this.data_[e];if(h)for(var b=0;b<h.length;b++){var g=h[b];if(a!==a&&g.key!==g.key||a===g.key)return{id:e,list:h,index:b,entry:g}}return{id:e,list:h,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(a){return[a.key,a.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(a){return a.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(a){return a.value})};$jscomp.Map.prototype.forEach=function(a,e){for(var h=$jscomp.makeIterator(this.entries()),b=h.next();!b.done;b=h.next())b=b.value,a.call(e,b[1],b[0],this)};
$jscomp.Map.prototype.iter_=function(a){var e=this,h=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={};return b.next=function(){if(h){for(;h.head!=e.head_;)h=h.previous;for(;h.next!=h.head;)return h=h.next,{done:!1,value:a(h)};h=null}return{done:!0,value:void 0}},b[Symbol.iterator]=function(){return this},b};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(a,e,h){Object.defineProperty(a,e,{value:String(h)})}:function(a,e,h){a[e]=String(h)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(a){a=Number(a)>>>0;if(0===a)return 32;var e=0;0===(a&4294901760)&&(a<<=16,e+=16);0===(a&4278190080)&&(a<<=8,e+=8);0===(a&4026531840)&&(a<<=4,e+=4);0===(a&3221225472)&&(a<<=2,e+=2);0===(a&2147483648)&&e++;return e};$jscomp.math.imul=function(a,e){a=Number(a);e=Number(e);var h=a&65535,b=e&65535;return h*b+((a>>>16&65535)*b+h*(e>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1};
$jscomp.math.log10=function(a){return Math.log(a)/Math.LN10};$jscomp.math.log2=function(a){return Math.log(a)/Math.LN2};$jscomp.math.log1p=function(a){a=Number(a);if(.25>a&&-.25<a){for(var e=a,h=1,b=a,g=0,c=1;g!=b;)e*=a,c*=-1,b=(g=b)+c*e/++h;return b}return Math.log(1+a)};$jscomp.math.expm1=function(a){a=Number(a);if(.25>a&&-.25<a){for(var e=a,h=1,b=a,g=0;g!=b;)e*=a/++h,b=(g=b)+e;return b}return Math.exp(a)-1};$jscomp.math.cosh=function(a){a=Number(a);return(Math.exp(a)+Math.exp(-a))/2};
$jscomp.math.sinh=function(a){a=Number(a);return 0===a?a:(Math.exp(a)-Math.exp(-a))/2};$jscomp.math.tanh=function(a){a=Number(a);if(0===a)return a;var e=Math.exp(2*-Math.abs(a)),e=(1-e)/(1+e);return 0>a?-e:e};$jscomp.math.acosh=function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))};$jscomp.math.asinh=function(a){a=Number(a);if(0===a)return a;var e=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return 0>a?-e:e};
$jscomp.math.atanh=function(a){a=Number(a);return($jscomp.math.log1p(a)-$jscomp.math.log1p(-a))/2};
$jscomp.math.hypot=function(a,e,h){for(var b=[],g=2;g<arguments.length;++g)b[g-2]=arguments[g];a=Number(a);e=Number(e);for(var c=Math.max(Math.abs(a),Math.abs(e)),d=$jscomp.makeIterator(b),g=d.next();!g.done;g=d.next())c=Math.max(c,Math.abs(g.value));if(1E100<c||1E-100>c){a/=c;e/=c;d=a*a+e*e;b=$jscomp.makeIterator(b);for(g=b.next();!g.done;g=b.next())g=g.value,g=Number(g)/c,d+=g*g;return Math.sqrt(d)*c}c=a*a+e*e;b=$jscomp.makeIterator(b);for(g=b.next();!g.done;g=b.next())g=g.value,g=Number(g),c+=
g*g;return Math.sqrt(c)};$jscomp.math.trunc=function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var e=Math.floor(Math.abs(a));return 0>a?-e:e};$jscomp.math.cbrt=function(a){if(0===a)return a;a=Number(a);var e=Math.pow(Math.abs(a),1/3);return 0>a?-e:e};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a};
$jscomp.number.isInteger=function(a){return $jscomp.number.isFinite(a)?a===Math.floor(a):!1};$jscomp.number.isNaN=function(a){return"number"===typeof a&&isNaN(a)};$jscomp.number.isSafeInteger=function(a){return $jscomp.number.isInteger(a)&&Math.abs(a)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(a,e){for(var h=[],b=1;b<arguments.length;++b)h[b-1]=arguments[b];h=$jscomp.makeIterator(h);for(b=h.next();!b.done;b=h.next())if(b=b.value)for(var g in b)Object.prototype.hasOwnProperty.call(b,g)&&(a[g]=b[g]);return a};$jscomp.object.is=function(a,e){return a===e?0!==a||1/a===1/e:a!==a&&e!==e};$jscomp.Set=function(a){a=void 0===a?[]:a;this.map_=new $jscomp.Map;if(a){a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next())this.add(e.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var a=$jscomp.global.Set;if(!a||!a.prototype.entries||!Object.seal)return!1;var e=Object.seal({x:4}),a=new a($jscomp.makeIterator([e]));if(a.has(e)||1!=a.size||a.add(e)!=a||1!=a.size||a.add({x:4})!=a||2!=a.size)return!1;var a=a.entries(),h=a.next();if(h.done||h.value[0]!=e||h.value[1]!=e)return!1;h=a.next();return h.done||h.value[0]==e||4!=h.value[0].x||h.value[1]!=h.value[0]?!1:a.next().done};
$jscomp.Set.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(a){return this.map_.has(a)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(a,e){var h=this;this.map_.forEach(function(b){return a.call(e,b,b,h)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(a,e){if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(a){for(var e=[],h=0;h<arguments.length;++h)e[h-0]=arguments[h];for(var h="",e=$jscomp.makeIterator(e),b=e.next();!b.done;b=e.next()){b=b.value;b=+b;if(0>b||1114111<b||b!==Math.floor(b))throw new RangeError("invalid_code_point "+b);65535>=b?h+=String.fromCharCode(b):(b-=65536,h+=String.fromCharCode(b>>>10&1023|55296),h+=String.fromCharCode(b&1023|56320))}return h};
$jscomp.string.repeat=function(a){var e=this.toString();if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var h="";a;)if(a&1&&(h+=e),a>>>=1)e+=e;return h};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(a){var e=this.toString(),h=e.length;a=Number(a)||0;if(0<=a&&a<h){a|=0;var b=e.charCodeAt(a);if(55296>b||56319<b||a+1===h)return b;a=e.charCodeAt(a+1);return 56320>a||57343<a?b:1024*(b-55296)+a+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(a,e){e=void 0===e?0:e;$jscomp.string.noRegExp_(a,"includes");return-1!==this.toString().indexOf(a,e)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(a,e){e=void 0===e?0:e;$jscomp.string.noRegExp_(a,"startsWith");var h=this.toString();a+="";for(var b=h.length,g=a.length,c=Math.max(0,Math.min(e|0,h.length)),d=0;d<g&&c<b;)if(h[c++]!=a[d++])return!1;return d>=g};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(a,e){$jscomp.string.noRegExp_(a,"endsWith");var h=this.toString();a+="";void 0===e&&(e=h.length);for(var b=Math.max(0,Math.min(e|0,h.length)),g=a.length;0<g&&0<b;)if(h[--b]!=a[--g])return!1;return 0>=g};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function e$$0(e,h,b){function g(d,l){if(!h[d]){if(!e[d]){var f="function"==typeof require&&require;if(!l&&f)return f(d,!0);if(c)return c(d,!0);f=Error("Cannot find module '"+d+"'");throw f.code="MODULE_NOT_FOUND",f;}f=h[d]={exports:{}};e[d][0].call(f.exports,function(b){var c=e[d][1][b];return g(c?c:b)},f,f.exports,e$$0,e,h,b)}return h[d].exports}for(var c="function"==typeof require&&require,d=0;d<b.length;d++)g(b[d]);return g})({1:[function(a,e,h){var b=a("../regl")(),g=a("surface-nets"),c=a("ndarray"),
d=a("angle-normals"),p=a("gl-mat3"),l=a("./util/camera")(b,{distance:1.5,maxDistance:3,minDistance:.5,center:[1,1,1],theta:1}),f=b.buffer({length:49152,type:"float",usage:"dynamic"}),q=b.buffer({length:49152,type:"float",usage:"dynamic"}),t=b.elements({length:221184,count:36864,type:"uint16",usage:"dynamic",primitive:"triangles"}),z=b({vert:"\n    precision mediump float;\n    attribute vec2 position;\n    void main() {\n      gl_Position = vec4(position, 0., 1.);\n    }",frag:"\n    precision mediump float;\n    uniform vec3 color;\n    uniform float noise, width, height;\n\n    #define VIG_REDUCTION_POWER 1.\n    #define VIG_BOOST 1.\n\n    float random(vec3 scale,float seed) {\n      return fract(sin(dot(gl_FragCoord.xyz+seed,scale))*43758.5453+seed);\n    }\n\n    void main () {\n      vec2 resolution = vec2(width, height);\n      vec2 center = resolution * 0.5;\n      float vignette = distance( center, gl_FragCoord.xy ) / resolution.x;\n      vignette = VIG_BOOST - vignette * VIG_REDUCTION_POWER;\n\n      float n = noise * (.5 - random(vec3(1.), length(gl_FragCoord)));\n\n      float v = .5 * length(vec2(gl_FragCoord.y / resolution.y, (1. - abs(.5 - gl_FragCoord.x / resolution.x))));\n      vec3 base = color;\n      base += vec3(pow(v, 2.));\n\n      gl_FragColor = vec4(base * vec3(vignette) + vec3(n), 1.);\n    }",
uniforms:{color:[36/255,70/255,106/255],width:b.context("viewportWidth"),height:b.context("viewportHeight"),noise:.05},attributes:{position:[-4,-4,4,-4,0,4]},count:3}),k=b({vert:"\n    precision mediump float;\n    uniform mat4 projection, view;\n    uniform mat3 normalMatrix;\n\n    attribute vec3 position, normal;\n\n    varying vec3 vNormal, vONormal, vU;\n    varying vec4 vPosition, vOPosition;\n\n    void main () {\n      vNormal = normalMatrix * normal;\n      vONormal = normal;\n      vPosition = vec4(position, 1.0);\n      vOPosition = view * vPosition;\n      vU = normalize(vec3(vOPosition));\n      gl_Position = projection * vOPosition;\n    }",
frag:"\n    precision mediump float;\n    uniform sampler2D textureMap, normalMap;\n    uniform float normalScale, texScale;\n    uniform vec3 color, eye;\n\n    varying vec3 vNormal, vONormal, vU;\n    varying vec4 vPosition, vOPosition;\n\n    float random(vec3 scale, float seed) {\n      return fract(sin(dot(gl_FragCoord.xyz + seed,scale)) * 43758.5453 + seed);\n    }\n\n    vec3 spherical_environment_map(vec3 ray, vec3 normal) {\n      vec3 r = reflect(normalize(ray), normalize(normal));\n      float m = 2.0 * sqrt(r.x * r.x + r.y * r.y + (r.z + 1.0) * (r.z + 1.0));\n      vec2 calculatedNormal = vec2(r.x / m + 0.5, r.y / m + 0.5);\n      return texture2D(textureMap, calculatedNormal).rgb;\n    }\n\n    mat3 tangent_space_basis(vec3 blend_weights) {\n      vec3 tanX = vec3(vNormal.x, -vNormal.z, vNormal.y);\n      vec3 tanY = vec3(vNormal.z, vNormal.y, -vNormal.x);\n      vec3 tanZ = vec3(-vNormal.y, vNormal.x, vNormal.z);\n      vec3 blended_tangent = tanX * blend_weights.xxx +\n                             tanY * blend_weights.yyy +\n                             tanZ * blend_weights.zzz;\n\n      return mat3(\n        normalize(blended_tangent),\n        normalize(cross(vNormal, blended_tangent)),\n        normalize(vNormal)\n      );\n    }\n\n    vec3 blended_bump(vec3 blend_weights) {\n      vec2 coord1 = vPosition.yz * texScale;\n      vec2 coord2 = vPosition.zx * texScale;\n      vec2 coord3 = vPosition.xy * texScale;\n\n      vec3 bump1 = texture2D(normalMap, coord1).rgb;\n      vec3 bump2 = texture2D(normalMap, coord2).rgb;\n      vec3 bump3 = texture2D(normalMap, coord3).rgb;\n\n      return bump1 * blend_weights.xxx +\n             bump2 * blend_weights.yyy +\n             bump3 * blend_weights.zzz;\n    }\n\n    void main() {\n      // Using triplanar texturing, as in http://http.developer.nvidia.com/GPUGems3/gpugems3_ch01.html\n      vec3 blend_weights = abs(normalize(vONormal.xyz));\n      blend_weights = (blend_weights - 0.2) * 7.;\n      blend_weights = max(blend_weights, 0.);\n      blend_weights /= (blend_weights.x + blend_weights.y + blend_weights.z);\n\n      mat3 tsb = tangent_space_basis(blend_weights);\n      vec3 bump = blended_bump(blend_weights);\n\n      vec3 normalTex = bump * 2.0 - 1.0;\n      normalTex.xy *= normalScale;\n      normalTex.y *= -1.;\n      normalTex = normalize(normalTex);\n      vec3 finalNormal = tsb * normalTex;\n      vec3 base = spherical_environment_map(vU, finalNormal);\n\n      float rim = 1.75 * max(0., abs(dot(normalize(vNormal), normalize(-vOPosition.xyz))));\n      base += 10. * base * color * clamp(1. - rim, 0., .15);\n\n      base = vec3(1.) - (vec3(1.) - base) * (vec3(1.) - base);\n\n      float dither = .05 * random(vec3(1.), length(gl_FragCoord));\n      base += vec3(dither);\n\n      gl_FragColor = vec4(base.rgb, 1.);\n    }",
attributes:{position:{buffer:f},normal:{buffer:q}},uniforms:{color:[36/255,70/255,106/255],sphereColor:[36/255,70/255,106/255],normalScale:1,texScale:10,normalMatrix:function(b){var c=p.create();p.normalFromMat4(c,b.view);return c},textureMap:b.prop("textureMap"),normalMap:b.prop("normalMap")},elements:t}),x=1.2/((Math.sqrt(20)-1)/4+1),v=[.5,.5,.5],y=[1.5,1.5,1.5],w=[0,1,2].map(function(b){return(y[b]-v[b])/50}),C=50*Math.sqrt(x/12),A=function(b){b*=.5;for(var d=new Float32Array(125E3),f=0;20>f;f++)for(var a=
void 0,l=void 0,p=void 0,k=void 0,e=void 0,q=void 0,q=void 0,p=$jscomp.makeIterator([.27*Math.sin(f+1.26*b*(1.03+.5*Math.cos(.21*f)))+.5,.27*Math.cos(f+1.12*b*.21*Math.sin(.72+.83*f))+.5,.27*Math.cos(f+.132*b*Math.sin(.92+.53*f))+.5]),a=p.next().value,l=p.next().value,p=p.next().value,q=[a,l,p].map(function(b){b*=50;return[Math.max(Math.floor(b-C),1),Math.min(Math.floor(b+C),49)]}),k=q[0],e=q[1],q=q[2],t=q[0];t<q[1];t++)for(var h=2500*t,z=e[0];z<e[1];z++)for(var y=50*z,A=k[0];A<k[1];A++){var S=A/
50-a,m=z/50-l,n=t/50-p,S=x/(1E-6+S*S+m*m+n*n)-12;0<S&&(d[h+y+A]+=S)}b=g(c(d,[50,50,50]),80);d=Array(b.positions.length);for(f=0;f<b.positions.length;f++){a=b.positions[f];l=Array(3);for(p=0;3>p;p++)l[p]=v[p]+a[p]*w[p];d[f]=l}return{positions:d,cells:b.cells}};a("resl")({manifest:{sphereTexture:{type:"image",src:"assets/spheretexture.jpg",parser:function(c){return b.texture({data:c,mag:"linear",min:"linear"})}},normalTexture:{type:"image",src:"assets/normaltexture.jpg",parser:function(c){return b.texture({data:c,
wrapT:"repeat",wrapS:"repeat",min:"linear mipmap linear",mag:"linear"})}}},onDone:function(c){var g=c.sphereTexture,a=c.normalTexture;b.frame(function(c){c=A(c.time);f({data:c.positions});t({data:c.cells});q({data:d(c.cells,c.positions)});l(function(){z({depth:{enable:!1,mask:!1}});b.clear({depth:1});k({textureMap:g,normalMap:a})})})}})},{"../regl":88,"./util/camera":2,"angle-normals":36,"gl-mat3":55,ndarray:76,resl:80,"surface-nets":81}],2:[function(a,e,h){var b=a("mouse-change"),g=a("mouse-wheel"),
c=a("gl-mat4/identity"),d=a("gl-mat4/perspective"),p=a("gl-mat4/lookAt");e.exports=function(a,f){function q(b){b*=.9;return.1>b?0:b}function e(b){var c=h.center,d=h.eye,f=h.up;h.theta+=w;h.phi=Math.min(Math.max(h.phi+C,-Math.PI/2),Math.PI/2);h.distance=Math.min(Math.max(h.distance+A,v),y);w=q(w);C=q(C);A=q(A);for(var a=h.theta,g=h.phi,l=Math.exp(h.distance),t=l*Math.sin(a)*Math.cos(g),a=l*Math.cos(a)*Math.cos(g),g=l*Math.sin(g),l=0;3>l;++l)d[l]=c[l]+t*x[l]+a*k[l]+g*f[l];p(h.view,d,c,f);G(b)}var h=
{view:c(new Float32Array(16)),projection:c(new Float32Array(16)),center:new Float32Array(f.center||3),theta:f.theta||0,phi:f.phi||0,distance:Math.log(f.distance||10),eye:new Float32Array(3),up:new Float32Array(f.up||[0,1,0])},k=new Float32Array([1,0,0]),x=new Float32Array([0,0,1]),v=Math.log("minDistance"in f?f.minDistance:.1),y=Math.log("maxDistance"in f?f.maxDistance:1E3),w=0,C=0,A=0,B=0,F=0;b(function(b,c,d){if(b&1){b=(d-F)/window.innerHeight;var f=Math.max(h.distance,.5);w+=(c-B)/window.innerWidth*
f;C+=f*b}B=c;F=d});g(function(b,c){A+=c/window.innerHeight});var G=a({context:Object.assign({},h,{projection:function(b){return d(h.projection,Math.PI/4,b.viewportWidth/b.viewportHeight,.01,1E3)}}),uniforms:Object.keys(h).reduce(function(b,c){b[c]=a.context(c);return b},{})});Object.keys(h).forEach(function(b){e[b]=h[b]});return e}},{"gl-mat4/identity":64,"gl-mat4/lookAt":65,"gl-mat4/perspective":66,"mouse-change":72,"mouse-wheel":74}],3:[function(a,e,h){function b(){this.w=this.z=this.y=this.x=this.state=
0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}e.exports=function(g,c,d,a,l){g=d.maxAttributes;c=Array(g);for(d=0;d<g;++d)c[d]=new b;return{Record:b,scope:{},state:c}}},{}],4:[function(a,e,h){function b(b){return k[Object.prototype.toString.call(b)]|0}function g(b,c){for(var d=0;d<c.length;++d)b[d]=c[d]}function c(b,c,d,f,a,g,l){for(var p=0,k=0;k<d;++k)for(var e=0;e<f;++e)b[p++]=c[a*k+g*e+l]}var d=a("./util/check"),p=a("./util/is-typed-array"),
l=a("./util/is-ndarray"),f=a("./util/values"),q=a("./util/pool");h=a("./util/flatten");var t=h.flatten,z=h.shape,k=a("./constants/arraytypes.json"),x=a("./constants/dtypes.json"),v=a("./constants/usage.json"),y=[];y[5120]=1;y[5122]=2;y[5124]=4;y[5121]=1;y[5123]=2;y[5125]=4;y[5126]=4;e.exports=function(a,k,e){function h(b){this.id=u++;this.buffer=a.createBuffer();this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;e.profile&&(this.stats={size:0})}
function F(b,c,d){b.byteLength=c.byteLength;a.bufferData(b.type,c,d)}function G(a,f,k,e,u,x){a.usage=k;if(Array.isArray(f)){if(a.dtype=e||5126,0<f.length)if(Array.isArray(f[0])){u=z(f);for(var h=e=1;h<u.length;++h)e*=u[h];a.dimension=e;f=t(f,u,a.dtype);F(a,f,k);x?a.persistentData=f:q.freeType(f)}else"number"===typeof f[0]?(a.dimension=u,u=q.allocType(a.dtype,f.length),g(u,f),F(a,u,k),x?a.persistentData=u:q.freeType(u)):p(f[0])?(a.dimension=f[0].length,a.dtype=e||b(f[0])||5126,f=t(f,[f.length,f[0].length],
a.dtype),F(a,f,k),x?a.persistentData=f:q.freeType(f)):d.raise("invalid buffer data")}else if(p(f))a.dtype=e||b(f),a.dimension=u,F(a,f,k),x&&(a.persistentData=new Uint8Array(new Uint8Array(f.buffer)));else if(l(f)){u=f.shape;var E=f.stride,h=f.offset,m=0,n=0,r=0,M=0;1===u.length?(m=u[0],n=1,r=E[0],M=0):2===u.length?(m=u[0],n=u[1],r=E[0],M=E[1]):d.raise("invalid shape");a.dtype=e||b(f.data)||5126;a.dimension=n;u=q.allocType(a.dtype,m*n);c(u,f.data,m,n,r,M,h);F(a,u,k);x?a.persistentData=u:q.freeType(u)}else d.raise("invalid buffer data")}
function D(b){k.bufferCount--;var c=b.buffer;d(c,"buffer must not be deleted already");a.deleteBuffer(c);b.buffer=null;delete E[b.id]}var u=0,E={};h.prototype.bind=function(){a.bindBuffer(this.type,this.buffer)};h.prototype.destroy=function(){D(this)};var O=[];e.profile&&(k.getTotalBufferSize=function(){var b=0;Object.keys(E).forEach(function(c){b+=E[c].stats.size});return b});return{create:function(f,u,F,O){function J(b){var c=35044,f=null,g=0,k=0,u=1;Array.isArray(b)||p(b)||l(b)?f=b:"number"===
typeof b?g=b|0:b&&(d.type(b,"object","buffer arguments must be an object, a number or an array"),"data"in b&&(d(null===f||Array.isArray(f)||p(f)||l(f),"invalid data for buffer"),f=b.data),"usage"in b&&(d.parameter(b.usage,v,"invalid buffer usage"),c=v[b.usage]),"type"in b&&(d.parameter(b.type,x,"invalid buffer type"),k=x[b.type]),"dimension"in b&&(d.type(b.dimension,"number","invalid dimension"),u=b.dimension|0),"length"in b&&(d.nni(g,"buffer length must be a nonnegative integer"),g=b.length|0));
L.bind();f?G(L,f,c,k,u,O):(a.bufferData(L.type,g,c),L.dtype=k||5121,L.usage=c,L.dimension=u,L.byteLength=g);e.profile&&(L.stats.size=L.byteLength*y[L.dtype]);return J}function T(b,c){d(c+b.byteLength<=L.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+b.byteLength+" starting from offset "+c+" to a buffer of size "+L.byteLength);a.bufferSubData(L.type,c,b)}k.bufferCount++;var L=new h(u);E[L.id]=L;F||J(f);J._reglType="buffer";J._buffer=L;J.subdata=function(f,
a){var n=(a||0)|0,r;L.bind();if(Array.isArray(f)){if(0<f.length)if("number"===typeof f[0]){var k=q.allocType(L.dtype,f.length);g(k,f);T(k,n);q.freeType(k)}else Array.isArray(f[0])||p(f[0])?(r=z(f),k=t(f,r,L.dtype),T(k,n),q.freeType(k)):d.raise("invalid buffer data")}else if(p(f))T(f,n);else if(l(f)){r=f.shape;var u=f.stride,e=k=0,x=0,h=0;1===r.length?(k=r[0],e=1,x=u[0],h=0):2===r.length?(k=r[0],e=r[1],x=u[0],h=u[1]):d.raise("invalid shape");r=Array.isArray(f.data)?L.dtype:b(f.data);r=q.allocType(r,
k*e);c(r,f.data,k,e,x,h,f.offset);T(r,n);q.freeType(r)}else d.raise("invalid data for buffer subdata");return J};e.profile&&(J.stats=L.stats);J.destroy=function(){D(L)};return J},createStream:function(b,f){var c=O.pop();c||(c=new h(b));c.bind();G(c,f,35040,0,1,!1);return c},destroyStream:function(b){O.push(b)},clear:function(){f(E).forEach(D);O.forEach(D)},getBuffer:function(b){return b&&b._buffer instanceof h?b._buffer:null},restore:function(){f(E).forEach(function(b){b.buffer=a.createBuffer();a.bindBuffer(b.type,
b.buffer);a.bufferData(b.type,b.persistentData||b.byteLength,b.usage)})},_initBuffer:G}}},{"./constants/arraytypes.json":5,"./constants/dtypes.json":6,"./constants/usage.json":8,"./util/check":22,"./util/flatten":26,"./util/is-ndarray":28,"./util/is-typed-array":29,"./util/pool":31,"./util/values":34}],5:[function(a,e,h){e.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,
"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],6:[function(a,e,h){e.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],7:[function(a,e,h){e.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],8:[function(a,e,h){e.exports={"static":35044,dynamic:35048,stream:35040}},{}],9:[function(a,e,h){function b(b){return Array.isArray(b)||
z(b)||k(b)}function g(b){return b.sort(function(b,f){return"viewport"===b?-1:"viewport"===f?1:b<f?-1:1})}function c(b,f,c,a){this.thisDep=b;this.contextDep=f;this.propDep=c;this.append=a}function d(b){return b&&!(b.thisDep||b.contextDep||b.propDep)}function p(b){return new c(!1,!1,!1,b)}function l(b,f){var a=b.type;return 0===a?(a=b.data.length,new c(!0,1<=a,2<=a,f)):4===a?(a=b.data,new c(a.thisDep,a.contextDep,a.propDep,f)):new c(3===a,2===a,1===a,f)}var f=a("./util/check"),q=a("./util/codegen"),
t=a("./util/loop"),z=a("./util/is-typed-array"),k=a("./util/is-ndarray"),x=a("./util/is-array-like"),v=a("./dynamic"),y=a("./constants/primitives.json"),w=a("./constants/dtypes.json"),C=["x","y","z","w"],A="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),B={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,
"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},F="constant color, constant alpha;one minus constant color, constant alpha;constant color, one minus constant alpha;one minus constant color, one minus constant alpha;constant alpha, constant color;constant alpha, one minus constant color;one minus constant alpha, constant color;one minus constant alpha, one minus constant color".split(";"),
G={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},D={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},u={frag:35632,vert:35633},E={cw:2304,ccw:2305},O=new c(!1,!1,!1,function(){});e.exports=function(a,k,e,h,z,T,L,S,m,n,r,M,ca,ka,qa){function Z(b){return b.replace(".","_")}function Q(b,f,c){var a=Z(b);Ba.push(b);
Ca[a]=ua[a]=!!c;va[a]=f}function N(b,f,c){var a=Z(b);Ba.push(b);Array.isArray(c)?(ua[a]=c.slice(),Ca[a]=c.slice()):ua[a]=Ca[a]=c;wa[a]=f}function xa(){var b=q(),c=b.link,a=b.global;b.id=La++;b.batchId="0";var d=c(Ja),m=b.shared={props:"a0"};Object.keys(Ja).forEach(function(b){m[b]=a.def(d,".",b)});f.optional(function(){b.CHECK=c(f);b.commandStr=f.guessCommand();b.command=c(b.commandStr);b.assert=function(b,f,a){b("if(!(",f,"))",this.CHECK,".commandRaise(",c(a),",",this.command,");")};Da.invalidBlendCombinations=
F});var g=b.next={},l=b.current={};Object.keys(wa).forEach(function(b){Array.isArray(ua[b])&&(g[b]=a.def(m.next,".",b),l[b]=a.def(m.current,".",b))});var r=b.constants={};Object.keys(Da).forEach(function(b){r[b]=a.def(JSON.stringify(Da[b]))});b.invoke=function(f,a){switch(a.type){case 0:var d=["this",m.context,m.props,b.batchId];return f.def(c(a.data),".call(",d.slice(0,Math.max(a.data.length+1,4)),")");case 1:return f.def(m.props,a.data);case 2:return f.def(m.context,a.data);case 3:return f.def("this",
a.data);case 4:return a.data.append(b,f),a.data.ref}};b.attribCache={};var p={};b.scopeAttrib=function(b){b=k.id(b);if(b in p)return p[b];var f=n.scope[b];f||(f=n.scope[b]=new ma);return p[b]=c(f)};return b}function na(b){var f=b["static"];b=b.dynamic;var a;if("profile"in f){var c=!!f.profile;a=p(function(b,f){return c});a.enable=c}else if("profile"in b){var d=b.profile;a=l(d,function(b,f){return b.invoke(f,d)})}return a}function ra(b,a){var c=b["static"],d=b.dynamic;if("framebuffer"in c){var n=c.framebuffer;
return n?(n=S.getFramebuffer(n),f.command(n,"invalid framebuffer object"),p(function(b,f){var a=b.link(n),c=b.shared;f.set(c.framebuffer,".next",a);c=c.context;f.set(c,".framebufferWidth",a+".width");f.set(c,".framebufferHeight",a+".height");return a})):p(function(b,f){var a=b.shared;f.set(a.framebuffer,".next","null");a=a.context;f.set(a,".framebufferWidth",a+".drawingBufferWidth");f.set(a,".framebufferHeight",a+".drawingBufferHeight");return"null"})}if("framebuffer"in d){var m=d.framebuffer;return l(m,
function(b,a){var c=b.invoke(a,m),d=b.shared,n=d.framebuffer,g=a.def(n,".getFramebuffer(",c,")");f.optional(function(){b.assert(a,"!"+c+"||"+g,"invalid framebuffer object")});a.set(n,".next",g);d=d.context;a.set(d,".framebufferWidth",g+"?"+g+".width:"+d+".drawingBufferWidth");a.set(d,".framebufferHeight",g+"?"+g+".height:"+d+".drawingBufferHeight");return g})}return null}function aa(b,a,d){function n(b){if(b in m){var r=m[b];f.commandType(r,"object","invalid "+b,d.commandStr);var p=!0,k=r.x|0,u=r.y|
0,e,q;"width"in r?(e=r.width|0,f.command(0<=e,"invalid "+b,d.commandStr)):p=!1;"height"in r?(q=r.height|0,f.command(0<=q,"invalid "+b,d.commandStr)):p=!1;return new c(!p&&a&&a.thisDep,!p&&a&&a.contextDep,!p&&a&&a.propDep,function(b,a){var f=b.shared.context,c=e;"width"in r||(c=a.def(f,".","framebufferWidth","-",k));var d=q;"height"in r||(d=a.def(f,".","framebufferHeight","-",u));return[k,u,c,d]})}if(b in g){var t=g[b],p=l(t,function(a,c){var d=a.invoke(c,t);f.optional(function(){a.assert(c,d+"&&typeof "+
d+'==="object"',"invalid "+b)});var n=a.shared.context,m=c.def(d,".x|0"),g=c.def(d,".y|0"),l=c.def('"width" in ',d,"?",d,".width|0:","(",n,".","framebufferWidth","-",m,")"),r=c.def('"height" in ',d,"?",d,".height|0:","(",n,".","framebufferHeight","-",g,")");f.optional(function(){a.assert(c,l+">=0&&"+r+">=0","invalid "+b)});return[m,g,l,r]});a&&(p.thisDep=p.thisDep||a.thisDep,p.contextDep=p.contextDep||a.contextDep,p.propDep=p.propDep||a.propDep);return p}return a?new c(a.thisDep,a.contextDep,a.propDep,
function(b,a){var f=b.shared.context;return[0,0,a.def(f,".","framebufferWidth"),a.def(f,".","framebufferHeight")]}):null}var m=b["static"],g=b.dynamic;if(b=n("viewport")){var r=b;b=new c(b.thisDep,b.contextDep,b.propDep,function(b,a){var f=r.append(b,a),c=b.shared.context;a.set(c,".viewportWidth",f[2]);a.set(c,".viewportHeight",f[3]);return f})}return{viewport:b,scissor_box:n("scissor.box")}}function ga(b){function a(b){if(b in n){var c=k.id(n[b]);f.optional(function(){r.shader(u[b],c,f.guessCommand())});
var d=p(function(){return c});d.id=c;return d}if(b in m){var g=m[b];return l(g,function(a,c){var d=a.invoke(c,g),n=c.def(a.shared.strings,".id(",d,")");f.optional(function(){c(a.shared.shader,".shader(",u[b],",",n,",",a.command,");")});return n})}return null}var n=b["static"],m=b.dynamic,g=a("frag"),e=a("vert"),q=null;d(g)&&d(e)?(q=r.program(e.id,g.id),b=p(function(b,a){return b.link(q)})):b=new c(g&&g.thisDep||e&&e.thisDep,g&&g.contextDep||e&&e.contextDep,g&&g.propDep||e&&e.propDep,function(b,a){var c=
b.shared.shader,d;d=g?g.append(b,a):a.def(c,".","frag");var n;n=e?e.append(b,a):a.def(c,".","vert");var m=c+".program("+n+","+d;f.optional(function(){m+=","+b.command});return a.def(m+")")});return{frag:g,vert:e,progVar:b,program:q}}function ha(a,n){function g(b,a){if(b in m){var c=m[b]|0;f.command(!a||0<=c,"invalid "+b,n.commandStr);return p(function(b,f){a&&(b.OFFSET=c);return c})}if(b in r){var d=r[b];return l(d,function(c,n){var m=c.invoke(n,d);a&&(c.OFFSET=m,f.optional(function(){c.assert(n,
m+">=0","invalid "+b)}));return m})}return a&&k?p(function(b,a){b.OFFSET="0";return 0}):null}var m=a["static"],r=a.dynamic,k=function(){if("elements"in m){var a=m.elements;b(a)?a=T.getElements(T.create(a,!0)):a&&(a=T.getElements(a),f.command(a,"invalid elements",n.commandStr));var c=p(function(b,c){if(a){var f=b.link(a);return b.ELEMENTS=f}return b.ELEMENTS=null});c.value=a;return c}if("elements"in r){var d=r.elements;return l(d,function(b,a){var c=b.shared,n=c.isBufferArgs,c=c.elements,m=b.invoke(a,
d),g=a.def("null"),n=a.def(n,"(",m,")"),l=b.cond(n).then(g,"=",c,".createStream(",m,");")["else"](g,"=",c,".getElements(",m,");");f.optional(function(){b.assert(l["else"],"!"+m+"||"+g,"invalid elements")});a.entry(l);a.exit(b.cond(n).then(c,".destroyStream(",g,");"));return b.ELEMENTS=g})}return null}(),e=g("offset",!0);return{elements:k,primitive:function(){if("primitive"in m){var b=m.primitive;f.commandParameter(b,y,"invalid primitve",n.commandStr);return p(function(a,c){return y[b]})}if("primitive"in
r){var a=r.primitive;return l(a,function(b,c){var d=b.constants.primTypes,n=b.invoke(c,a);f.optional(function(){b.assert(c,n+" in "+d,"invalid primitive, must be one of "+Object.keys(y))});return c.def(d,"[",n,"]")})}return k?d(k)?k.value?p(function(b,a){return a.def(b.ELEMENTS,".primType")}):p(function(){return 4}):new c(k.thisDep,k.contextDep,k.propDep,function(b,a){var c=b.ELEMENTS;return a.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in m){var b=m.count|0;f.command("number"===
typeof b&&0<=b,"invalid vertex count",n.commandStr);return p(function(){return b})}if("count"in r){var a=r.count;return l(a,function(b,c){var d=b.invoke(c,a);f.optional(function(){b.assert(c,"typeof "+d+'==="number"&&'+d+">=0&&"+d+"===("+d+"|0)","invalid vertex count")});return d})}if(k){if(d(k)){if(k)return e?new c(e.thisDep,e.contextDep,e.propDep,function(b,a){var c=a.def(b.ELEMENTS,".vertCount-",b.OFFSET);f.optional(function(){b.assert(a,c+">=0","invalid vertex offset/element buffer too small")});
return c}):p(function(b,a){return a.def(b.ELEMENTS,".vertCount")});var g=p(function(){return-1});f.optional(function(){g.MISSING=!0});return g}var u=new c(k.thisDep||e.thisDep,k.contextDep||e.contextDep,k.propDep||e.propDep,function(b,a){var c=b.ELEMENTS;return b.OFFSET?a.def(c,"?",c,".vertCount-",b.OFFSET,":-1"):a.def(c,"?",c,".vertCount:-1")});f.optional(function(){u.DYNAMIC=!0});return u}return null}(),instances:g("instances",!1),offset:e}}function ia(b,a){var c=b["static"],d=b.dynamic,n={};Ba.forEach(function(b){function m(a,
f){if(b in c){var r=a(c[b]);n[g]=p(function(){return r})}else if(b in d){var k=d[b];n[g]=l(k,function(b,a){return f(b,a,b.invoke(a,k))})}}var g=Z(b);switch(b){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return m(function(c){f.commandType(c,"boolean",b,a.commandStr);return c},function(a,c,d){f.optional(function(){a.assert(c,"typeof "+d+'==="boolean"',
"invalid flag "+b,a.commandStr)});return d});case "depth.func":return m(function(c){f.commandParameter(c,G,"invalid "+b,a.commandStr);return G[c]},function(a,c,d){var m=a.constants.compareFuncs;f.optional(function(){a.assert(c,d+" in "+m,"invalid "+b+", must be one of "+Object.keys(G))});return c.def(m,"[",d,"]")});case "depth.range":return m(function(b){f.command(x(b)&&2===b.length&&"number"===typeof b[0]&&"number"===typeof b[1]&&b[0]<=b[1],"depth range is 2d array",a.commandStr);return b},function(b,
a,c){f.optional(function(){b.assert(a,b.shared.isArrayLike+"("+c+")&&"+c+".length===2&&typeof "+c+'[0]==="number"&&typeof '+c+'[1]==="number"&&'+c+"[0]<="+c+"[1]","depth range must be a 2d array")});var d=a.def("+",c,"[0]"),m=a.def("+",c,"[1]");return[d,m]});case "blend.func":return m(function(b){f.commandType(b,"object","blend.func",a.commandStr);var c="srcRGB"in b?b.srcRGB:b.src,d="srcAlpha"in b?b.srcAlpha:b.src,m="dstRGB"in b?b.dstRGB:b.dst;b="dstAlpha"in b?b.dstAlpha:b.dst;f.commandParameter(c,
B,g+".srcRGB",a.commandStr);f.commandParameter(d,B,g+".srcAlpha",a.commandStr);f.commandParameter(m,B,g+".dstRGB",a.commandStr);f.commandParameter(b,B,g+".dstAlpha",a.commandStr);f.command(-1===F.indexOf(c+", "+m),"unallowed blending combination (srcRGB, dstRGB) = ("+c+", "+m+")",a.commandStr);return[B[c],B[m],B[d],B[b]]},function(a,c,d){function m(g,l){var r=c.def('"',g,l,'" in ',d,"?",d,".",g,l,":",d,".",g);f.optional(function(){a.assert(c,r+" in "+n,"invalid "+b+"."+g+l+", must be one of "+Object.keys(B))});
return r}var n=a.constants.blendFuncs;f.optional(function(){a.assert(c,d+"&&typeof "+d+'==="object"',"invalid blend func, must be an object")});var g=m("src","RGB"),l=m("dst","RGB");f.optional(function(){a.assert(c,a.constants.invalidBlendCombinations+".indexOf("+g+'+", "+'+l+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var r=c.def(n,"[",g,"]"),k=c.def(n,"[",m("src","Alpha"),"]"),p=c.def(n,"[",l,"]"),e=c.def(n,"[",m("dst","Alpha"),"]");return[r,p,k,e]});case "blend.equation":return m(function(c){if("string"===
typeof c)return f.commandParameter(c,ba,"invalid "+b,a.commandStr),[ba[c],ba[c]];if("object"===typeof c)return f.commandParameter(c.rgb,ba,b+".rgb",a.commandStr),f.commandParameter(c.alpha,ba,b+".alpha",a.commandStr),[ba[c.rgb],ba[c.alpha]];f.commandRaise("invalid blend.equation",a.commandStr)},function(a,c,d){var m=a.constants.blendEquations,g=c.def(),n=c.def(),l=a.cond("typeof ",d,'==="string"');f.optional(function(){function c(b,f,d){a.assert(b,d+" in "+m,"invalid "+f+", must be one of "+Object.keys(ba))}
c(l.then,b,d);a.assert(l["else"],d+"&&typeof "+d+'==="object"',"invalid "+b);c(l["else"],b+".rgb",d+".rgb");c(l["else"],b+".alpha",d+".alpha")});l.then(g,"=",n,"=",m,"[",d,"];");l["else"](g,"=",m,"[",d,".rgb];",n,"=",m,"[",d,".alpha];");c(l);return[g,n]});case "blend.color":return m(function(b){f.command(x(b)&&4===b.length,"blend.color must be a 4d array",a.commandStr);return t(4,function(a){return+b[a]})},function(b,a,c){f.optional(function(){b.assert(a,b.shared.isArrayLike+"("+c+")&&"+c+".length===4",
"blend.color must be a 4d array")});return t(4,function(b){return a.def("+",c,"[",b,"]")})});case "stencil.mask":return m(function(b){f.commandType(b,"number",g,a.commandStr);return b|0},function(b,a,c){f.optional(function(){b.assert(a,"typeof "+c+'==="number"',"invalid stencil.mask")});return a.def(c,"|0")});case "stencil.func":return m(function(c){f.commandType(c,"object",g,a.commandStr);var d=c.cmp||"keep",m=c.ref||0;c="mask"in c?c.mask:-1;f.commandParameter(d,G,b+".cmp",a.commandStr);f.commandType(m,
"number",b+".ref",a.commandStr);f.commandType(c,"number",b+".mask",a.commandStr);return[G[d],m,c]},function(b,a,c){var d=b.constants.compareFuncs;f.optional(function(){function f(){b.assert(a,Array.prototype.join.call(arguments,""),"invalid stencil.func")}f(c+"&&typeof ",c,'==="object"');f('!("cmp" in ',c,")||(",c,".cmp in ",d,")")});var m=a.def('"cmp" in ',c,"?",d,"[",c,".cmp]",":",7680),g=a.def(c,".ref|0"),n=a.def('"mask" in ',c,"?",c,".mask|0:-1");return[m,g,n]});case "stencil.opFront":case "stencil.opBack":return m(function(c){f.commandType(c,
"object",g,a.commandStr);var d=c.fail||"keep",m=c.zfail||"keep";c=c.zpass||"keep";f.commandParameter(d,D,b+".fail",a.commandStr);f.commandParameter(m,D,b+".zfail",a.commandStr);f.commandParameter(c,D,b+".zpass",a.commandStr);return["stencil.opBack"===b?1029:1028,D[d],D[m],D[c]]},function(a,c,d){function m(n){f.optional(function(){a.assert(c,'!("'+n+'" in '+d+")||("+d+"."+n+" in "+g+")","invalid "+b+"."+n+", must be one of "+Object.keys(D))});return c.def('"',n,'" in ',d,"?",g,"[",d,".",n,"]:",7680)}
var g=a.constants.stencilOps;f.optional(function(){a.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+b)});return["stencil.opBack"===b?1029:1028,m("fail"),m("zfail"),m("zpass")]});case "polygonOffset.offset":return m(function(b){f.commandType(b,"object",g,a.commandStr);var c=b.factor|0;b=b.units|0;f.commandType(c,"number",g+".factor",a.commandStr);f.commandType(b,"number",g+".units",a.commandStr);return[c,b]},function(a,c,d){f.optional(function(){a.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+
b)});var m=c.def(d,".factor|0"),n=c.def(d,".units|0");return[m,n]});case "cull.face":return m(function(b){var c=0;"front"===b?c=1028:"back"===b&&(c=1029);f.command(!!c,g,a.commandStr);return c},function(b,a,c){f.optional(function(){b.assert(a,c+'==="front"||'+c+'==="back"',"invalid cull.face")});return a.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return m(function(b){f.command("number"===typeof b&&b>=h.lineWidthDims[0]&&b<=h.lineWidthDims[1],"invalid line width, must positive number between "+
h.lineWidthDims[0]+" and "+h.lineWidthDims[1],a.commandStr);return b},function(b,a,c){f.optional(function(){b.assert(a,"typeof "+c+'==="number"&&'+c+">="+h.lineWidthDims[0]+"&&"+c+"<="+h.lineWidthDims[1],"invalid line width")});return c});case "frontFace":return m(function(b){f.commandParameter(b,E,g,a.commandStr);return E[b]},function(b,a,c){f.optional(function(){b.assert(a,c+'==="cw"||'+c+'==="ccw"',"invalid frontFace, must be one of cw,ccw")});return a.def(c+'==="cw"?2304:2305')});case "colorMask":return m(function(b){f.command(x(b)&&
4===b.length,"color.mask must be length 4 array",a.commandStr);return b.map(function(b){return!!b})},function(b,a,c){f.optional(function(){b.assert(a,b.shared.isArrayLike+"("+c+")&&"+c+".length===4","invalid color.mask")});return t(4,function(b){return"!!"+c+"["+b+"]"})});case "sample.coverage":return m(function(b){f.command("object"===typeof b&&b,g,a.commandStr);var c="value"in b?b.value:1;b=!!b.invert;f.command("number"===typeof c&&0<=c&&1>=c,"sample.coverage.value must be a number between 0 and 1",
a.commandStr);return[c,b]},function(b,c,a){f.optional(function(){b.assert(c,a+"&&typeof "+a+'==="object"',"invalid sample.coverage")});var d=c.def('"value" in ',a,"?+",a,".value:1"),m=c.def("!!",a,".invert");return[d,m]})}});return n}function ja(b,a){var c=b["static"],d=b.dynamic,m={};Object.keys(c).forEach(function(b){var d=c[b],n;if("number"===typeof d||"boolean"===typeof d)n=p(function(){return d});else if("function"===typeof d){var g=d._reglType;"texture2d"===g||"textureCube"===g?n=p(function(b){return b.link(d)}):
"framebuffer"===g||"framebufferCube"===g?(f.command(0<d.color.length,'missing color attachment for framebuffer sent to uniform "'+b+'"',a.commandStr),n=p(function(b){return b.link(d.color[0])})):f.commandRaise('invalid data for uniform "'+b+'"',a.commandStr)}else x(d)?n=p(function(a){return a.global.def("[",t(d.length,function(c){f.command("number"===typeof d[c]||"boolean"===typeof d[c],"invalid uniform "+b,a.commandStr);return d[c]}),"]")}):f.commandRaise('invalid or missing data for uniform "'+
b+'"',a.commandStr);n.value=d;m[b]=n});Object.keys(d).forEach(function(b){var a=d[b];m[b]=l(a,function(b,c){return b.invoke(c,a)})});return m}function la(a,c){var d=a["static"],m=a.dynamic,n={};Object.keys(d).forEach(function(a){var m=d[a],g=k.id(a),l=new ma;if(b(m))l.state=1,l.buffer=z.getBuffer(z.create(m,34962,!1,!0)),l.type=0;else{var r=z.getBuffer(m);if(r)l.state=1,l.buffer=r,l.type=0;else if(f.command("object"===typeof m&&m,"invalid data for attribute "+a,c.commandStr),m.constant){var e=m.constant;
l.buffer="null";l.state=2;"number"===typeof e?l.x=e:(f.command(x(e)&&0<e.length&&4>=e.length,"invalid constant for attribute "+a,c.commandStr),C.forEach(function(b,a){a<e.length&&(l[b]=e[a])}))}else{r=b(m.buffer)?z.getBuffer(z.create(m.buffer,34962,!1,!0)):z.getBuffer(m.buffer);f.command(!!r,'missing buffer for attribute "'+a+'"',c.commandStr);var u=m.offset|0;f.command(0<=u,'invalid offset for attribute "'+a+'"',c.commandStr);var q=m.stride|0;f.command(0<=q&&256>q,'invalid stride for attribute "'+
a+'", must be integer betweeen [0, 255]',c.commandStr);var t=m.size|0;f.command(!("size"in m)||0<t&&4>=t,'invalid size for attribute "'+a+'", must be 1,2,3,4',c.commandStr);var h=!!m.normalized,E=0;"type"in m&&(f.commandParameter(m.type,w,"invalid type for attribute "+a,c.commandStr),E=w[m.type]);var M=m.divisor|0;"divisor"in m&&(f.command(0===M||K,'cannot specify divisor for attribute "'+a+'", instancing not supported',c.commandStr),f.command(0<=M,'invalid divisor for attribute "'+a+'"',c.commandStr));
f.optional(function(){var b=c.commandStr,d="buffer offset divisor normalized type size stride".split(" ");Object.keys(m).forEach(function(c){f.command(0<=d.indexOf(c),'unknown parameter "'+c+'" for attribute pointer "'+a+'" (valid parameters are '+d+")",b)})});l.buffer=r;l.state=1;l.size=t;l.normalized=h;l.type=E||r.dtype;l.offset=u;l.stride=q;l.divisor=M}}n[a]=p(function(b,a){var c=b.attribCache;if(g in c)return c[g];var d={isStream:!1};Object.keys(l).forEach(function(b){d[b]=l[b]});l.buffer&&(d.buffer=
b.link(l.buffer),d.type=d.type||d.buffer+".dtype");return c[g]=d})});Object.keys(m).forEach(function(b){var a=m[b];n[b]=l(a,function(c,d){function m(b){d(k[b],"=",n,".",b,"|0;")}var n=c.invoke(d,a),g=c.shared,l=g.isBufferArgs,r=g.buffer;f.optional(function(){c.assert(d,n+"&&(typeof "+n+'==="object"||typeof '+n+'==="function")&&('+l+"("+n+")||"+r+".getBuffer("+n+")||"+r+".getBuffer("+n+".buffer)||"+l+"("+n+'.buffer)||("constant" in '+n+"&&(typeof "+n+'.constant==="number"||'+g.isArrayLike+"("+n+".constant))))",
'invalid dynamic attribute "'+b+'"')});var k={isStream:d.def(!1)},p=new ma;p.state=1;Object.keys(p).forEach(function(b){k[b]=d.def(""+p[b])});var e=k.buffer,u=k.type;d("if(",l,"(",n,")){",k.isStream,"=true;",e,"=",r,".createStream(",34962,",",n,");",u,"=",e,".dtype;","}else{",e,"=",r,".getBuffer(",n,");","if(",e,"){",u,"=",e,".dtype;",'}else if("constant" in ',n,"){",k.state,"=",2,";","if(typeof "+n+'.constant === "number"){',k[C[0]],"=",n,".constant;",C.slice(1).map(function(b){return k[b]}).join("="),
"=0;","}else{",C.map(function(b,a){return k[b]+"="+n+".constant.length>="+a+"?"+n+".constant["+a+"]:0;"}).join(""),"}}else{","if(",l,"(",n,".buffer)){",e,"=",r,".createStream(",34962,",",n,".buffer);","}else{",e,"=",r,".getBuffer(",n,".buffer);","}",u,'="type" in ',n,"?",g.glTypes,"[",n,".type]:",e,".dtype;",k.normalized,"=!!",n,".normalized;");m("size");m("offset");m("stride");m("divisor");d("}}");d.exit("if(",k.isStream,"){",r,".destroyStream(",e,");","}");return k})});return n}function sa(b){var a=
b["static"],c=b.dynamic,d={};Object.keys(a).forEach(function(b){var c=a[b];d[b]=p(function(b,a){return"number"===typeof c||"boolean"===typeof c?""+c:b.link(c)})});Object.keys(c).forEach(function(b){var a=c[b];d[b]=l(a,function(b,c){return b.invoke(c,a)})});return d}function W(b,a,c,d,m){function n(b){var a=k[b];a&&(e[b]=a)}var g=b["static"],l=b.dynamic;f.optional(function(){function b(c){Object.keys(c).forEach(function(b){f.command(0<=a.indexOf(b),'unknown parameter "'+b+'"',m.commandStr)})}var a=
"framebuffer vert frag elements primitive offset count instances profile".split(" ").concat(Ba);b(g);b(l)});var r=ra(b,m),k=aa(b,r,m),p=ha(b,m),e=ia(b,m),u=ga(b,m);n("viewport");n(Z("scissor.box"));var q=0<Object.keys(e).length,r={framebuffer:r,draw:p,shader:u,state:e,dirty:q};r.profile=na(b,m);r.uniforms=ja(c,m);r.attributes=la(a,m);r.context=sa(d,m);return r}function X(b,a,c){var d=b.shared.context,m=b.scope();Object.keys(c).forEach(function(f){a.save(d,"."+f);m(d,".",f,"=",c[f].append(b,a),";")});
a(m)}function ea(b,a,c,d){var m=b.shared,f=m.gl,n=m.framebuffer,g;Ga&&(g=a.def(m.extensions,".webgl_draw_buffers"));var l=b.constants,m=l.drawBuffer,l=l.backBuffer;b=c?c.append(b,a):a.def(n,".next");d||a("if(",b,"!==",n,".cur){");a("if(",b,"){",f,".bindFramebuffer(",36160,",",b,".framebuffer);");Ga&&a(g,".drawBuffersWEBGL(",m,"[",b,".colorAttachments.length]);");a("}else{",f,".bindFramebuffer(",36160,",null);");Ga&&a(g,".drawBuffersWEBGL(",l,");");a("}",n,".cur=",b,";");d||a("}")}function V(b,a,c){var d=
b.shared,m=d.gl,f=b.current,n=b.next,g=d.current,l=d.next,r=b.cond(g,".dirty");Ba.forEach(function(a){a=Z(a);if(!(a in c.state)){var d,k;if(a in n){d=n[a];k=f[a];var p=t(ua[a].length,function(b){return r.def(d,"[",b,"]")});r(b.cond(p.map(function(b,a){return b+"!=="+k+"["+a+"]"}).join("||")).then(m,".",wa[a],"(",p,");",p.map(function(b,a){return k+"["+a+"]="+b}).join(";"),";"))}else d=r.def(l,".",a),p=b.cond(d,"!==",g,".",a),r(p),a in va?p(b.cond(d).then(m,".enable(",va[a],");")["else"](m,".disable(",
va[a],");"),g,".",a,"=",d,";"):p(m,".",wa[a],"(",d,");",g,".",a,"=",d,";")}});0===Object.keys(c.state).length&&r(g,".dirty=false;");a(r)}function P(b,a,c,m){var f=b.shared,n=b.current,l=f.current,r=f.gl;g(Object.keys(c)).forEach(function(f){var g=c[f];if(!m||m(g)){var k=g.append(b,a);if(va[f]){var p=va[f];d(g)?k?a(r,".enable(",p,");"):a(r,".disable(",p,");"):a(b.cond(k).then(r,".enable(",p,");")["else"](r,".disable(",p,");"));a(l,".",f,"=",k,";")}else if(x(k)){var e=n[f];a(r,".",wa[f],"(",k,");",
k.map(function(b,a){return e+"["+a+"]="+b}).join(";"),";")}else a(r,".",wa[f],"(",k,");",l,".",f,"=",k,";")}})}function Y(b,a){K&&(b.instancing=a.def(b.shared.extensions,".angle_instanced_arrays"))}function da(b,a,c,m,f){function n(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function g(b){q=a.def();b(q,"=",n(),";");"string"===typeof f?b(p,".count+=",f,";"):b(p,".count++;");ka&&(m?(t=a.def(),b(t,"=",u,".getNumPendingQueries();")):b(u,".beginQuery(",p,");"))}function l(b){b(p,
".cpuTime+=",n(),"-",q,";");ka&&(m?b(u,".pushScopeStats(",t,",",u,".getNumPendingQueries(),",p,");"):b(u,".endQuery();"))}function r(b){var c=a.def(e,".profile");a(e,".profile=",b,";");a.exit(e,".profile=",c,";")}var k=b.shared,p=b.stats,e=k.current,u=k.timer;c=c.profile;var q,t;if(c){if(d(c)){c.enable?(g(a),l(a.exit),r("true")):r("false");return}c=c.append(b,a);r(c)}else c=a.def(e,".profile");k=b.block();g(k);a("if(",c,"){",k,"}");b=b.block();l(b);a.exit("if(",c,"){",b,"}")}function ta(b,a,c,d,m){function n(b){switch(b){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function g(c,d,m){function f(){a("if(!",p,".buffer){",r,".enableVertexAttribArray(",k,");}");var c=m.type,n;n=m.size?a.def(m.size,"||",d):d;a("if(",p,".type!==",c,"||",p,".size!==",n,"||",q.map(function(b){return p+"."+b+"!=="+m[b]}).join("||"),"){",r,".bindBuffer(",34962,",",e,".buffer);",r,".vertexAttribPointer(",[k,n,c,m.normalized,m.stride,m.offset],");",p,".type=",c,";",p,".size=",n,";",q.map(function(b){return p+
"."+b+"="+m[b]+";"}).join(""),"}");K&&(c=m.divisor,a("if(",p,".divisor!==",c,"){",b.instancing,".vertexAttribDivisorANGLE(",[k,c],");",p,".divisor=",c,";}"))}function n(){a("if(",p,".buffer){",r,".disableVertexAttribArray(",k,");","}if(",C.map(function(b,a){return p+"."+b+"!=="+u[a]}).join("||"),"){",r,".vertexAttrib4f(",k,",",u,");",C.map(function(b,a){return p+"."+b+"="+u[a]+";"}).join(""),"}")}var r=l.gl,k=a.def(c,".location"),p=a.def(l.attributes,"[",k,"]");c=m.state;var e=m.buffer,u=[m.x,m.y,
m.z,m.w],q=["buffer","normalized","offset","stride"];1===c?f():2===c?n():(a("if(",c,"===",1,"){"),f(),a("}else{"),n(),a("}"))}var l=b.shared;d.forEach(function(d){var l=d.name,r=c.attributes[l],k;if(r){if(!m(r))return;k=r.append(b,a)}else{if(!m(O))return;var p=b.scopeAttrib(l);f.optional(function(){b.assert(a,p+".state","missing attribute "+l)});k={};Object.keys(new ma).forEach(function(b){k[b]=a.def(p,".",b)})}g(b.link(d),n(d.info.type),k)})}function fa(b,a,c,m,n){for(var g=b.shared,l=g.gl,r,p=0;p<
m.length;++p){var e=m[p],u=e.name,q=e.info.type,h=c.uniforms[u],e=b.link(e)+".location",E;if(h){if(!n(h))continue;if(d(h)){var K=h.value;f.command(null!==K&&"undefined"!==typeof K,'missing uniform "'+u+'"',b.commandStr);if(35678===q||35680===q)f.command("function"===typeof K&&(35678===q&&("texture2d"===K._reglType||"framebuffer"===K._reglType)||35680===q&&("textureCube"===K._reglType||"framebufferCube"===K._reglType)),"invalid texture for uniform "+u,b.commandStr),h=b.link(K._texture||K.color[0]._texture),
a(l,".uniform1i(",e,",",h+".bind());"),a.exit(h,".unbind();");else if(35674===q||35675===q||35676===q){f.optional(function(){f.command(x(K),"invalid matrix for uniform "+u,b.commandStr);f.command(35674===q&&4===K.length||35675===q&&9===K.length||35676===q&&16===K.length,"invalid length for matrix uniform "+u,b.commandStr)});var h=b.global.def("new Float32Array(["+Array.prototype.slice.call(K)+"])"),M=2;35675===q?M=3:35676===q&&(M=4);a(l,".uniformMatrix",M,"fv(",e,",false,",h,");")}else{switch(q){case 5126:f.commandType(K,
"number","uniform "+u,b.commandStr);r="1f";break;case 35664:f.command(x(K)&&2===K.length,"uniform "+u,b.commandStr);r="2f";break;case 35665:f.command(x(K)&&3===K.length,"uniform "+u,b.commandStr);r="3f";break;case 35666:f.command(x(K)&&4===K.length,"uniform "+u,b.commandStr);r="4f";break;case 35670:f.commandType(K,"boolean","uniform "+u,b.commandStr);r="1i";break;case 5124:f.commandType(K,"number","uniform "+u,b.commandStr);r="1i";break;case 35671:f.command(x(K)&&2===K.length,"uniform "+u,b.commandStr);
r="2i";break;case 35667:f.command(x(K)&&2===K.length,"uniform "+u,b.commandStr);r="2i";break;case 35672:f.command(x(K)&&3===K.length,"uniform "+u,b.commandStr);r="3i";break;case 35668:f.command(x(K)&&3===K.length,"uniform "+u,b.commandStr);r="3i";break;case 35673:f.command(x(K)&&4===K.length,"uniform "+u,b.commandStr);r="4i";break;case 35669:f.command(x(K)&&4===K.length,"uniform "+u,b.commandStr),r="4i"}a(l,".uniform",r,"(",e,",",x(K)?Array.prototype.slice.call(K):K,");")}continue}else E=h.append(b,
a)}else{if(!n(O))continue;E=a.def(g.uniforms,"[",k.id(u),"]")}35678===q?a("if(",E,"&&",E,'._reglType==="framebuffer"){',E,"=",E,".color[0];","}"):35680===q&&a("if(",E,"&&",E,'._reglType==="framebufferCube"){',E,"=",E,".color[0];","}");f.optional(function(){function c(d,m){b.assert(a,d,'bad data or missing for uniform "'+u+'".  '+m)}function d(b){c("typeof "+E+'==="'+b+'"',"invalid type, expected "+b)}function m(a,d){c(g.isArrayLike+"("+E+")&&"+E+".length==="+a,"invalid vector, should have length "+
a,b.commandStr)}function f(a){c("typeof "+E+'==="function"&&'+E+'._reglType==="texture'+(3553===a?"2d":"Cube")+'"',"invalid texture type",b.commandStr)}switch(q){case 5124:d("number");break;case 35667:m(2,"number");break;case 35668:m(3,"number");break;case 35669:m(4,"number");break;case 5126:d("number");break;case 35664:m(2,"number");break;case 35665:m(3,"number");break;case 35666:m(4,"number");break;case 35670:d("boolean");break;case 35671:m(2,"boolean");break;case 35672:m(3,"boolean");break;case 35673:m(4,
"boolean");break;case 35674:m(4,"number");break;case 35675:m(9,"number");break;case 35676:m(16,"number");break;case 35678:f(3553);break;case 35680:f(34067)}});h=1;switch(q){case 35678:case 35680:h=a.def(E,"._texture");a(l,".uniform1i(",e,",",h,".bind());");a.exit(h,".unbind();");continue;case 5124:case 35670:r="1i";break;case 35667:case 35671:r="2i";h=2;break;case 35668:case 35672:r="3i";h=3;break;case 35669:case 35673:r="4i";h=4;break;case 5126:r="1f";break;case 35664:r="2f";h=2;break;case 35665:r=
"3f";h=3;break;case 35666:r="4f";h=4;break;case 35674:r="Matrix2fv";break;case 35675:r="Matrix3fv";break;case 35676:r="Matrix4fv"}a(l,".uniform",r,"(",e,",");if("M"===r.charAt(0)){var e=Math.pow(q-35674+2,2),z=b.global.def("new Float32Array(",e,")");a("false,(Array.isArray(",E,")||",E," instanceof Float32Array)?",E,":(",t(e,function(b){return z+"["+b+"]="+E+"["+b+"]"}),",",z,")")}else 1<h?a(t(h,function(b){return E+"["+b+"]"})):a(E);a(");")}}function oa(b,a,c,m){function n(d){var f=e[d];return f?
f.contextDep&&m.contextDynamic||f.propDep?f.append(b,c):f.append(b,a):a.def(p,".",d)}function g(){function b(){c(E,".drawElementsInstancedANGLE(",[q,t,M,h+"<<(("+M+"-5121)>>1)",x],");")}function a(){c(E,".drawArraysInstancedANGLE(",[q,h,t,x],");")}u?z?b():(c("if(",u,"){"),b(),c("}else{"),a(),c("}")):a()}function l(){function b(){c(k+".drawElements("+[q,t,M,h+"<<(("+M+"-5121)>>1)"]+");")}function a(){c(k+".drawArrays("+[q,h,t]+");")}u?z?b():(c("if(",u,"){"),b(),c("}else{"),a(),c("}")):a()}var r=b.shared,
k=r.gl,p=r.draw,e=m.draw,u=function(){var d=e.elements,f=a;if(d){if(d.contextDep&&m.contextDynamic||d.propDep)f=c;d=d.append(b,f)}else d=f.def(p,".","elements");d&&f("if("+d+")"+k+".bindBuffer(34963,"+d+".buffer.buffer);");return d}(),q=n("primitive"),h=n("offset"),t=function(){var d=e.count,n,g=a;if(d){if(d.contextDep&&m.contextDynamic||d.propDep)g=c;n=d.append(b,g);f.optional(function(){d.MISSING&&b.assert(a,"false","missing vertex count");d.DYNAMIC&&b.assert(g,n+">=0","missing vertex count")})}else n=
g.def(p,".","count"),f.optional(function(){b.assert(g,n+">=0","missing vertex count")});return n}();if("number"===typeof t){if(0===t)return}else c("if(",t,"){"),c.exit("}");var x,E;K&&(x=n("instances"),E=b.instancing);var M=u+".type",z=e.elements&&d(e.elements);K&&("number"!==typeof x||0<=x)?"string"===typeof x?(c("if(",x,">0){"),g(),c("}else if(",x,"<0){"),l(),c("}")):g():l()}function ya(b,a,c,d,m){var n=xa();m=n.proc("body",m);f.optional(function(){n.commandStr=a.commandStr;n.command=n.link(a.commandStr)});
K&&(n.instancing=m.def(n.shared.extensions,".angle_instanced_arrays"));b(n,m,c,d);return n.compile().body}function Aa(b,a,c,d){Y(b,a);ta(b,a,c,d.attributes,function(){return!0});fa(b,a,c,d.uniforms,function(){return!0});oa(b,a,a,c)}function Ea(b,a){var c=b.proc("draw",1);Y(b,c);X(b,c,a.context);ea(b,c,a.framebuffer);V(b,c,a);P(b,c,a.state);da(b,c,a,!1,!0);var d=a.shader.progVar.append(b,c);c(b.shared.gl,".useProgram(",d,".program);");if(a.shader.program)Aa(b,c,a,a.shader.program);else{var m=b.global.def("{}"),
f=c.def(d,".id"),n=c.def(m,"[",f,"]");c(b.cond(n).then(n,".call(this,a0);")["else"](n,"=",m,"[",f,"]=",b.link(function(c){return ya(Aa,b,a,c,1)}),"(",d,");",n,".call(this,a0);"))}0<Object.keys(a.state).length&&c(b.shared.current,".dirty=true;")}function za(b,a,c,d){function m(){return!0}b.batchId="a1";Y(b,a);ta(b,a,c,d.attributes,m);fa(b,a,c,d.uniforms,m);oa(b,a,a,c)}function Fa(b,a,c,d){function m(b){return b.contextDep&&n||b.propDep}function f(b){return!m(b)}Y(b,a);var n=c.contextDep,g=a.def(),
l=a.def();b.shared.props=l;b.batchId=g;var r=b.scope(),k=b.scope();a(r.entry,"for(",g,"=0;",g,"<","a1",";++",g,"){",l,"=","a0","[",g,"];",k,"}",r.exit);c.needsContext&&X(b,k,c.context);c.needsFramebuffer&&ea(b,k,c.framebuffer);P(b,k,c.state,m);c.profile&&m(c.profile)&&da(b,k,c,!1,!0);d?(ta(b,r,c,d.attributes,f),ta(b,k,c,d.attributes,m),fa(b,r,c,d.uniforms,f),fa(b,k,c,d.uniforms,m),oa(b,r,k,c)):(a=b.global.def("{}"),d=c.shader.progVar.append(b,k),l=k.def(d,".id"),r=k.def(a,"[",l,"]"),k(b.shared.gl,
".useProgram(",d,".program);","if(!",r,"){",r,"=",a,"[",l,"]=",b.link(function(a){return ya(za,b,c,a,2)}),"(",d,");}",r,".call(this,a0[",g,"],",g,");"))}function Ha(b,a){function c(b){return b.contextDep&&m||b.propDep}var d=b.proc("batch",2);b.batchId="0";Y(b,d);var m=!1,f=!0;Object.keys(a.context).forEach(function(b){m=m||a.context[b].propDep});m||(X(b,d,a.context),f=!1);var n=a.framebuffer,g=!1;n?(n.propDep?m=g=!0:n.contextDep&&m&&(g=!0),g||ea(b,d,n)):ea(b,d,null);a.state.viewport&&a.state.viewport.propDep&&
(m=!0);V(b,d,a);P(b,d,a.state,function(b){return!c(b)});a.profile&&c(a.profile)||da(b,d,a,!1,"a1");a.contextDep=m;a.needsContext=f;a.needsFramebuffer=g;f=a.shader.progVar;if(f.contextDep&&m||f.propDep)Fa(b,d,a,null);else if(f=f.append(b,d),d(b.shared.gl,".useProgram(",f,".program);"),a.shader.program)Fa(b,d,a,a.shader.program);else{var n=b.global.def("{}"),g=d.def(f,".id"),r=d.def(n,"[",g,"]");d(b.cond(r).then(r,".call(this,a0,a1);")["else"](r,"=",n,"[",g,"]=",b.link(function(c){return ya(Fa,b,a,
c,2)}),"(",f,");",r,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&d(b.shared.current,".dirty=true;")}function Ia(b,a){function c(f){var n=a.shader[f];n&&d.set(m.shader,"."+f,n.append(b,d))}var d=b.proc("scope",3);b.batchId="a2";var m=b.shared,f=m.current;X(b,d,a.context);a.framebuffer&&a.framebuffer.append(b,d);g(Object.keys(a.state)).forEach(function(c){var f=a.state[c].append(b,d);x(f)?f.forEach(function(a,m){d.set(b.next[c],"["+m+"]",a)}):d.set(m.next,"."+c,f)});da(b,d,a,!0,!0);["elements",
"offset","count","instances","primitive"].forEach(function(c){var f=a.draw[c];f&&d.set(m.draw,"."+c,""+f.append(b,d))});Object.keys(a.uniforms).forEach(function(c){d.set(m.uniforms,"["+k.id(c)+"]",a.uniforms[c].append(b,d))});Object.keys(a.attributes).forEach(function(c){var m=a.attributes[c].append(b,d),f=b.scopeAttrib(c);Object.keys(new ma).forEach(function(b){d.set(f,"."+b,m[b])})});c("vert");c("frag");0<Object.keys(a.state).length&&(d(f,".dirty=true;"),d.exit(f,".dirty=true;"));d("a1(",b.shared.context,
",a0,",b.batchId,");")}function Ka(b){if("object"===typeof b&&!x(b)){for(var a=Object.keys(b),c=0;c<a.length;++c)if(v.isDynamic(b[a[c]]))return!0;return!1}}function pa(b,a,c){function d(b,a){n.forEach(function(c){var d=m[c];v.isDynamic(d)&&(d=b.invoke(a,d),a(p,".",c,"=",d,";"))})}var m=a["static"][c];if(m&&Ka(m)){var f=b.global,n=Object.keys(m),g=!1,r=!1,k=!1,p=b.global.def("{}");n.forEach(function(a){var c=m[a];if(v.isDynamic(c))"function"===typeof c&&(c=m[a]=v.unbox(c)),a=l(c,null),g=g||a.thisDep,
k=k||a.propDep,r=r||a.contextDep;else{f(p,".",a,"=");switch(typeof c){case "number":f(c);break;case "string":f('"',c,'"');break;case "object":Array.isArray(c)&&f("[",c.join(),"]");break;default:f(b.link(c))}f(";")}});a.dynamic[c]=new v.DynamicVariable(4,{thisDep:g,contextDep:r,propDep:k,ref:p,append:d});delete a["static"][c]}}var ma=n.Record,ba={add:32774,subtract:32778,"reverse subtract":32779};e.ext_blend_minmax&&(ba.min=32775,ba.max=32776);var K=e.angle_instanced_arrays,Ga=e.webgl_draw_buffers,
ua={dirty:!0,profile:qa.profile},Ca={},Ba=[],va={},wa={};Q("dither",3024);Q("blend.enable",3042);N("blend.color","blendColor",[0,0,0,0]);N("blend.equation","blendEquationSeparate",[32774,32774]);N("blend.func","blendFuncSeparate",[1,0,1,0]);Q("depth.enable",2929,!0);N("depth.func","depthFunc",513);N("depth.range","depthRange",[0,1]);N("depth.mask","depthMask",!0);N("colorMask","colorMask",[!0,!0,!0,!0]);Q("cull.enable",2884);N("cull.face","cullFace",1029);N("frontFace","frontFace",2305);N("lineWidth",
"lineWidth",1);Q("polygonOffset.enable",32823);N("polygonOffset.offset","polygonOffset",[0,0]);Q("sample.alpha",32926);Q("sample.enable",32928);N("sample.coverage","sampleCoverage",[1,!1]);Q("stencil.enable",2960);N("stencil.mask","stencilMask",-1);N("stencil.func","stencilFunc",[519,0,-1]);N("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);N("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);Q("scissor.enable",3089);N("scissor.box","scissor",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);
N("viewport","viewport",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);var Ja={gl:a,context:ca,strings:k,next:Ca,current:ua,draw:M,elements:T,buffer:z,shader:r,attributes:n.state,uniforms:m,framebuffer:S,extensions:e,timer:ka,isBufferArgs:b},Da={primTypes:y,compareFuncs:G,blendFuncs:B,blendEquations:ba,stencilOps:D,glTypes:w,orientationType:E};f.optional(function(){Ja.isArrayLike=x});Ga&&(Da.backBuffer=[1029],Da.drawBuffer=t(h.maxDrawbuffers,function(b){return 0===b?[0]:t(b,function(b){return 36064+
b})}));var La=0;return{next:Ca,current:ua,procs:function(){var b=xa(),c=b.proc("poll"),d=b.proc("refresh"),m=b.block();c(m);d(m);var f=b.shared,n=f.gl,g=f.next,r=f.current;m(r,".dirty=false;");ea(b,c);ea(b,d,null,!0);var l=a.getExtension("angle_instanced_arrays"),k;l&&(k=b.link(l));for(var p=0;p<h.maxAttributes;++p){var e=d.def(f.attributes,"[",p,"]"),u=b.cond(e,".buffer");u.then(n,".enableVertexAttribArray(",p,");",n,".bindBuffer(",34962,",",e,".buffer.buffer);",n,".vertexAttribPointer(",p,",",e,
".size,",e,".type,",e,".normalized,",e,".stride,",e,".offset);")["else"](n,".disableVertexAttribArray(",p,");",n,".vertexAttrib4f(",p,",",e,".x,",e,".y,",e,".z,",e,".w);",e,".buffer=null;");d(u);l&&d(k,".vertexAttribDivisorANGLE(",p,",",e,".divisor);")}Object.keys(va).forEach(function(a){var f=va[a],l=m.def(g,".",a),k=b.block();k("if(",l,"){",n,".enable(",f,")}else{",n,".disable(",f,")}",r,".",a,"=",l,";");d(k);c("if(",l,"!==",r,".",a,"){",k,"}")});Object.keys(wa).forEach(function(a){var f=wa[a],
l=ua[a],k,p,e=b.block();e(n,".",f,"(");x(l)?(f=l.length,k=b.global.def(g,".",a),p=b.global.def(r,".",a),e(t(f,function(b){return k+"["+b+"]"}),");",t(f,function(b){return p+"["+b+"]="+k+"["+b+"];"}).join("")),c("if(",t(f,function(b){return k+"["+b+"]!=="+p+"["+b+"]"}).join("||"),"){",e,"}")):(k=m.def(g,".",a),p=m.def(r,".",a),e(k,");",r,".",a,"=",k,";"),c("if(",k,"!==",p,"){",e,"}"));d(e)});return b.compile()}(),compile:function(b,a,c,d,m){var f=xa();f.stats=f.link(m);Object.keys(a["static"]).forEach(function(b){pa(f,
a,b)});A.forEach(function(a){pa(f,b,a)});c=W(b,a,c,d,f);Ea(f,c);Ia(f,c);Ha(f,c);return f.compile()}}}},{"./constants/dtypes.json":6,"./constants/primitives.json":7,"./dynamic":10,"./util/check":22,"./util/codegen":24,"./util/is-array-like":27,"./util/is-ndarray":28,"./util/is-typed-array":29,"./util/loop":30}],10:[function(a,e,h){function b(b,a){this.id=d++;this.type=b;this.data=a}function g(b){if(0===b.length)return[];var a=b.charAt(0),c=b.charAt(b.length-1);if(1<b.length&&a===c&&('"'===a||"'"===
a))return['"'+b.substr(1,b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(a=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return g(b.substr(0,a.index)).concat(g(a[1])).concat(g(b.substr(a.index+a[0].length)));a=b.split(".");if(1===a.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(c=0;c<a.length;++c)b=b.concat(g(a[c]));return b}function c(b){return"["+g(b).join("][")+"]"}var d=0;e.exports={DynamicVariable:b,define:function(a,d){return new b(a,c(d+""))},
isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof b},unbox:function(a,c){return"function"===typeof a?new b(0,a):a},accessor:c}},{}],11:[function(a,e,h){var b=a("./util/check"),g=a("./util/is-typed-array"),c=a("./util/is-ndarray"),d=a("./util/values"),p=a("./constants/primitives.json"),l=a("./constants/usage.json");e.exports=function(a,e,h,z){function k(b){this.id=w++;y[this.id]=this;this.buffer=b;this.primType=4;this.type=this.vertCount=0}function x(d,l,k,p,u,x,z){d.buffer.bind();
if(l){var v=z;z||g(l)&&(!c(l)||g(l.data))||(v=e.oes_element_index_uint?5125:5123);h._initBuffer(d.buffer,l,k,v,3)}else a.bufferData(34963,x,k),d.buffer.dtype=v||5121,d.buffer.usage=k,d.buffer.dimension=3,d.buffer.byteLength=x;v=z;if(!z){switch(d.buffer.dtype){case 5121:case 5120:v=5121;break;case 5123:case 5122:v=5123;break;case 5125:case 5124:v=5125;break;default:b.raise("unsupported type for element array")}d.buffer.dtype=v}d.type=v;b(5125!==v||!!e.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");
l=u;0>l&&(l=d.buffer.byteLength,5123===v?l>>=1:5125===v&&(l>>=2));d.vertCount=l;l=p;0>p&&(l=4,p=d.buffer.dimension,1===p&&(l=0),2===p&&(l=1),3===p&&(l=4));d.primType=l}function v(a){z.elementsCount--;b(null!==a.buffer,"must not double destroy elements");delete y[a.id];a.buffer.destroy();a.buffer=null}var y={},w=0,C={uint8:5121,uint16:5123};e.oes_element_index_uint&&(C.uint32=5125);k.prototype.bind=function(){this.buffer.bind()};var A=[];return{create:function(a,d){function f(a){if(a)if("number"===
typeof a)e(a),u.primType=4,u.vertCount=a|0,u.type=5121;else{var d=null,k=35044,q=-1,h=-1,t=0,v=0;if(Array.isArray(a)||g(a)||c(a))d=a;else if(b.type(a,"object","invalid arguments for elements"),"data"in a&&(d=a.data,b(Array.isArray(d)||g(d)||c(d),"invalid data for element buffer")),"usage"in a&&(b.parameter(a.usage,l,"invalid element buffer usage"),k=l[a.usage]),"primitive"in a&&(b.parameter(a.primitive,p,"invalid element buffer primitive"),q=p[a.primitive]),"count"in a&&(b("number"===typeof a.count&&
0<=a.count,"invalid vertex count for elements"),h=a.count|0),"type"in a&&(b.parameter(a.type,C,"invalid buffer type"),v=C[a.type]),"length"in a)t=a.length|0;else if(t=h,5123===v||5122===v)t*=2;else if(5125===v||5124===v)t*=4;x(u,d,k,q,h,t,v)}else e(),u.primType=4,u.vertCount=0,u.type=5121;return f}var e=h.create(null,34963,!0),u=new k(e._buffer);z.elementsCount++;f(a);f._reglType="elements";f._elements=u;f.subdata=function(b,a){e.subdata(b,a);return f};f.destroy=function(){v(u)};return f},createStream:function(b){var a=
A.pop();a||(a=new k(h.create(null,34963,!0,!1)._buffer));x(a,b,35040,-1,-1,0,0);return a},destroyStream:function(b){A.push(b)},getElements:function(b){return"function"===typeof b&&b._elements instanceof k?b._elements:null},clear:function(){d(y).forEach(v)}}}},{"./constants/primitives.json":7,"./constants/usage.json":8,"./util/check":22,"./util/is-ndarray":28,"./util/is-typed-array":29,"./util/values":34}],12:[function(a,e,h){var b=a("./util/check");e.exports=function(a,c){function d(c){b.type(c,"string",
"extension name must be string");c=c.toLowerCase();var d;try{d=p[c]=a.getExtension(c)}catch(f){}return!!d}for(var p={},l=0;l<c.extensions.length;++l){var f=c.extensions[l];if(!d(f))return c.onDestroy(),c.onDone('"'+f+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}c.optionalExtensions.forEach(d);return{extensions:p,restore:function(){Object.keys(p).forEach(function(b){if(!d(b))throw Error("(regl): error restoring extension "+b);})}}}},
{"./util/check":22}],13:[function(a,e,h){var b=a("./util/check"),g=a("./util/values"),c=a("./util/extend"),d=[6408],p=[];p[6408]=4;var l=[];l[5121]=1;l[5126]=4;l[36193]=2;var f=[32854,32855,36194,35907,34842,34843,34836],q={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"};e.exports=function(a,e,k,h,v,y){function w(b,a,c){this.target=b;this.texture=a;this.renderbuffer=c;var d=b=0;a?(b=a.width,d=a.height):c&&(b=
c.width,d=c.height);this.width=b;this.height=d}function C(b){b&&(b.texture&&b.texture._texture.decRef(),b.renderbuffer&&b.renderbuffer._renderbuffer.decRef())}function A(a,c,d){if(a){if(a.texture){a=a.texture._texture;var m=Math.max(1,a.height);b(Math.max(1,a.width)===c&&m===d,"inconsistent width/height for supplied texture")}else a=a.renderbuffer._renderbuffer,b(a.width===c&&a.height===d,"inconsistent width/height for renderbuffer");a.refCount+=1}}function B(b,c){c&&(c.texture?a.framebufferTexture2D(36160,
b,c.target,c.texture._texture.texture,0):a.framebufferRenderbuffer(36160,b,36161,c.renderbuffer._renderbuffer.renderbuffer))}function F(a){var c=3553,d=null,m=null,f=a;"object"===typeof a&&(f=a.data,"target"in a&&(c=a.target|0));b.type(f,"function","invalid attachment data");a=f._reglType;"texture2d"===a?(d=f,b(3553===c)):"textureCube"===a?(d=f,b(34069<=c&&34075>c,"invalid cube map target")):"renderbuffer"===a?(m=f,c=36161):b.raise("invalid regl object for attachment");return new w(c,d,m)}function G(b,
a,c,d,m){if(c)return b=h.create2D({width:b,height:a,format:d,type:m}),b._texture.refCount=0,new w(3553,b,null);b=v.create({width:b,height:a,format:d});b._renderbuffer.refCount=0;return new w(36161,null,b)}function D(b){return b&&(b.texture||b.renderbuffer)}function u(b,a,c){b&&(b.texture?b.texture.resize(a,c):b.renderbuffer&&b.renderbuffer.resize(a,c))}function E(){this.id=S++;m[this.id]=this;this.framebuffer=a.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=
this.stencilAttachment=this.depthAttachment=null}function O(b){b.colorAttachments.forEach(C);C(b.depthAttachment);C(b.stencilAttachment);C(b.depthStencilAttachment)}function U(c){var d=c.framebuffer;b(d,"must not double destroy framebuffer");a.deleteFramebuffer(d);c.framebuffer=null;y.framebufferCount--;delete m[c.id]}function H(c){var d;a.bindFramebuffer(36160,c.framebuffer);var m=c.colorAttachments;for(d=0;d<m.length;++d)B(36064+d,m[d]);for(d=m.length;d<k.maxColorAttachments;++d)a.framebufferTexture2D(36160,
36064+d,3553,null,0);a.framebufferTexture2D(36160,33306,3553,null,0);a.framebufferTexture2D(36160,36096,3553,null,0);a.framebufferTexture2D(36160,36128,3553,null,0);B(36096,c.depthAttachment);B(36128,c.stencilAttachment);B(33306,c.depthStencilAttachment);c=a.checkFramebufferStatus(36160);36053!==c&&b.raise("framebuffer configuration not supported, status = "+q[c]);a.bindFramebuffer(36160,R.next);R.cur=R.next;a.getError()}function I(a,m){function g(a,c){var m;b(R.next!==q,"can not update framebuffer which is currently in use");
var n=e.webgl_draw_buffers,r=0,u=0,h=!0,t=!0;m=null;var x=!0,E="rgba",v="uint8",w=1,y=null,B=null,C=null,U=!1;if("number"===typeof a)r=a|0,u=c|0||r;else if(a){b.type(a,"object","invalid arguments for framebuffer");"shape"in a?(u=a.shape,b(Array.isArray(u)&&2<=u.length,"invalid shape for framebuffer"),r=u[0],u=u[1]):("radius"in a&&(r=u=a.radius),"width"in a&&(r=a.width),"height"in a&&(u=a.height));if("color"in a||"colors"in a)m=a.color||a.colors,Array.isArray(m)&&b(1===m.length||n,"multiple render targets not supported");
if(!m){"colorCount"in a&&(w=a.colorCount|0,b(0<w,"invalid color buffer count"));"colorTexture"in a&&(x=!!a.colorTexture,E="rgba4");if("colorType"in a){v=a.colorType;if(x)b(e.oes_texture_float||!("float"===v||"float32"===v),"you must enable OES_texture_float in order to use floating point framebuffer objects"),b(e.oes_texture_half_float||!("half float"===v||"float16"===v),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects");else if("half float"===v||"float16"===
v)b(e.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),E="rgba16f";else if("float"===v||"float32"===v)b(e.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),E="rgba32f";b.oneOf(v,L,"invalid color type")}if("colorFormat"in a)if(E=a.colorFormat,0<=J.indexOf(E))x=!0;else if(0<=T.indexOf(E))x=!1;else if(x)b.oneOf(a.colorFormat,J,"invalid color format for texture");else b.oneOf(a.colorFormat,
T,"invalid color format for renderbuffer")}if("depthTexture"in a||"depthStencilTexture"in a)U=!(!a.depthTexture&&!a.depthStencilTexture),b(!U||e.webgl_depth_texture,"webgl_depth_texture extension not supported");"depth"in a&&("boolean"===typeof a.depth?h=a.depth:(y=a.depth,t=!1));"stencil"in a&&("boolean"===typeof a.stencil?t=a.stencil:(B=a.stencil,h=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?h=t=a.depthStencil:(C=a.depthStencil,t=h=!1))}else r=u=1;var I=n=null,S=null,V=null;if(Array.isArray(m))n=
m.map(F);else if(m)n=[F(m)];else for(n=Array(w),m=0;m<w;++m)n[m]=G(r,u,x,E,v);b(e.webgl_draw_buffers||1>=n.length,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers.");b(n.length<=k.maxColorAttachments,"too many color attachments, not supported");r=r||n[0].width;u=u||n[0].height;y?I=F(y):h&&!t&&(I=G(r,u,U,"depth","uint32"));B?S=F(B):t&&!h&&(S=G(r,u,!1,"stencil","uint8"));C?V=F(C):!y&&!B&&t&&h&&(V=G(r,u,U,"depth stencil","depth stencil"));b(1>=!!y+!!B+!!C,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");
h=null;for(m=0;m<n.length;++m)A(n[m],r,u),b(!n[m]||n[m].texture&&0<=d.indexOf(n[m].texture._texture.format)||n[m].renderbuffer&&0<=f.indexOf(n[m].renderbuffer._renderbuffer.format),"framebuffer color attachment "+m+" is invalid"),n[m]&&n[m].texture&&(t=p[n[m].texture._texture.format]*l[n[m].texture._texture.type],null===h?h=t:b(h===t,"all color attachments much have the same number of bits per pixel."));A(I,r,u);b(!I||I.texture&&6402===I.texture._texture.format||I.renderbuffer&&33189===I.renderbuffer._renderbuffer.format,
"invalid depth attachment for framebuffer object");A(S,r,u);b(!S||S.renderbuffer&&36168===S.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object");A(V,r,u);b(!V||V.texture&&34041===V.texture._texture.format||V.renderbuffer&&34041===V.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object");O(q);q.width=r;q.height=u;q.colorAttachments=n;q.depthAttachment=I;q.stencilAttachment=S;q.depthStencilAttachment=V;g.color=n.map(D);g.depth=D(I);
g.stencil=D(S);g.depthStencil=D(V);g.width=q.width;g.height=q.height;H(q);return g}var q=new E;y.framebufferCount++;g(a,m);return c(g,{resize:function(a,c){b(R.next!==q,"can not resize a framebuffer which is currently in use");var d=a|0,m=c|0||d;if(d===q.width&&m===q.height)return g;for(var f=q.colorAttachments,n=0;n<f.length;++n)u(f[n],d,m);u(q.depthAttachment,d,m);u(q.stencilAttachment,d,m);u(q.depthStencilAttachment,d,m);q.width=g.width=d;q.height=g.height=m;H(q);return g},_reglType:"framebuffer",
_framebuffer:q,destroy:function(){U(q);O(q)},bind:function(b){R.setFBO({framebuffer:g},b)}})}var R={cur:null,next:null,dirty:!1,setFBO:null},J=["rgba"],T=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&T.push("srgba");e.ext_color_buffer_half_float&&T.push("rgba16f","rgb16f");e.webgl_color_buffer_float&&T.push("rgba32f");var L=["uint8"];e.oes_texture_half_float&&L.push("half float","float16");e.oes_texture_float&&L.push("float","float32");var S=0,m={};return c(R,{getFramebuffer:function(b){return"function"===
typeof b&&"framebuffer"===b._reglType&&(b=b._framebuffer,b instanceof E)?b:null},create:I,createCube:function(a){function d(a){var f;b(0>m.indexOf(R.next),"can not update framebuffer which is currently in use");var g=e.webgl_draw_buffers,n={color:null},l=0,k=null;f="rgba";var p="uint8",u=1;if("number"===typeof a)l=a|0;else if(a){b.type(a,"object","invalid arguments for framebuffer");"shape"in a?(l=a.shape,b(Array.isArray(l)&&2<=l.length,"invalid shape for framebuffer"),b(l[0]===l[1],"cube framebuffer must be square"),
l=l[0]):("radius"in a&&(l=a.radius|0),"width"in a?(l=a.width|0,"height"in a&&b(a.height===l,"must be square")):"height"in a&&(l=a.height|0));if("color"in a||"colors"in a)k=a.color||a.colors,Array.isArray(k)&&b(1===k.length||g,"multiple render targets not supported");k||("colorCount"in a&&(u=a.colorCount|0,b(0<u,"invalid color buffer count")),"colorType"in a&&(b.oneOf(a.colorType,L,"invalid color type"),p=a.colorType),"colorFormat"in a&&(f=a.colorFormat,b.oneOf(a.colorFormat,J,"invalid color format for texture")));
"depth"in a&&(n.depth=a.depth);"stencil"in a&&(n.stencil=a.stencil);"depthStencil"in a&&(n.depthStencil=a.depthStencil)}else l=1;if(k)if(Array.isArray(k))for(a=[],f=0;f<k.length;++f)a[f]=k[f];else a=[k];else for(a=Array(u),k={radius:l,format:f,type:p},f=0;f<u;++f)a[f]=h.createCube(k);n.color=Array(a.length);for(f=0;f<a.length;++f)u=a[f],b("function"===typeof u&&"textureCube"===u._reglType,"invalid cube map"),l=l||u.width,b(u.width===l&&u.height===l,"invalid cube map shape"),n.color[f]={target:34069,
data:a[f]};for(f=0;6>f;++f){for(u=0;u<a.length;++u)n.color[u].target=34069+f;0<f&&(n.depth=m[0].depth,n.stencil=m[0].stencil,n.depthStencil=m[0].depthStencil);if(m[f])m[f](n);else m[f]=I(n)}return c(d,{width:l,height:l,color:a})}var m=Array(6);d(a);return c(d,{faces:m,resize:function(a){var c=a|0;b(0<c&&c<=k.maxCubeMapSize,"invalid radius for cube fbo");if(c===d.width)return d;var f=d.color;for(a=0;a<f.length;++a)f[a].resize(c);for(a=0;6>a;++a)m[a].resize(c);d.width=d.height=c;return d},_reglType:"framebufferCube",
destroy:function(){m.forEach(function(b){b.destroy()})}})},clear:function(){g(m).forEach(U)},restore:function(){g(m).forEach(function(b){b.framebuffer=a.createFramebuffer();H(b)})}})}},{"./util/check":22,"./util/extend":25,"./util/values":34}],14:[function(a,e,h){e.exports=function(b,a){var c=1;a.ext_texture_filter_anisotropic&&(c=b.getParameter(34047));var d=1,p=1;a.webgl_draw_buffers&&(d=b.getParameter(34852),p=b.getParameter(36063));return{colorBits:[b.getParameter(3410),b.getParameter(3411),b.getParameter(3412),
b.getParameter(3413)],depthBits:b.getParameter(3414),stencilBits:b.getParameter(3415),subpixelBits:b.getParameter(3408),extensions:Object.keys(a).filter(function(b){return!!a[b]}),maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:p,pointSizeDims:b.getParameter(33901),lineWidthDims:b.getParameter(33902),maxViewportDims:b.getParameter(3386),maxCombinedTextureUnits:b.getParameter(35661),maxCubeMapSize:b.getParameter(34076),maxRenderbufferSize:b.getParameter(34024),maxTextureUnits:b.getParameter(34930),
maxTextureSize:b.getParameter(3379),maxAttributes:b.getParameter(34921),maxVertexUniforms:b.getParameter(36347),maxVertexTextureUnits:b.getParameter(35660),maxVaryingVectors:b.getParameter(36348),maxFragmentUniforms:b.getParameter(36349),glsl:b.getParameter(35724),renderer:b.getParameter(7937),vendor:b.getParameter(7936),version:b.getParameter(7938)}}},{}],15:[function(a,e,h){var b=a("./util/check"),g=a("./util/is-typed-array");e.exports=function(a,d,p,l,f,e){function h(k){var t;null===d.next?(b(f.preserveDrawingBuffer,
'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),t=5121):(b(null!==d.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),t=d.next.colorAttachments[0].texture._texture.type,e.oes_texture_float?b(5121===t||5126===t,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):b(5121===t,"Reading from a framebuffer is only allowed for the type 'uint8'"));var v=0,z=0,w=l.framebufferWidth,C=l.framebufferHeight,
A=null;g(k)?A=k:k&&(b.type(k,"object","invalid arguments to regl.read()"),v=k.x|0,z=k.y|0,b(0<=v&&v<l.framebufferWidth,"invalid x offset for regl.read"),b(0<=z&&z<l.framebufferHeight,"invalid y offset for regl.read"),w=(k.width||l.framebufferWidth-v)|0,C=(k.height||l.framebufferHeight-z)|0,A=k.data||null);A&&(5121===t?b(A instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===t&&b(A instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"));
b(0<w&&w+v<=l.framebufferWidth,"invalid width for read pixels");b(0<C&&C+z<=l.framebufferHeight,"invalid height for read pixels");p();k=w*C*4;A||(5121===t?A=new Uint8Array(k):5126===t&&(A=A||new Float32Array(k)));b.isTypedArray(A,"data buffer for regl.read() must be a typedarray");b(A.byteLength>=k,"data buffer for regl.read() too small");a.pixelStorei(3333,4);a.readPixels(v,z,w,C,6408,t,A);return A}function z(b){var a;d.setFBO({framebuffer:b.framebuffer},function(){a=h(b)});return a}return function(b){return b&&
"framebuffer"in b?z(b):h(b)}}},{"./util/check":22,"./util/is-typed-array":29}],16:[function(a,e,h){var b=a("./util/check"),g=a("./util/values"),c=[];c[32854]=2;c[32855]=2;c[36194]=2;c[33189]=2;c[36168]=1;c[34041]=4;c[35907]=4;c[34836]=16;c[34842]=8;c[34843]=6;e.exports=function(a,e,l,f,q){function h(b){this.id=v++;this.refCount=1;this.renderbuffer=b;this.format=32854;this.height=this.width=0;q.profile&&(this.stats={size:0})}function z(c){var g=c.renderbuffer;b(g,"must not double destroy renderbuffer");
a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(g);c.renderbuffer=null;c.refCount=0;delete y[c.id];f.renderbufferCount--}var k={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(k.srgba=35907);e.ext_color_buffer_half_float&&(k.rgba16f=34842,k.rgb16f=34843);e.webgl_color_buffer_float&&(k.rgba32f=34836);var x=[];Object.keys(k).forEach(function(b){x[k[b]]=b});var v=0,y={};h.prototype.decRef=function(){0>=--this.refCount&&z(this)};q.profile&&(f.getTotalRenderbufferSize=
function(){var b=0;Object.keys(y).forEach(function(a){b+=y[a].stats.size});return b});return{create:function(g,e){function p(f,g){var e=0,u=0,h=32854;"object"===typeof f&&f?("shape"in f?(u=f.shape,b(Array.isArray(u)&&2<=u.length,"invalid renderbuffer shape"),e=u[0]|0,u=u[1]|0):("radius"in f&&(e=u=f.radius|0),"width"in f&&(e=f.width|0),"height"in f&&(u=f.height|0)),"format"in f&&(b.parameter(f.format,k,"invalid renderbuffer format"),h=k[f.format])):"number"===typeof f?(e=f|0,u="number"===typeof g?
g|0:e):f?b.raise("invalid arguments to renderbuffer constructor"):e=u=1;b(0<e&&0<u&&e<=l.maxRenderbufferSize&&u<=l.maxRenderbufferSize,"invalid renderbuffer size");if(e!==v.width||u!==v.height||h!==v.format)return p.width=v.width=e,p.height=v.height=u,v.format=h,a.bindRenderbuffer(36161,v.renderbuffer),a.renderbufferStorage(36161,h,e,u),q.profile&&(v.stats.size=c[v.format]*v.width*v.height),p.format=x[v.format],p}var v=new h(a.createRenderbuffer());y[v.id]=v;f.renderbufferCount++;p(g,e);p.resize=
function(f,g){var k=f|0,e=g|0||k;if(k===v.width&&e===v.height)return p;b(0<k&&0<e&&k<=l.maxRenderbufferSize&&e<=l.maxRenderbufferSize,"invalid renderbuffer size");p.width=v.width=k;p.height=v.height=e;a.bindRenderbuffer(36161,v.renderbuffer);a.renderbufferStorage(36161,v.format,k,e);q.profile&&(v.stats.size=c[v.format]*v.width*v.height);return p};p._reglType="renderbuffer";p._renderbuffer=v;q.profile&&(p.stats=v.stats);p.destroy=function(){v.decRef()};return p},clear:function(){g(y).forEach(z)},restore:function(){g(y).forEach(function(b){b.renderbuffer=
a.createRenderbuffer();a.bindRenderbuffer(36161,b.renderbuffer);a.renderbufferStorage(36161,b.format,b.width,b.height)});a.bindRenderbuffer(36161,null)}}}},{"./util/check":22,"./util/values":34}],17:[function(a,e,h){var b=a("./util/check"),g=a("./util/values");e.exports=function(a,d,e,l){function f(b,a,c,d){this.name=b;this.id=a;this.location=c;this.info=d}function q(b,a){for(var c=0;c<b.length;++c)if(b[c].id===a.id){b[c].location=a.location;return}b.push(a)}function h(f,g,l){var k=35632===f?x:v,
e=k[g];if(!e){var p=d.str(g),e=a.createShader(f);a.shaderSource(e,p);a.compileShader(e);b.shaderError(a,e,p,f,l);k[g]=e}return e}function z(b,a){this.id=C++;this.fragId=b;this.vertId=a;this.program=null;this.uniforms=[];this.attributes=[];l.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function k(g,k){var e,p;e=h(35632,g.fragId);p=h(35633,g.vertId);var v=g.program=a.createProgram();a.attachShader(v,e);a.attachShader(v,p);a.linkProgram(v);b.linkError(a,v,d.str(g.fragId),d.str(g.vertId),
k);var u=a.getProgramParameter(v,35718);l.profile&&(g.stats.uniformsCount=u);var x=g.uniforms;for(e=0;e<u;++e)if(p=a.getActiveUniform(v,e))if(1<p.size)for(var z=0;z<p.size;++z){var y=p.name.replace("[0]","["+z+"]");q(x,new f(y,d.id(y),a.getUniformLocation(v,y),p))}else q(x,new f(p.name,d.id(p.name),a.getUniformLocation(v,p.name),p));u=a.getProgramParameter(v,35721);l.profile&&(g.stats.attributesCount=u);x=g.attributes;for(e=0;e<u;++e)(p=a.getActiveAttrib(v,e))&&q(x,new f(p.name,d.id(p.name),a.getAttribLocation(v,
p.name),p))}var x={},v={},y={},w=[],C=0;l.profile&&(e.getMaxUniformsCount=function(){var b=0;w.forEach(function(a){a.stats.uniformsCount>b&&(b=a.stats.uniformsCount)});return b},e.getMaxAttributesCount=function(){var b=0;w.forEach(function(a){a.stats.attributesCount>b&&(b=a.stats.attributesCount)});return b});return{clear:function(){var b=a.deleteShader.bind(a);g(x).forEach(b);x={};g(v).forEach(b);v={};w.forEach(function(b){a.deleteProgram(b.program)});w.length=0;y={};e.shaderCount=0},program:function(a,
c,d){b.command(0<=a,"missing vertex shader",d);b.command(0<=c,"missing fragment shader",d);var f=y[c];f||(f=y[c]={});var g=f[a];g||(g=new z(c,a),e.shaderCount++,k(g,d),f[a]=g,w.push(g));return g},restore:function(){x={};v={};for(var b=0;b<w.length;++b)k(w[b])},shader:h,frag:-1,vert:-1}}},{"./util/check":22,"./util/values":34}],18:[function(a,e,h){e.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},
{}],19:[function(a,e,h){e.exports=function(){var b={"":0},a=[""];return{id:function(c){var d=b[c];if(d)return d;d=b[c]=a.length;a.push(c);return d},str:function(b){return a[b]}}}},{}],20:[function(a,e,h){function b(b){return Array.isArray(b)&&(0===b.length||"number"===typeof b[0])}function g(b){return Array.isArray(b)&&0!==b.length&&y(b[0])?!0:!1}function c(b){return Object.prototype.toString.call(b)}function d(a){if(!a)return!1;var d=c(a);return 0<=G.indexOf(d)?!0:b(a)||g(a)||k(a)}function p(b,a){36193===
b.type?(b.data=v(a),x.freeType(a)):b.data=a}function l(b,a,c,d,f,g){b="undefined"!==typeof u[b]?u[b]:F[b]*D[a];g&&(b*=6);if(f){for(d=0;1<=c;)d+=b*c*c,c/=2;return d}return b*c*d}var f=a("./util/check"),q=a("./util/extend"),t=a("./util/values"),z=a("./util/is-typed-array"),k=a("./util/is-ndarray"),x=a("./util/pool"),v=a("./util/to-half-float"),y=a("./util/is-array-like"),w=a("./util/flatten");h=a("./constants/arraytypes.json");var C=a("./constants/arraytypes.json"),A=[9984,9986,9985,9987],B=[0,6409,
6410,6407,6408],F={};F[6409]=F[6406]=F[6402]=1;F[34041]=F[6410]=2;F[6407]=F[35904]=3;F[6408]=F[35906]=4;var G=Object.keys(h).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),D=[];D[5121]=1;D[5126]=4;D[36193]=2;D[5123]=2;D[5125]=4;var u=[];u[32854]=2;u[32855]=2;u[36194]=2;u[34041]=4;u[33776]=.5;u[33777]=.5;u[33778]=1;u[33779]=1;u[35986]=.5;u[35987]=1;u[34798]=1;u[35840]=.5;u[35841]=.25;u[35842]=.5;u[35843]=.25;u[36196]=
.5;e.exports=function(a,e,u,h,D,G,J){function T(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.channels=this.height=this.width=this.colorSpace=0}function L(b,a){b.internalformat=a.internalformat;b.format=a.format;b.type=a.type;b.compressed=a.compressed;b.premultiplyAlpha=a.premultiplyAlpha;b.flipY=a.flipY;b.unpackAlignment=a.unpackAlignment;b.colorSpace=a.colorSpace;b.width=a.width;b.height=a.height;b.channels=
a.channels}function S(b,a){if("object"===typeof a&&a){"premultiplyAlpha"in a&&(f.type(a.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),b.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(f.type(a.flipY,"boolean","invalid texture flip"),b.flipY=a.flipY);"alignment"in a&&(f.oneOf(a.alignment,[1,2,4,8],"invalid texture unpack alignment"),b.unpackAlignment=a.alignment);"colorSpace"in a&&(f.parameter(a.colorSpace,V,"invalid colorSpace"),b.colorSpace=V[a.colorSpace]);if("type"in a){var c=a.type;
f(e.oes_texture_float||!("float"===c||"float32"===c),"you must enable the OES_texture_float extension in order to use floating point textures.");f(e.oes_texture_half_float||!("half float"===c||"float16"===c),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures.");f(e.webgl_depth_texture||!("uint16"===c||"uint32"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures.");f.parameter(c,P,"invalid texture type");
b.type=P[c]}var d=b.width,m=b.height,g=b.channels,c=!1;"shape"in a?(f(Array.isArray(a.shape)&&2<=a.shape.length,"shape must be an array"),d=a.shape[0],m=a.shape[1],3===a.shape.length&&(g=a.shape[2],f(0<g&&4>=g,"invalid number of channels"),c=!0),f(0<=d&&d<=u.maxTextureSize,"invalid width"),f(0<=m&&m<=u.maxTextureSize,"invalid height")):("radius"in a&&(d=m=a.radius,f(0<=d&&d<=u.maxTextureSize,"invalid radius")),"width"in a&&(d=a.width,f(0<=d&&d<=u.maxTextureSize,"invalid width")),"height"in a&&(m=
a.height,f(0<=m&&m<=u.maxTextureSize,"invalid height")),"channels"in a&&(g=a.channels,f(0<g&&4>=g,"invalid number of channels"),c=!0));b.width=d|0;b.height=m|0;b.channels=g|0;d=!1;"format"in a&&(d=a.format,f(e.webgl_depth_texture||!("depth"===d||"depth stencil"===d),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),f.parameter(d,Y,"invalid texture format"),m=b.internalformat=Y[d],b.format=Fa[m],d in P&&!("type"in a)&&(b.type=P[d]),d in da&&(b.compressed=
!0),d=!0);!c&&d?b.channels=F[b.format]:c&&!d?b.channels!==B[b.format]&&(b.format=b.internalformat=B[b.channels]):d&&c&&f(b.channels===F[b.format],"number of channels inconsistent with specified format")}}function m(b){a.pixelStorei(37440,b.flipY);a.pixelStorei(37441,b.premultiplyAlpha);a.pixelStorei(37443,b.colorSpace);a.pixelStorei(3317,b.unpackAlignment)}function n(){T.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function r(a,m){var n=
null;d(m)?n=m:m&&(f.type(m,"object","invalid pixel data type"),S(a,m),"x"in m&&(a.xOffset=m.x|0),"y"in m&&(a.yOffset=m.y|0),d(m.data)&&(n=m.data));f(!a.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array");if(m.copy){f(!n,"can not specify copy and data field for the same texture");var l=D.viewportWidth,r=D.viewportHeight;a.width=a.width||l-a.xOffset;a.height=a.height||r-a.yOffset;a.needsCopy=!0;f(0<=a.xOffset&&a.xOffset<l&&0<=a.yOffset&&a.yOffset<r&&0<a.width&&
a.width<=l&&0<a.height&&a.height<=r,"copy texture read out of bounds")}else if(!n)a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||4;else if(z(n))a.channels=a.channels||4,a.data=n,"type"in m||5121!==a.type||(a.type=C[Object.prototype.toString.call(n)]|0);else if(b(n)){a.channels=a.channels||4;l=n;r=l.length;switch(a.type){case 5121:case 5123:case 5125:case 5126:r=x.allocType(a.type,r);r.set(l);a.data=r;break;case 36193:a.data=v(l);break;default:f.raise("unsupported texture type, must specify a typed array")}a.alignment=
1;a.needsFree=!0}else if(k(n)){l=n.data;Array.isArray(l)||5121!==a.type||(a.type=C[Object.prototype.toString.call(l)]|0);var r=n.shape,e=n.stride,q,h,t,M;3===r.length?(t=r[2],M=e[2]):(f(2===r.length,"invalid ndarray pixel data, must be 2 or 3D"),M=t=1);q=r[0];h=r[1];r=e[0];e=e[1];a.alignment=1;a.width=q;a.height=h;a.channels=t;a.format=a.internalformat=B[t];a.needsFree=!0;q=M;n=n.offset;t=a.width;M=a.height;h=a.channels;for(var E=x.allocType(36193===a.type?5126:a.type,t*M*h),A=0,ca=0;ca<M;++ca)for(var F=
0;F<t;++F)for(var G=0;G<h;++G)E[A++]=l[r*F+e*ca+q*G+n];p(a,E)}else if("[object HTMLCanvasElement]"===c(n)||"[object CanvasRenderingContext2D]"===c(n))"[object HTMLCanvasElement]"===c(n)?a.element=n:a.element=n.canvas,a.width=a.element.width,a.height=a.element.height,a.channels=4;else if("[object HTMLImageElement]"===c(n))a.element=n,a.width=n.naturalWidth,a.height=n.naturalHeight,a.channels=4;else if("[object HTMLVideoElement]"===c(n))a.element=n,a.width=n.videoWidth,a.height=n.videoHeight,a.channels=
4;else if(g(n)){l=a.width||n[0].length;r=a.height||n.length;e=a.channels;e=y(n[0][0])?e||n[0][0].length:e||1;q=w.shape(n);t=1;for(M=0;M<q.length;++M)t*=q[M];t=x.allocType(36193===a.type?5126:a.type,t);w.flatten(n,q,"",t);p(a,t);a.alignment=1;a.width=l;a.height=r;a.channels=e;a.format=a.internalformat=B[e];a.needsFree=!0}5126===a.type?f(0<=u.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):36193===a.type&&f(0<=u.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}
function M(b,c,d,f,g){var n=b.element,l=b.data,r=b.internalformat,e=b.format,k=b.type,p=b.width,u=b.height;m(b);n?a.texSubImage2D(c,g,d,f,e,k,n):b.compressed?a.compressedTexSubImage2D(c,g,d,f,r,p,u,l):b.needsCopy?(h(),a.copyTexSubImage2D(c,g,d,f,b.xOffset,b.yOffset,p,u)):a.texSubImage2D(c,g,d,f,p,u,e,k,l)}function ca(){return Ha.pop()||new n}function ka(b){b.needsFree&&x.freeType(b.data);n.call(b);Ha.push(b)}function qa(){T.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=
Array(16)}function Z(b,a,c){var d=b.images[0]=ca();b.mipmask=1;d.width=b.width=a;d.height=b.height=c;d.channels=b.channels=4}function Q(b,a){var c=null;if(d(a))c=b.images[0]=ca(),L(c,b),r(c,a),b.mipmask=1;else if(S(b,a),Array.isArray(a.mipmap))for(var m=a.mipmap,g=0;g<m.length;++g)c=b.images[g]=ca(),L(c,b),c.width>>=g,c.height>>=g,r(c,m[g]),b.mipmask|=1<<g;else c=b.images[0]=ca(),L(c,b),r(c,a),b.mipmask=1;L(b,b.images[0]);(b.compressed&&33776===b.internalformat||33777===b.internalformat||33778===
b.internalformat||33779===b.internalformat)&&f(0===b.width%4&&0===b.height%4,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function N(b,c){for(var d=b.images,f=0;f<d.length&&d[f];++f){var g=d[f],n=c,l=f,r=g.element,e=g.data,k=g.internalformat,p=g.format,u=g.type,q=g.width,t=g.height;m(g);r?a.texImage2D(n,l,p,p,u,r):g.compressed?a.compressedTexImage2D(n,l,k,q,t,0,e):g.needsCopy?(h(),a.copyTexImage2D(n,l,p,g.xOffset,g.yOffset,q,t,0)):a.texImage2D(n,
l,p,q,t,0,p,u,e)}}function xa(){var b=Ia.pop()||new qa;T.call(b);for(var a=b.mipmask=0;16>a;++a)b.images[a]=null;return b}function na(b){for(var a=b.images,c=0;c<a.length;++c)a[c]&&ka(a[c]),a[c]=null;Ia.push(b)}function ra(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function aa(b,a){if("min"in a){var c=a.min;f.parameter(c,ea);b.minFilter=ea[c];0<=A.indexOf(b.minFilter)&&(b.genMipmaps=!0)}"mag"in a&&(c=a.mag,f.parameter(c,
X),b.magFilter=X[c]);var c=b.wrapS,d=b.wrapT;if("wrap"in a){var m=a.wrap;"string"===typeof m?(f.parameter(m,W),c=d=W[m]):Array.isArray(m)&&(f.parameter(m[0],W),f.parameter(m[1],W),c=W[m[0]],d=W[m[1]])}else"wrapS"in a&&(c=a.wrapS,f.parameter(c,W),c=W[c]),"wrapT"in a&&(d=a.wrapT,f.parameter(d,W),d=W[d]);b.wrapS=c;b.wrapT=d;"anisotropic"in a&&(c=a.anisotropic,f("number"===typeof c&&1<=c&&c<=u.maxAnisotropic,"aniso samples must be between 1 and "),b.anisotropic=a.anisotropic);if("mipmap"in a){c=!1;switch(typeof a.mipmap){case "string":f.parameter(a.mipmap,
sa,"invalid mipmap hint");b.mipmapHint=sa[a.mipmap];c=b.genMipmaps=!0;break;case "boolean":c=b.genMipmaps=a.mipmap;break;case "object":f(Array.isArray(a.mipmap),"invalid mipmap type");b.genMipmaps=!1;c=!0;break;default:f.raise("invalid mipmap type")}!c||"min"in a||(b.minFilter=9984)}}function ga(b,c){a.texParameteri(c,10241,b.minFilter);a.texParameteri(c,10240,b.magFilter);a.texParameteri(c,10242,b.wrapS);a.texParameteri(c,10243,b.wrapT);e.ext_texture_filter_anisotropic&&a.texParameteri(c,34046,b.anisotropic);
b.genMipmaps&&(a.hint(33170,b.mipmapHint),a.generateMipmap(c))}function ha(b){T.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ka++;this.refCount=1;this.target=b;this.texture=a.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new ra;J.profile&&(this.stats={size:0})}function ia(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function ja(){var b=ba[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function la(b){var c=b.texture;f(c,"must not double destroy texture");
var d=b.unit,m=b.target;0<=d&&(a.activeTexture(33984+d),a.bindTexture(m,null),ba[d]=null);a.deleteTexture(c);b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete pa[b.id];G.textureCount--}var sa={"don't care":4352,"dont care":4352,nice:4354,fast:4353},W={repeat:10497,clamp:33071,mirror:33648},X={nearest:9728,linear:9729},ea=q({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},X),V={none:0,browser:37444},P={uint8:5121,
rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},da={};e.ext_srgb&&(Y.srgb=35904,Y.srgba=35906);e.oes_texture_float&&(P.float32=P["float"]=5126);e.oes_texture_half_float&&(P.float16=P["half float"]=36193);e.webgl_depth_texture&&(q(Y,{depth:6402,"depth stencil":34041}),q(P,{uint16:5123,uint32:5125,"depth stencil":34042}));e.webgl_compressed_texture_s3tc&&q(da,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,
"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});e.webgl_compressed_texture_atc&&q(da,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});e.webgl_compressed_texture_pvrtc&&q(da,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});e.webgl_compressed_texture_etc1&&(da["rgb etc1"]=36196);var ta=Array.prototype.slice.call(a.getParameter(34467));Object.keys(da).forEach(function(b){var a=da[b];0<=ta.indexOf(a)&&(Y[b]=
a)});var fa=Object.keys(Y);u.textureFormats=fa;var oa=[];Object.keys(Y).forEach(function(b){oa[Y[b]]=b});var ya=[];Object.keys(P).forEach(function(b){ya[P[b]]=b});var Aa=[];Object.keys(X).forEach(function(b){Aa[X[b]]=b});var Ea=[];Object.keys(ea).forEach(function(b){Ea[ea[b]]=b});var za=[];Object.keys(W).forEach(function(b){za[W[b]]=b});var Fa=fa.reduce(function(b,a){var c=Y[a];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?b[c]=c:32855===c||0<=a.indexOf("rgba")?b[c]=6408:b[c]=6407;return b},
{}),Ha=[],Ia=[],Ka=0,pa={},ma=u.maxTextureUnits,ba=Array(ma).map(function(){return null});q(ha.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<ma;++c){var d=ba[c];if(d){if(0<d.bindCount)continue;d.unit=-1}ba[c]=this;b=c;break}b>=ma&&f.raise("insufficient number of texture units");J.profile&&G.maxTextureUnits<b+1&&(G.maxTextureUnits=b+1);this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=
--this.refCount&&la(this)}});J.profile&&(G.getTotalTextureSize=function(){var b=0;Object.keys(pa).forEach(function(a){b+=pa[a].stats.size});return b});return{create2D:function(b,c){function d(b,a){var c=m.texInfo;ra.call(c);var g=xa();"number"===typeof b?"number"===typeof a?Z(g,b|0,a|0):Z(g,b|0,b|0):b?(f.type(b,"object","invalid arguments to regl.texture"),aa(c,b),Q(g,b)):Z(g,1,1);c.genMipmaps&&(g.mipmask=(g.width<<1)-1);m.mipmask=g.mipmask;L(m,g);f.texture2D(c,g,u);m.internalformat=g.internalformat;
d.width=g.width;d.height=g.height;ia(m);N(g,3553);ga(c,3553);ja();na(g);J.profile&&(m.stats.size=l(m.internalformat,m.type,g.width,g.height,c.genMipmaps,!1));d.format=oa[m.internalformat];d.type=ya[m.type];d.mag=Aa[c.magFilter];d.min=Ea[c.minFilter];d.wrapS=za[c.wrapS];d.wrapT=za[c.wrapT];return d}var m=new ha(3553);pa[m.id]=m;G.textureCount++;d(b,c);d.subimage=function(b,a,c,g){f(!!b,"must specify image data");a|=0;c|=0;g|=0;var n=ca();L(n,m);n.width=0;n.height=0;r(n,b);n.width=n.width||(m.width>>
g)-a;n.height=n.height||(m.height>>g)-c;f(m.type===n.type&&m.format===n.format&&m.internalformat===n.internalformat,"incompatible format for texture.subimage");f(0<=a&&0<=c&&a+n.width<=m.width&&c+n.height<=m.height,"texture.subimage write out of bounds");f(m.mipmask&1<<g,"missing mipmap data");f(n.data||n.element||n.needsCopy,"missing image data");ia(m);M(n,3553,a,c,g);ja();ka(n);return d};d.resize=function(b,c){var f=b|0,g=c|0||f;if(f===m.width&&g===m.height)return d;d.width=m.width=f;d.height=m.height=
g;ia(m);for(var n=0;m.mipmask>>n;++n)a.texImage2D(3553,n,m.format,f>>n,g>>n,0,m.format,m.type,null);ja();J.profile&&(m.stats.size=l(m.internalformat,m.type,f,g,!1,!1));return d};d._reglType="texture2d";d._texture=m;J.profile&&(d.stats=m.stats);d.destroy=function(){m.decRef()};return d},createCube:function(b,c,d,m,g,n){function e(b,a,c,d,m,g){var n,r=k.texInfo;ra.call(r);for(n=0;6>n;++n)p[n]=xa();if("number"!==typeof b&&b)if("object"===typeof b)if(a)Q(p[0],b),Q(p[1],a),Q(p[2],c),Q(p[3],d),Q(p[4],m),
Q(p[5],g);else if(aa(r,b),S(k,b),"faces"in b)for(b=b.faces,f(Array.isArray(b)&&6===b.length,"cube faces must be a length 6 array"),n=0;6>n;++n)f("object"===typeof b[n]&&!!b[n],"invalid input for cube map face"),L(p[n],k),Q(p[n],b[n]);else for(n=0;6>n;++n)Q(p[n],b);else f.raise("invalid arguments to cube map");else for(b=b|0||1,n=0;6>n;++n)Z(p[n],b,b);L(k,p[0]);k.mipmask=r.genMipmaps?(p[0].width<<1)-1:p[0].mipmask;f.textureCube(k,r,p,u);k.internalformat=p[0].internalformat;e.width=p[0].width;e.height=
p[0].height;ia(k);for(n=0;6>n;++n)N(p[n],34069+n);ga(r,34067);ja();J.profile&&(k.stats.size=l(k.internalformat,k.type,e.width,e.height,r.genMipmaps,!0));e.format=oa[k.internalformat];e.type=ya[k.type];e.mag=Aa[r.magFilter];e.min=Ea[r.minFilter];e.wrapS=za[r.wrapS];e.wrapT=za[r.wrapT];for(n=0;6>n;++n)na(p[n]);return e}var k=new ha(34067);pa[k.id]=k;G.cubeCount++;var p=Array(6);e(b,c,d,m,g,n);e.subimage=function(b,a,c,d,m){f(!!a,"must specify image data");f("number"===typeof b&&b===(b|0)&&0<=b&&6>b,
"invalid face");c|=0;d|=0;m|=0;var g=ca();L(g,k);g.width=0;g.height=0;r(g,a);g.width=g.width||(k.width>>m)-c;g.height=g.height||(k.height>>m)-d;f(k.type===g.type&&k.format===g.format&&k.internalformat===g.internalformat,"incompatible format for texture.subimage");f(0<=c&&0<=d&&c+g.width<=k.width&&d+g.height<=k.height,"texture.subimage write out of bounds");f(k.mipmask&1<<m,"missing mipmap data");f(g.data||g.element||g.needsCopy,"missing image data");ia(k);M(g,34069+b,c,d,m);ja();ka(g);return e};e.resize=
function(b){b|=0;if(b!==k.width){e.width=k.width=b;e.height=k.height=b;ia(k);for(var c=0;6>c;++c)for(var d=0;k.mipmask>>d;++d)a.texImage2D(34069+c,d,k.format,b>>d,b>>d,0,k.format,k.type,null);ja();J.profile&&(k.stats.size=l(k.internalformat,k.type,e.width,e.height,!1,!0));return e}};e._reglType="textureCube";e._texture=k;J.profile&&(e.stats=k.stats);e.destroy=function(){k.decRef()};return e},clear:function(){for(var b=0;b<ma;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ba[b]=null;t(pa).forEach(la);
G.cubeCount=0;G.textureCount=0},getTexture:function(b){return null},restore:function(){t(pa).forEach(function(b){b.texture=a.createTexture();a.bindTexture(b.target,b.texture);for(var c=0;32>c;++c)if(0!==(b.mipmask&1<<c))if(3553===b.target)a.texImage2D(3553,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);else for(var d=0;6>d;++d)a.texImage2D(34069+d,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);ga(b.texInfo,b.target)})}}}},{"./constants/arraytypes.json":5,
"./util/check":22,"./util/extend":25,"./util/flatten":26,"./util/is-array-like":27,"./util/is-ndarray":28,"./util/is-typed-array":29,"./util/pool":31,"./util/to-half-float":33,"./util/values":34}],21:[function(a,e,h){e.exports=function(b,a){function c(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function d(b,a,d){var f=q.pop()||new c;f.startQueryIndex=b;f.endQueryIndex=a;f.sum=0;f.stats=d;h.push(f)}var e=a.ext_disjoint_timer_query;if(!e)return null;var l=[],f=[],q=[],h=
[],z=[],k=[];return{beginQuery:function(b){var a=l.pop()||e.createQueryEXT();e.beginQueryEXT(35007,a);f.push(a);d(f.length-1,f.length,b)},endQuery:function(){e.endQueryEXT(35007)},pushScopeStats:d,update:function(){var b,a;b=f.length;if(0!==b){k.length=Math.max(k.length,b+1);z.length=Math.max(z.length,b+1);z[0]=0;var c=k[0]=0;for(a=b=0;a<f.length;++a){var d=f[a];e.getQueryObjectEXT(d,34919)?(c+=e.getQueryObjectEXT(d,34918),l.push(d)):f[b++]=d;z[a+1]=c;k[a+1]=b}f.length=b;for(a=b=0;a<h.length;++a){var c=
h[a],g=c.startQueryIndex,d=c.endQueryIndex;c.sum+=z[d]-z[g];g=k[g];d=k[d];d===g?(c.stats.gpuTime+=c.sum/1E6,q.push(c)):(c.startQueryIndex=g,c.endQueryIndex=d,h[b++]=c)}h.length=b}},getNumPendingQueries:function(){return f.length},clear:function(){l.push.apply(l,f);for(var b=0;b<l.length;b++)e.deleteQueryEXT(l[b]);f.length=0;l.length=0},restore:function(){f.length=0;l.length=0}}}},{}],22:[function(a,e,h){function b(b){return"undefined"!==typeof btoa?btoa(b):"base64:"+b}function g(b){b=Error("(regl) "+
b);console.error(b);throw b;}function c(b,a){b||g(a)}function d(b){return b?": "+b:""}function p(b,a,c){0>a.indexOf(b)&&g("invalid value"+d(c)+". must be one of: "+a)}function l(b,a){for(b+="";b.length<a;)b=" "+b;return b}function f(){this.name="unknown";this.lines=[];this.index={};this.hasErrors=!1}function q(b,a){this.number=b;this.line=a;this.errors=[]}function t(b,a,c){this.file=b;this.line=a;this.message=c}function z(){var b=Error(),b=(b.stack||b).toString(),a=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(b);
return a?a[1]:(b=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(b))?b[1]:"unknown"}function k(){var b=Error(),b=(b.stack||b).toString(),a=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(b);return a?a[1]:(b=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(b))?b[1]:"unknown"}function x(a,c){var d=a.split("\n"),g=1,l=0,e={unknown:new f,0:new f};e.unknown.name=e[0].name=c||z();e.unknown.lines.push(new q(0,""));for(var k=0;k<d.length;++k){var p=d[k],h=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(p);if(h)switch(h[1]){case "line":if(h=
/(\d+)(\s+\d+)?/.exec(h[2]))g=h[1]|0,h[2]&&(l=h[2]|0,l in e||(e[l]=new f));break;case "define":if(h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(h[2]))e[l].name=h[1]?b(h[2]):h[2]}e[l].lines.push(new q(g++,p))}Object.keys(e).forEach(function(b){var a=e[b];a.lines.forEach(function(b){a.index[b.number]=b})});return e}function v(b){var a=[];b.split("\n").forEach(function(b){if(!(5>b.length)){var c=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(b);c?a.push(new t(c[1]|0,c[2]|0,c[3].trim())):0<b.length&&a.push(new t("unknown",
0,b))}});return a}function y(b,a){a.forEach(function(a){var c=b[a.file];if(c){var d=c.index[a.line];if(d){d.errors.push(a);c.hasErrors=!0;return}}b.unknown.hasErrors=!0;b.unknown.lines[0].errors.push(a)})}function w(b){b._commandRef=z()}function C(b,a){var c=k();g(b+" in command "+(a||z())+("unknown"===c?"":" called from "+c))}function A(b,a,c,f){typeof b!==a&&C("invalid parameter type"+d(c)+". expected "+a+", got "+typeof b,f||z())}function B(b,a){return 32820===b||32819===b||33635===b?2:34042===
b?4:D[b]*a}var F=a("./is-typed-array");a=a("./extend");var G="gl canvas container attributes pixelRatio extensions optionalExtensions profile onDone".split(" "),D={};D[5120]=D[5121]=1;D[5122]=D[5123]=D[36193]=D[33635]=D[32819]=D[32820]=2;D[5124]=D[5125]=D[5126]=D[34042]=4;e.exports=a(c,{optional:function(b){b()},raise:g,commandRaise:C,command:function(b,a,c){b||C(a,c||z())},parameter:function(b,a,c){b in a||g("unknown parameter ("+b+")"+d(c)+". possible values: "+Object.keys(a).join())},commandParameter:function(b,
a,c,f){b in a||C("unknown parameter ("+b+")"+d(c)+". possible values: "+Object.keys(a).join(),f||z())},constructor:function(b){Object.keys(b).forEach(function(b){0>G.indexOf(b)&&g('invalid regl constructor argument "'+b+'". must be one of '+G)})},type:function(b,a,c){typeof b!==a&&g("invalid parameter type"+d(c)+". expected "+a+", got "+typeof b)},commandType:A,isTypedArray:function(b,a){F(b)||g("invalid parameter type"+d(a)+". must be a typed array")},nni:function(b,a){0<=b&&(b|0)===b||g("invalid parameter type, ("+
b+")"+d(a)+". must be a nonnegative integer")},oneOf:p,shaderError:function(b,a,d,f,g){if(!b.getShaderParameter(a,b.COMPILE_STATUS)){a=b.getShaderInfoLog(a);b=f===b.FRAGMENT_SHADER?"fragment":"vertex";A(d,"string",b+" shader source must be a string",g);var e=x(d,g);d=v(a);y(e,d);Object.keys(e).forEach(function(b){function a(b,c){d.push(b);f.push(c||"")}var c=e[b];if(c.hasErrors){var d=[""],f=[""];a("file number "+b+": "+c.name+"\n","color:red;text-decoration:underline;font-weight:bold");c.lines.forEach(function(b){if(0<
b.errors.length){a(l(b.number,4)+"|  ","background-color:yellow; font-weight:bold");a(b.line+"\n","color:red; background-color:yellow; font-weight:bold");var c=0;b.errors.forEach(function(d){d=d.message;var f=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(d);if(f){var g=f[1];d=f[2];switch(g){case "assign":g="="}c=Math.max(b.line.indexOf(g,c),0)}else c=0;a(l("| ",6));a(l("^^^",c+3)+"\n","font-weight:bold");a(l("| ",6));a(d+"\n","font-weight:bold")});a(l("| ",6)+"\n")}else a(l(b.number,4)+"|  "),a(b.line+"\n","color:red")});
"undefined"!==typeof document?(f[0]=d.join("%c"),console.log.apply(console,f)):console.log(d.join(""))}});c.raise("Error compiling "+b+" shader, "+e[0].name)}},linkError:function(b,a,d,f,g){b.getProgramParameter(a,b.LINK_STATUS)||(b=b.getProgramInfoLog(a),d=x(d,g),f='Error linking program with vertex shader, "'+x(f,g)[0].name+'", and fragment shader "'+d[0].name+'"',"undefined"!==typeof document?console.log("%c"+f+"\n%c"+b,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+
"\n"+b),c.raise(f))},callSite:k,saveCommandRef:w,saveDrawInfo:function(b,a,c,d){function f(b){return b?d.id(b):0}function g(b,a){Object.keys(a).forEach(function(a){b[d.id(a)]=!0})}w(b);b._fragId=f(b["static"].frag);b._vertId=f(b["static"].vert);var l=b._uniformSet={};g(l,a["static"]);g(l,a.dynamic);a=b._attributeSet={};g(a,c["static"]);g(a,c.dynamic);b._hasCount="count"in b["static"]||"count"in b.dynamic||"elements"in b["static"]||"elements"in b.dynamic},framebufferFormat:function(b,a,c){b.texture?
p(b.texture._texture.internalformat,a,"unsupported texture format for attachment"):p(b.renderbuffer._renderbuffer.format,c,"unsupported renderbuffer format for attachment")},guessCommand:z,texture2D:function(b,a,d){var f=a.width,g=a.height,l=a.channels;c(0<f&&f<=d.maxTextureSize&&0<g&&g<=d.maxTextureSize,"invalid texture shape");33071===b.wrapS&&33071===b.wrapT||c(!(f&f-1)&&!!f&&!(g&g-1)&&!!g,"incompatible wrap mode for texture, both width and height must be power of 2");1===a.mipmask?1!==f&&1!==
g&&c(9984!==b.minFilter&&9986!==b.minFilter&&9985!==b.minFilter&&9987!==b.minFilter,"min filter requires mipmap"):(c(!(f&f-1)&&!!f&&!(g&g-1)&&!!g,"texture must be a square power of 2 to support mipmapping"),c(a.mipmask===(f<<1)-1,"missing or incomplete mipmap data"));5126===a.type&&(0>d.extensions.indexOf("oes_texture_float_linear")&&c(9728===b.minFilter&&9728===b.magFilter,"filter not supported, must enable oes_texture_float_linear"),c(!b.genMipmaps,"mipmap generation not supported with float textures"));
var e=a.images;for(d=0;16>d;++d)if(e[d]){var k=f>>d,p=g>>d;c(a.mipmask&1<<d,"missing mipmap data");var h=e[d];c(h.width===k&&h.height===p,"invalid shape for mip images");c(h.format===a.format&&h.internalformat===a.internalformat&&h.type===a.type,"incompatible type for mip image");h.compressed||h.data&&c(h.data.byteLength===k*p*Math.max(B(h.type,l),h.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}else b.genMipmaps||c(0===(a.mipmask&1<<d),"extra mipmap data");
a.compressed&&c(!b.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(b,a,d,f){var g=b.width,l=b.height,e=b.channels;c(0<g&&g<=f.maxTextureSize&&0<l&&l<=f.maxTextureSize,"invalid texture shape");c(g===l,"cube map must be square");c(33071===a.wrapS&&33071===a.wrapT,"wrap mode not supported by cube map");for(f=0;f<d.length;++f){var k=d[f];c(k.width===g&&k.height===l,"inconsistent cube map face shape");a.genMipmaps&&(c(!k.compressed,"can not generate mipmap for compressed textures"),
c(1===k.mipmask,"can not specify mipmaps and generate mipmaps"));for(var p=k.images,h=0;16>h;++h){var q=p[h];if(q){var m=g>>h,n=l>>h;c(k.mipmask&1<<h,"missing mipmap data");c(q.width===m&&q.height===n,"invalid shape for mip images");c(q.format===b.format&&q.internalformat===b.internalformat&&q.type===b.type,"incompatible type for mip image");q.compressed||q.data&&c(q.data.byteLength===m*n*Math.max(B(q.type,e),q.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}})},
{"./extend":25,"./is-typed-array":29}],23:[function(a,e,h){e.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],24:[function(a,e,h){function b(b){return Array.prototype.slice.call(b)}function g(a){return b(a).join("")}var c=a("./extend");e.exports=function(){function a(){var d=[],f=[];return c(function(){d.push.apply(d,b(arguments))},{def:function(){var a="v"+l++;f.push(a);0<arguments.length&&(d.push(a,"="),d.push.apply(d,
b(arguments)),d.push(";"));return a},toString:function(){return g([0<f.length?"var "+f+";":"",g(d)])}})}function e(){function f(b,a){l(b,a,"=",g.def(b,a),";")}var g=a(),l=a(),p=g.toString,h=l.toString;return c(function(){g.apply(g,b(arguments))},{def:g.def,entry:g,exit:l,save:f,set:function(b,a,c){f(b,a);g(b,a,"=",c,";")},toString:function(){return p()+h()}})}var l=0,f=[],h=[],t=a(),z={};return{global:t,link:function(b){for(var a=0;a<h.length;++a)if(h[a]===b)return f[a];a="g"+l++;f.push(a);h.push(b);
return a},block:a,proc:function(b,a){function d(){var b="a"+f.length;f.push(b);return b}var f=[];a=a||0;for(var l=0;l<a;++l)d();var l=e(),h=l.toString;return z[b]=c(l,{arg:d,toString:function(){return g(["function(",f.join(),"){",h(),"}"])}})},scope:e,cond:function(){var a=g(arguments),d=e(),f=e(),l=d.toString,h=f.toString;return c(d,{then:function(){d.apply(d,b(arguments));return this},"else":function(){f.apply(f,b(arguments));return this},toString:function(){var b=h();b&&(b="else{"+b+"}");return g(["if(",
a,"){",l(),"}",b])}})},compile:function(){var b=['"use strict";',t,"return {"];Object.keys(z).forEach(function(a){b.push('"',a,'":',z[a].toString(),",")});b.push("}");var a=g(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,f.concat(a)).apply(null,h)}}}},{"./extend":25}],25:[function(a,e,h){e.exports=function(b,a){for(var c=Object.keys(a),d=0;d<c.length;++d)b[c[d]]=a[c[d]];return b}},{}],26:[function(a,e,h){function b(b,a,c,f,g,e){for(var h=0;h<a;++h)for(var k=
b[h],x=0;x<c;++x)for(var v=k[x],y=0;y<f;++y)g[e++]=v[y]}function g(a,c,l,f,e){for(var h=1,z=l+1;z<c.length;++z)h*=c[z];var k=c[l];if(4===c.length-l){var x=c[l+1],v=c[l+2];c=c[l+3];for(z=0;z<k;++z)b(a[z],x,v,c,f,e),e+=h}else for(z=0;z<k;++z)g(a[z],c,l+1,f,e),e+=h}var c=a("./pool");e.exports={shape:function(b){for(var a=[];b.length;b=b[0])a.push(b.length);return a},flatten:function(a,e,l,f){var h=1;if(e.length)for(var t=0;t<e.length;++t)h*=e[t];else h=0;l=f||c.allocType(l,h);switch(e.length){case 0:break;
case 1:f=e[0];for(e=0;e<f;++e)l[e]=a[e];break;case 2:f=e[0];e=e[1];for(t=h=0;t<f;++t)for(var z=a[t],k=0;k<e;++k)l[h++]=z[k];break;case 3:b(a,e[0],e[1],e[2],l,0);break;default:g(a,e,0,l,0)}return l}}},{"./pool":31}],27:[function(a,e,h){var b=a("./is-typed-array");e.exports=function(a){return Array.isArray(a)||b(a)}},{"./is-typed-array":29}],28:[function(a,e,h){var b=a("./is-typed-array");e.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===
typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||b(a.data))}},{"./is-typed-array":29}],29:[function(a,e,h){var b=a("../constants/arraytypes.json");e.exports=function(a){return Object.prototype.toString.call(a)in b}},{"../constants/arraytypes.json":5}],30:[function(a,e,h){e.exports=function(b,a){for(var c=Array(b),d=0;d<b;++d)c[d]=a(d);return c}},{}],31:[function(a,e,h){function b(b){var a,c;a=(65535<b)<<4;b>>>=a;c=(255<b)<<3;b>>>=c;a|=c;c=(15<b)<<2;b>>>=c;a|=c;c=(3<b)<<1;
return a|c|b>>>c>>1}function g(a){a:{for(var c=16;268435456>=c;c*=16)if(a<=c){a=c;break a}a=0}c=d[b(a)>>2];return 0<c.length?c.pop():new ArrayBuffer(a)}function c(a){d[b(a.byteLength)>>2].push(a)}var d=a("./loop")(8,function(){return[]});e.exports={alloc:g,free:c,allocType:function(b,a){var c=null;switch(b){case 5120:c=new Int8Array(g(a),0,a);break;case 5121:c=new Uint8Array(g(a),0,a);break;case 5122:c=new Int16Array(g(2*a),0,a);break;case 5123:c=new Uint16Array(g(2*a),0,a);break;case 5124:c=new Int32Array(g(4*
a),0,a);break;case 5125:c=new Uint32Array(g(4*a),0,a);break;case 5126:c=new Float32Array(g(4*a),0,a);break;default:return null}return c.length!==a?c.subarray(0,a):c},freeType:function(b){c(b.buffer)}}},{"./loop":30}],32:[function(a,e,h){e.exports={next:"function"===typeof requestAnimationFrame?function(b){return requestAnimationFrame(b)}:function(b){return setTimeout(b,16)},cancel:"function"===typeof cancelAnimationFrame?function(b){return cancelAnimationFrame(b)}:clearTimeout}},{}],33:[function(a,
e,h){var b=a("./pool"),g=new Float32Array(1),c=new Uint32Array(g.buffer);e.exports=function(a){for(var e=b.allocType(5123,a.length),l=0;l<a.length;++l)if(isNaN(a[l]))e[l]=65535;else if(Infinity===a[l])e[l]=31744;else if(-Infinity===a[l])e[l]=64512;else{g[0]=a[l];var f=c[0],h=f>>>31<<15,t=(f<<1>>>24)-127,f=f>>13&1023;e[l]=-24>t?h:-14>t?h+(f+1024>>-14-t):15<t?h+31744:h+(t+15<<10)+f}return e}},{"./pool":31}],34:[function(a,e,h){e.exports=function(b){return Object.keys(b).map(function(a){return b[a]})}},
{}],35:[function(a,e,h){function b(b,a,c){function d(){var a=window.innerWidth,e=window.innerHeight;b!==document.body&&(e=b.getBoundingClientRect(),a=e.right-e.left,e=e.bottom-e.top);g.width=c*a;g.height=c*e;l(g.style,{width:a+"px",height:e+"px"})}var g=document.createElement("canvas");l(g.style,{border:0,margin:0,padding:0,top:0,left:0});b.appendChild(g);b===document.body&&(g.style.position="absolute",l(b.style,{margin:0,padding:0}));window.addEventListener("resize",d,!1);d();return{canvas:g,onDestroy:function(){window.removeEventListener("resize",
d);b.removeChild(g)}}}function g(b,a){function c(d){try{return b.getContext(d,a)}catch(g){return null}}return c("webgl")||c("experimental-webgl")||c("webgl-experimental")}function c(b){if("string"===typeof b)return b.split();p(Array.isArray(b),"invalid extension array");return b}function d(b){return"string"===typeof b?(p("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(b)):b}var p=a("./util/check"),l=a("./util/extend");e.exports=function(a){var e=a||{},l,h,k,x;
a={};var v=[],y=[],w="undefined"===typeof window?1:window.devicePixelRatio,C=!1,A=function(b){b&&p.raise(b)},B=function(){};"string"===typeof e?(p("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),l=document.querySelector(e),p(l,"invalid query string for element")):"object"===typeof e?"string"===typeof e.nodeName&&"function"===typeof e.appendChild&&"function"===typeof e.getBoundingClientRect?l=e:"function"===typeof e.drawArrays||"function"===typeof e.drawElements?
(x=e,k=x.canvas):(p.constructor(e),"gl"in e?x=e.gl:"canvas"in e?k=d(e.canvas):"container"in e&&(h=d(e.container)),"attributes"in e&&(a=e.attributes,p.type(a,"object","invalid context attributes")),"extensions"in e&&(v=c(e.extensions)),"optionalExtensions"in e&&(y=c(e.optionalExtensions)),"onDone"in e&&(p.type(e.onDone,"function","invalid or missing onDone callback"),A=e.onDone),"profile"in e&&(C=!!e.profile),"pixelRatio"in e&&(w=+e.pixelRatio,p(0<w,"invalid pixel ratio"))):p.raise("invalid arguments to regl");
l&&("canvas"===l.nodeName.toLowerCase()?k=l:h=l);if(!x){if(!k){p("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");l=b(h||document.body,A,w);if(!l)return null;k=l.canvas;B=l.onDestroy}x=g(k,a)}return x?{gl:x,canvas:k,container:h,extensions:v,optionalExtensions:y,pixelRatio:w,profile:C,onDone:A,onDestroy:B}:(B(),A("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/check":22,"./util/extend":25}],
36:[function(a,e,h){function b(b,a,d){return Math.sqrt(Math.pow(b,2)+Math.pow(a,2)+Math.pow(d,2))}e.exports=function(a,c){for(var d=c.length,e=a.length,l=Array(d),f=0;f<d;++f)l[f]=[0,0,0];for(f=0;f<e;++f){var h=a[f],t=c[h[0]],z=c[h[1]],k=c[h[2]],x=t[0]-z[0],v=t[1]-z[1],y=t[2]-z[2],w=b(x,v,y),C=z[0]-k[0],A=z[1]-k[1],B=z[2]-k[2],F=b(C,A,B),G=b(k[0]-t[0],k[1]-t[1],k[2]-t[2]);1E-6>Math.min(w,F,G)||(k=.5*(w+F+G),z=Math.sqrt((k-w)*(k-F)*(k-G)/k),t=v*B-y*A,y=y*C-x*B,x=x*A-v*C,v=b(t,y,x),t/=v,y/=v,x/=v,v=
l[h[0]],F=Math.atan2(z,k-F),C=y,A=x,v[0]+=F*t,v[1]+=F*C,v[2]+=F*A,F=l[h[1]],G=Math.atan2(z,k-G),v=y,C=x,F[0]+=G*t,F[1]+=G*v,F[2]+=G*C,h=l[h[2]],w=Math.atan2(z,k-w),k=y,z=x,h[0]+=w*t,h[1]+=w*k,h[2]+=w*z)}for(f=0;f<d;++f)e=l[f],w=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)),1E-8>w?(e[0]=1,e[1]=0,e[2]=0):(e[0]/=w,e[1]/=w,e[2]/=w);return l}},{}],37:[function(a,e,h){function b(b){var a=b.length;if(0<a%4)throw Error("Invalid string. Length must be a multiple of 4");return"="===b[a-2]?2:
"="===b[a-1]?1:0}function g(b,a,d){for(var g=[],e=a;e<d;e+=3)a=(b[e]<<16)+(b[e+1]<<8)+b[e+2],g.push(c[a>>18&63]+c[a>>12&63]+c[a>>6&63]+c[a&63]);return g.join("")}h.byteLength=function(a){return 3*a.length/4-b(a)};h.toByteArray=function(a){var c,g,e,h,k;c=a.length;h=b(a);k=new p(3*c/4-h);g=0<h?c-4:c;var x=0;for(c=0;c<g;c+=4)e=d[a.charCodeAt(c)]<<18|d[a.charCodeAt(c+1)]<<12|d[a.charCodeAt(c+2)]<<6|d[a.charCodeAt(c+3)],k[x++]=e>>16&255,k[x++]=e>>8&255,k[x++]=e&255;2===h?(e=d[a.charCodeAt(c)]<<2|d[a.charCodeAt(c+
1)]>>4,k[x++]=e&255):1===h&&(e=d[a.charCodeAt(c)]<<10|d[a.charCodeAt(c+1)]<<4|d[a.charCodeAt(c+2)]>>2,k[x++]=e>>8&255,k[x++]=e&255);return k};h.fromByteArray=function(b){for(var a=b.length,d=a%3,e="",h=[],k=0,p=a-d;k<p;k+=16383)h.push(g(b,k,k+16383>p?p:k+16383));1===d?(b=b[a-1],e+=c[b>>2],e+=c[b<<4&63],e+="=="):2===d&&(b=(b[a-2]<<8)+b[a-1],e+=c[b>>10],e+=c[b>>4&63],e+=c[b<<2&63],e+="=");h.push(e);return h.join("")};var c=[],d=[],p="undefined"!==typeof Uint8Array?Uint8Array:Array;for(a=0;64>a;++a)c[a]=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a],d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;d[45]=62;d[95]=63},{}],38:[function(a,e,h){function b(b){var a=32;(b&=-b)&&a--;b&65535&&(a-=16);b&16711935&&(a-=8);b&252645135&&(a-=4);b&858993459&&(a-=2);b&1431655765&&--a;return a}"use restrict";h.INT_BITS=32;h.INT_MAX=2147483647;h.INT_MIN=-2147483648;h.sign=function(b){return(0<b)-(0>b)};h.abs=function(b){var a=b>>31;return(b^a)-a};h.min=function(b,
a){return a^(b^a)&-(b<a)};h.max=function(b,a){return b^(b^a)&-(b<a)};h.isPow2=function(b){return!(b&b-1)&&!!b};h.log2=function(b){var a,g;a=(65535<b)<<4;b>>>=a;g=(255<b)<<3;b>>>=g;a|=g;g=(15<b)<<2;b>>>=g;a|=g;g=(3<b)<<1;return a|g|b>>>g>>1};h.log10=function(b){return 1E9<=b?9:1E8<=b?8:1E7<=b?7:1E6<=b?6:1E5<=b?5:1E4<=b?4:1E3<=b?3:100<=b?2:10<=b?1:0};h.popCount=function(b){b-=b>>>1&1431655765;b=(b&858993459)+(b>>>2&858993459);return 16843009*(b+(b>>>4)&252645135)>>>24};h.countTrailingZeros=b;h.nextPow2=
function(b){b+=0===b;--b;b|=b>>>1;b|=b>>>2;b|=b>>>4;b|=b>>>8;return(b|b>>>16)+1};h.prevPow2=function(b){b|=b>>>1;b|=b>>>2;b|=b>>>4;b|=b>>>8;b|=b>>>16;return b-(b>>>1)};h.parity=function(b){b^=b>>>16;b^=b>>>8;b=(b^b>>>4)&15;return 27030>>>b&1};var g=Array(256);(function(b){for(var a=0;256>a;++a){for(var g=a,e=a,f=7,g=g>>>1;g;g>>>=1)e<<=1,e|=g&1,--f;b[a]=e<<f&255}})(g);h.reverse=function(b){return g[b&255]<<24|g[b>>>8&255]<<16|g[b>>>16&255]<<8|g[b>>>24&255]};h.interleave2=function(b,a){b&=65535;b=(b|
b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;a&=65535;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;return(b|b<<1)&1431655765|((a|a<<1)&1431655765)<<1};h.deinterleave2=function(b,a){b=b>>>a&1431655765;b=(b|b>>>1)&858993459;b=(b|b>>>2)&252645135;b=(b|b>>>4)&16711935;return((b|b>>>16)&65535)<<16>>16};h.interleave3=function(b,a,g){b&=1023;b=(b|b<<16)&4278190335;b=(b|b<<8)&251719695;b=(b|b<<4)&3272356035;a&=1023;a=(a|a<<16)&4278190335;a=(a|a<<8)&251719695;a=(a|a<<4)&3272356035;
b=(b|b<<2)&1227133513|((a|a<<2)&1227133513)<<1;g&=1023;g=(g|g<<16)&4278190335;g=(g|g<<8)&251719695;g=(g|g<<4)&3272356035;return b|((g|g<<2)&1227133513)<<2};h.deinterleave3=function(b,a){b=b>>>a&1227133513;b=(b|b>>>2)&3272356035;b=(b|b>>>4)&251719695;b=(b|b>>>8)&4278190335;return((b|b>>>16)&1023)<<22>>22};h.nextCombination=function(a){var d=a|a-1;return d+1|(~d&-~d)-1>>>b(a)+1}},{}],39:[function(a,e,h){(function(b){function g(){try{var b=new Uint8Array(1);b.__proto__={__proto__:Uint8Array.prototype,
foo:function(){return 42}};return 42===b.foo()&&"function"===typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(a){return!1}}function c(b,a){if((d.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<a)throw new RangeError("Invalid typed array length");d.TYPED_ARRAY_SUPPORT?(b=new Uint8Array(a),b.__proto__=d.prototype):(null===b&&(b=new d(a)),b.length=a);return b}function d(b,a,c){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(b,a,c);if("number"===typeof b){if("string"===typeof a)throw Error("If encoding is specified then the first argument must be a string");
return f(this,b)}return e(this,b,a,c)}function e(b,a,g,f){if("number"===typeof a)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&a instanceof ArrayBuffer){a.byteLength;if(0>g||a.byteLength<g)throw new RangeError("'offset' is out of bounds");if(a.byteLength<g+(f||0))throw new RangeError("'length' is out of bounds");a=void 0===g&&void 0===f?new Uint8Array(a):void 0===f?new Uint8Array(a,g):new Uint8Array(a,g,f);d.TYPED_ARRAY_SUPPORT?(b=a,b.__proto__=
d.prototype):b=q(b,a);return b}if("string"===typeof a){f=b;b=g;if("string"!==typeof b||""===b)b="utf8";if(!d.isEncoding(b))throw new TypeError('"encoding" must be a valid string encoding');g=k(a,b)|0;f=c(f,g);a=f.write(a,b);a!==g&&(f=f.slice(0,a));return f}return t(b,a)}function l(b){if("number"!==typeof b)throw new TypeError('"size" argument must be a number');if(0>b)throw new RangeError('"size" argument must not be negative');}function f(b,a){l(a);b=c(b,0>a?0:z(a)|0);if(!d.TYPED_ARRAY_SUPPORT)for(var g=
0;g<a;++g)b[g]=0;return b}function q(b,a){var d=0>a.length?0:z(a.length)|0;b=c(b,d);for(var g=0;g<d;g+=1)b[g]=a[g]&255;return b}function t(b,a){if(d.isBuffer(a)){var g=z(a.length)|0;b=c(b,g);if(0===b.length)return b;a.copy(b,0,0,g);return b}if(a){if("undefined"!==typeof ArrayBuffer&&a.buffer instanceof ArrayBuffer||"length"in a)return(g="number"!==typeof a.length)||(g=a.length,g=g!==g),g?c(b,0):q(b,a);if("Buffer"===a.type&&T(a.data))return q(b,a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function z(b){if(b>=(d.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(d.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return b|0}function k(b,a){if(d.isBuffer(b))return b.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(b)||b instanceof ArrayBuffer))return b.byteLength;"string"!==typeof b&&(b=""+b);var c=b.length;if(0===c)return 0;for(var g=!1;;)switch(a){case "ascii":case "latin1":case "binary":return c;
case "utf8":case "utf-8":case void 0:return U(b).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*c;case "hex":return c>>>1;case "base64":return R.toByteArray(O(b)).length;default:if(g)return U(b).length;a=(""+a).toLowerCase();g=!0}}function x(b,a,c){var d=!1;if(void 0===a||0>a)a=0;if(a>this.length)return"";if(void 0===c||c>this.length)c=this.length;if(0>=c)return"";c>>>=0;a>>>=0;if(c<=a)return"";for(b||(b="utf8");;)switch(b){case "hex":b=a;a=c;c=this.length;if(!b||0>b)b=0;
if(!a||0>a||a>c)a=c;d="";for(c=b;c<a;++c)b=d,d=this[c],d=16>d?"0"+d.toString(16):d.toString(16),d=b+d;return d;case "utf8":case "utf-8":return C(this,a,c);case "ascii":b="";for(c=Math.min(this.length,c);a<c;++a)b+=String.fromCharCode(this[a]&127);return b;case "latin1":case "binary":b="";for(c=Math.min(this.length,c);a<c;++a)b+=String.fromCharCode(this[a]);return b;case "base64":return a=0===a&&c===this.length?R.fromByteArray(this):R.fromByteArray(this.slice(a,c)),a;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":a=
this.slice(a,c);c="";for(b=0;b<a.length;b+=2)c+=String.fromCharCode(a[b]+256*a[b+1]);return c;default:if(d)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase();d=!0}}function v(b,a,c){var d=b[a];b[a]=b[c];b[c]=d}function y(b,a,c,g,f){if(0===b.length)return-1;"string"===typeof c?(g=c,c=0):2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648);c=+c;isNaN(c)&&(c=f?0:b.length-1);0>c&&(c=b.length+c);if(c>=b.length){if(f)return-1;c=b.length-1}else if(0>c)if(f)c=0;else return-1;"string"===
typeof a&&(a=d.from(a,g));if(d.isBuffer(a))return 0===a.length?-1:w(b,a,c,g,f);if("number"===typeof a)return a&=255,d.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(b,a,c):Uint8Array.prototype.lastIndexOf.call(b,a,c):w(b,[a],c,g,f);throw new TypeError("val must be string, number or Buffer");}function w(b,a,c,d,g){function f(b,a){return 1===e?b[a]:b.readUInt16BE(a*e)}var e=1,l=b.length,k=a.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===
d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>b.length||2>a.length)return-1;e=2;l/=2;k/=2;c/=2}if(g)for(d=-1;c<l;c++)if(f(b,c)===f(a,-1===d?0:c-d)){if(-1===d&&(d=c),c-d+1===k)return d*e}else-1!==d&&(c-=c-d),d=-1;else for(c+k>l&&(c=l-k);0<=c;c--){l=!0;for(d=0;d<k;d++)if(f(b,c+d)!==f(a,d)){l=!1;break}if(l)return c}return-1}function C(b,a,c){c=Math.min(b.length,c);for(var d=[];a<c;){var g=b[a],f=null,e=239<g?4:223<g?3:191<g?2:1;if(a+e<=c){var l,k,h;switch(e){case 1:128>g&&(f=g);break;case 2:l=
b[a+1];128===(l&192)&&(g=(g&31)<<6|l&63,127<g&&(f=g));break;case 3:l=b[a+1];k=b[a+2];128===(l&192)&&128===(k&192)&&(g=(g&15)<<12|(l&63)<<6|k&63,2047<g&&(55296>g||57343<g)&&(f=g));break;case 4:l=b[a+1],k=b[a+2],h=b[a+3],128===(l&192)&&128===(k&192)&&128===(h&192)&&(g=(g&15)<<18|(l&63)<<12|(k&63)<<6|h&63,65535<g&&1114112>g&&(f=g))}}null===f?(f=65533,e=1):65535<f&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|f&1023);d.push(f);a+=e}b=d.length;if(b<=L)d=String.fromCharCode.apply(String,d);else{c="";for(a=
0;a<b;)c+=String.fromCharCode.apply(String,d.slice(a,a+=L));d=c}return d}function A(b,a,c){if(0!==b%1||0>b)throw new RangeError("offset is not uint");if(b+a>c)throw new RangeError("Trying to access beyond buffer length");}function B(b,a,c,g,f,e){if(!d.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>f||a<e)throw new RangeError('"value" argument is out of bounds');if(c+g>b.length)throw new RangeError("Index out of range");}function F(b,a,c,d){0>a&&(a=65535+a+1);for(var g=
0,f=Math.min(b.length-c,2);g<f;++g)b[c+g]=(a&255<<8*(d?g:1-g))>>>8*(d?g:1-g)}function G(b,a,c,d){0>a&&(a=4294967295+a+1);for(var g=0,f=Math.min(b.length-c,4);g<f;++g)b[c+g]=a>>>8*(d?g:3-g)&255}function D(b,a,c,d,g,f){if(c+d>b.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range");}function u(b,a,c,d,g){g||D(b,a,c,4,3.4028234663852886E38,-3.4028234663852886E38);J.write(b,a,c,d,23,4);return c+4}function E(b,a,c,d,g){g||D(b,a,c,8,1.7976931348623157E308,-1.7976931348623157E308);
J.write(b,a,c,d,52,8);return c+8}function O(b){b=b.trim?b.trim():b.replace(/^\s+|\s+$/g,"");b=b.replace(S,"");if(2>b.length)return"";for(;0!==b.length%4;)b+="=";return b}function U(b,a){a=a||Infinity;for(var c,d=b.length,g=null,f=[],e=0;e<d;++e){c=b.charCodeAt(e);if(55295<c&&57344>c){if(!g){if(56319<c){-1<(a-=3)&&f.push(239,191,189);continue}else if(e+1===d){-1<(a-=3)&&f.push(239,191,189);continue}g=c;continue}if(56320>c){-1<(a-=3)&&f.push(239,191,189);g=c;continue}c=(g-55296<<10|c-56320)+65536}else g&&
-1<(a-=3)&&f.push(239,191,189);g=null;if(128>c){if(0>--a)break;f.push(c)}else if(2048>c){if(0>(a-=2))break;f.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(a-=3))break;f.push(c>>12|224,c>>6&63|128,c&63|128)}else if(1114112>c){if(0>(a-=4))break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return f}function H(b){for(var a=[],c=0;c<b.length;++c)a.push(b.charCodeAt(c)&255);return a}function I(b,a,c,d){for(var g=0;g<d&&!(g+c>=a.length||g>=b.length);++g)a[g+
c]=b[g];return g}var R=a("base64-js"),J=a("ieee754"),T=a("isarray");h.Buffer=d;h.SlowBuffer=function(b){+b!=b&&(b=0);return d.alloc(+b)};h.INSPECT_MAX_BYTES=50;d.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:g();h.kMaxLength=d.TYPED_ARRAY_SUPPORT?2147483647:1073741823;d.poolSize=8192;d._augment=function(b){b.__proto__=d.prototype;return b};d.from=function(b,a,c){return e(null,b,a,c)};d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,
$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&($jscomp.initSymbol(),Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})));d.alloc=function(b,a,d){l(b);b=0>=b?c(null,b):void 0!==a?"string"===typeof d?c(null,b).fill(a,d):c(null,b).fill(a):c(null,b);return b};d.allocUnsafe=function(b){return f(null,b)};d.allocUnsafeSlow=function(b){return f(null,b)};d.isBuffer=function(b){return!(null==b||!b._isBuffer)};
d.compare=function(b,a){if(!d.isBuffer(b)||!d.isBuffer(a))throw new TypeError("Arguments must be Buffers");if(b===a)return 0;for(var c=b.length,g=a.length,f=0,e=Math.min(c,g);f<e;++f)if(b[f]!==a[f]){c=b[f];g=a[f];break}return c<g?-1:g<c?1:0};d.isEncoding=function(b){switch(String(b).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};d.concat=function(b,a){if(!T(b))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===b.length)return d.alloc(0);var c;if(void 0===a)for(c=a=0;c<b.length;++c)a+=b[c].length;var g=d.allocUnsafe(a),f=0;for(c=0;c<b.length;++c){var e=b[c];if(!d.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(g,f);f+=e.length}return g};d.byteLength=k;d.prototype._isBuffer=!0;d.prototype.swap16=function(){var b=this.length;if(0!==b%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<b;a+=2)v(this,a,a+1);return this};d.prototype.swap32=
function(){var b=this.length;if(0!==b%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<b;a+=4)v(this,a,a+3),v(this,a+1,a+2);return this};d.prototype.swap64=function(){var b=this.length;if(0!==b%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<b;a+=8)v(this,a,a+7),v(this,a+1,a+6),v(this,a+2,a+5),v(this,a+3,a+4);return this};d.prototype.toString=function(){var b=this.length|0;return 0===b?"":0===arguments.length?C(this,0,b):x.apply(this,
arguments)};d.prototype.equals=function(b){if(!d.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===d.compare(this,b)};d.prototype.inspect=function(){var b="",a=h.INSPECT_MAX_BYTES;0<this.length&&(b=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(b+=" ... "));return"<Buffer "+b+">"};d.prototype.compare=function(b,a,c,g,f){if(!d.isBuffer(b))throw new TypeError("Argument must be a Buffer");void 0===a&&(a=0);void 0===c&&(c=b?b.length:0);void 0===g&&
(g=0);void 0===f&&(f=this.length);if(0>a||c>b.length||0>g||f>this.length)throw new RangeError("out of range index");if(g>=f&&a>=c)return 0;if(g>=f)return-1;if(a>=c)return 1;a>>>=0;c>>>=0;g>>>=0;f>>>=0;if(this===b)return 0;var e=f-g,l=c-a,k=Math.min(e,l);g=this.slice(g,f);b=b.slice(a,c);for(a=0;a<k;++a)if(g[a]!==b[a]){e=g[a];l=b[a];break}return e<l?-1:l<e?1:0};d.prototype.includes=function(b,a,c){return-1!==this.indexOf(b,a,c)};d.prototype.indexOf=function(b,a,c){return y(this,b,a,c,!0)};d.prototype.lastIndexOf=
function(b,a,c){return y(this,b,a,c,!1)};d.prototype.write=function(b,a,c,d){if(void 0===a)d="utf8",c=this.length,a=0;else if(void 0===c&&"string"===typeof a)d=a,c=this.length,a=0;else if(isFinite(a))a|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var g=this.length-a;if(void 0===c||c>g)c=g;if(0<b.length&&(0>c||0>a)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");
d||(d="utf8");for(g=!1;;)switch(d){case "hex":a:{a=Number(a)||0;d=this.length-a;c?(c=Number(c),c>d&&(c=d)):c=d;d=b.length;if(0!==d%2)throw new TypeError("Invalid hex string");c>d/2&&(c=d/2);for(d=0;d<c;++d){g=parseInt(b.substr(2*d,2),16);if(isNaN(g)){b=d;break a}this[a+d]=g}b=d}return b;case "utf8":case "utf-8":return I(U(b,this.length-a),this,a,c);case "ascii":return I(H(b),this,a,c);case "latin1":case "binary":return I(H(b),this,a,c);case "base64":return I(R.toByteArray(O(b)),this,a,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=
this.length-a;for(var f=void 0,f=g=void 0,e=[],l=0;l<b.length&&!(0>(d-=2));++l)f=b.charCodeAt(l),g=f>>8,f%=256,e.push(f),e.push(g);return I(e,this,a,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();g=!0}};d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var L=4096;d.prototype.slice=function(b,a){var c=this.length;b=~~b;a=void 0===a?c:~~a;0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c);0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c);a<b&&(a=
b);if(d.TYPED_ARRAY_SUPPORT)c=this.subarray(b,a),c.__proto__=d.prototype;else for(var g=a-b,c=new d(g,void 0),f=0;f<g;++f)c[f]=this[f+b];return c};d.prototype.readUIntLE=function(b,a,c){b|=0;a|=0;c||A(b,a,this.length);c=this[b];for(var d=1,g=0;++g<a&&(d*=256);)c+=this[b+g]*d;return c};d.prototype.readUIntBE=function(b,a,c){b|=0;a|=0;c||A(b,a,this.length);c=this[b+--a];for(var d=1;0<a&&(d*=256);)c+=this[b+--a]*d;return c};d.prototype.readUInt8=function(b,a){a||A(b,1,this.length);return this[b]};d.prototype.readUInt16LE=
function(b,a){a||A(b,2,this.length);return this[b]|this[b+1]<<8};d.prototype.readUInt16BE=function(b,a){a||A(b,2,this.length);return this[b]<<8|this[b+1]};d.prototype.readUInt32LE=function(b,a){a||A(b,4,this.length);return(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]};d.prototype.readUInt32BE=function(b,a){a||A(b,4,this.length);return 16777216*this[b]+(this[b+1]<<16|this[b+2]<<8|this[b+3])};d.prototype.readIntLE=function(b,a,c){b|=0;a|=0;c||A(b,a,this.length);c=this[b];for(var d=1,g=0;++g<
a&&(d*=256);)c+=this[b+g]*d;c>=128*d&&(c-=Math.pow(2,8*a));return c};d.prototype.readIntBE=function(b,a,c){b|=0;a|=0;c||A(b,a,this.length);c=a;for(var d=1,g=this[b+--c];0<c&&(d*=256);)g+=this[b+--c]*d;g>=128*d&&(g-=Math.pow(2,8*a));return g};d.prototype.readInt8=function(b,a){a||A(b,1,this.length);return this[b]&128?-1*(255-this[b]+1):this[b]};d.prototype.readInt16LE=function(b,a){a||A(b,2,this.length);var c=this[b]|this[b+1]<<8;return c&32768?c|4294901760:c};d.prototype.readInt16BE=function(b,a){a||
A(b,2,this.length);var c=this[b+1]|this[b]<<8;return c&32768?c|4294901760:c};d.prototype.readInt32LE=function(b,a){a||A(b,4,this.length);return this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24};d.prototype.readInt32BE=function(b,a){a||A(b,4,this.length);return this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]};d.prototype.readFloatLE=function(b,a){a||A(b,4,this.length);return J.read(this,b,!0,23,4)};d.prototype.readFloatBE=function(b,a){a||A(b,4,this.length);return J.read(this,b,!1,23,4)};d.prototype.readDoubleLE=
function(b,a){a||A(b,8,this.length);return J.read(this,b,!0,52,8)};d.prototype.readDoubleBE=function(b,a){a||A(b,8,this.length);return J.read(this,b,!1,52,8)};d.prototype.writeUIntLE=function(b,a,c,d){b=+b;a|=0;c|=0;d||B(this,b,a,c,Math.pow(2,8*c)-1,0);d=1;var g=0;for(this[a]=b&255;++g<c&&(d*=256);)this[a+g]=b/d&255;return a+c};d.prototype.writeUIntBE=function(b,a,c,d){b=+b;a|=0;c|=0;d||B(this,b,a,c,Math.pow(2,8*c)-1,0);d=c-1;var g=1;for(this[a+d]=b&255;0<=--d&&(g*=256);)this[a+d]=b/g&255;return a+
c};d.prototype.writeUInt8=function(b,a,c){b=+b;a|=0;c||B(this,b,a,1,255,0);d.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));this[a]=b&255;return a+1};d.prototype.writeUInt16LE=function(b,a,c){b=+b;a|=0;c||B(this,b,a,2,65535,0);d.TYPED_ARRAY_SUPPORT?(this[a]=b&255,this[a+1]=b>>>8):F(this,b,a,!0);return a+2};d.prototype.writeUInt16BE=function(b,a,c){b=+b;a|=0;c||B(this,b,a,2,65535,0);d.TYPED_ARRAY_SUPPORT?(this[a]=b>>>8,this[a+1]=b&255):F(this,b,a,!1);return a+2};d.prototype.writeUInt32LE=function(b,a,c){b=
+b;a|=0;c||B(this,b,a,4,4294967295,0);d.TYPED_ARRAY_SUPPORT?(this[a+3]=b>>>24,this[a+2]=b>>>16,this[a+1]=b>>>8,this[a]=b&255):G(this,b,a,!0);return a+4};d.prototype.writeUInt32BE=function(b,a,c){b=+b;a|=0;c||B(this,b,a,4,4294967295,0);d.TYPED_ARRAY_SUPPORT?(this[a]=b>>>24,this[a+1]=b>>>16,this[a+2]=b>>>8,this[a+3]=b&255):G(this,b,a,!1);return a+4};d.prototype.writeIntLE=function(b,a,c,d){b=+b;a|=0;d||(d=Math.pow(2,8*c-1),B(this,b,a,c,d-1,-d));d=0;var g=1,f=0;for(this[a]=b&255;++d<c&&(g*=256);)0>b&&
0===f&&0!==this[a+d-1]&&(f=1),this[a+d]=(b/g>>0)-f&255;return a+c};d.prototype.writeIntBE=function(b,a,c,d){b=+b;a|=0;d||(d=Math.pow(2,8*c-1),B(this,b,a,c,d-1,-d));d=c-1;var g=1,f=0;for(this[a+d]=b&255;0<=--d&&(g*=256);)0>b&&0===f&&0!==this[a+d+1]&&(f=1),this[a+d]=(b/g>>0)-f&255;return a+c};d.prototype.writeInt8=function(b,a,c){b=+b;a|=0;c||B(this,b,a,1,127,-128);d.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));0>b&&(b=255+b+1);this[a]=b&255;return a+1};d.prototype.writeInt16LE=function(b,a,c){b=+b;a|=0;
c||B(this,b,a,2,32767,-32768);d.TYPED_ARRAY_SUPPORT?(this[a]=b&255,this[a+1]=b>>>8):F(this,b,a,!0);return a+2};d.prototype.writeInt16BE=function(b,a,c){b=+b;a|=0;c||B(this,b,a,2,32767,-32768);d.TYPED_ARRAY_SUPPORT?(this[a]=b>>>8,this[a+1]=b&255):F(this,b,a,!1);return a+2};d.prototype.writeInt32LE=function(b,a,c){b=+b;a|=0;c||B(this,b,a,4,2147483647,-2147483648);d.TYPED_ARRAY_SUPPORT?(this[a]=b&255,this[a+1]=b>>>8,this[a+2]=b>>>16,this[a+3]=b>>>24):G(this,b,a,!0);return a+4};d.prototype.writeInt32BE=
function(b,a,c){b=+b;a|=0;c||B(this,b,a,4,2147483647,-2147483648);0>b&&(b=4294967295+b+1);d.TYPED_ARRAY_SUPPORT?(this[a]=b>>>24,this[a+1]=b>>>16,this[a+2]=b>>>8,this[a+3]=b&255):G(this,b,a,!1);return a+4};d.prototype.writeFloatLE=function(b,a,c){return u(this,b,a,!0,c)};d.prototype.writeFloatBE=function(b,a,c){return u(this,b,a,!1,c)};d.prototype.writeDoubleLE=function(b,a,c){return E(this,b,a,!0,c)};d.prototype.writeDoubleBE=function(b,a,c){return E(this,b,a,!1,c)};d.prototype.copy=function(b,a,
c,g){c||(c=0);g||0===g||(g=this.length);a>=b.length&&(a=b.length);a||(a=0);0<g&&g<c&&(g=c);if(g===c||0===b.length||0===this.length)return 0;if(0>a)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>g)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length);b.length-a<g-c&&(g=b.length-a+c);var f=g-c;if(this===b&&c<a&&a<g)for(g=f-1;0<=g;--g)b[g+a]=this[g+c];else if(1E3>f||!d.TYPED_ARRAY_SUPPORT)for(g=
0;g<f;++g)b[g+a]=this[g+c];else Uint8Array.prototype.set.call(b,this.subarray(c,c+f),a);return f};d.prototype.fill=function(b,a,c,g){if("string"===typeof b){"string"===typeof a?(g=a,a=0,c=this.length):"string"===typeof c&&(g=c,c=this.length);if(1===b.length){var f=b.charCodeAt(0);256>f&&(b=f)}if(void 0!==g&&"string"!==typeof g)throw new TypeError("encoding must be a string");if("string"===typeof g&&!d.isEncoding(g))throw new TypeError("Unknown encoding: "+g);}else"number"===typeof b&&(b&=255);if(0>
a||this.length<a||this.length<c)throw new RangeError("Out of range index");if(c<=a)return this;a>>>=0;c=void 0===c?this.length:c>>>0;b||(b=0);if("number"===typeof b)for(g=a;g<c;++g)this[g]=b;else for(b=d.isBuffer(b)?b:U((new d(b,g)).toString()),f=b.length,g=0;g<c-a;++g)this[g+a]=b[g%f];return this};var S=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"base64-js":37,ieee754:67,isarray:71}],40:[function(a,e,
h){function b(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.post=this.body=this.pre=null;this.debug=!1}var g=a("./lib/thunk.js");e.exports=function(a){var d=new b;d.pre=a.pre;d.body=a.body;d.post=a.post;var e=a.args.slice(0);d.argTypes=e;for(var l=0;l<e.length;++l){var f=e[l];if("array"===f||"object"===typeof f&&f.blockIndices){d.argTypes[l]="array";
d.arrayArgs.push(l);d.arrayBlockIndices.push(f.blockIndices?f.blockIndices:0);d.shimArgs.push("array"+l);if(l<d.pre.args.length&&0<d.pre.args[l].count)throw Error("cwise: pre() block may not reference array args");if(l<d.post.args.length&&0<d.post.args[l].count)throw Error("cwise: post() block may not reference array args");}else if("scalar"===f)d.scalarArgs.push(l),d.shimArgs.push("scalar"+l);else if("index"===f){d.indexArgs.push(l);if(l<d.pre.args.length&&0<d.pre.args[l].count)throw Error("cwise: pre() block may not reference array index");
if(l<d.body.args.length&&d.body.args[l].lvalue)throw Error("cwise: body() block may not write to array index");if(l<d.post.args.length&&0<d.post.args[l].count)throw Error("cwise: post() block may not reference array index");}else if("shape"===f){d.shapeArgs.push(l);if(l<d.pre.args.length&&d.pre.args[l].lvalue)throw Error("cwise: pre() block may not write to array shape");if(l<d.body.args.length&&d.body.args[l].lvalue)throw Error("cwise: body() block may not write to array shape");if(l<d.post.args.length&&
d.post.args[l].lvalue)throw Error("cwise: post() block may not write to array shape");}else if("object"===typeof f&&f.offset)d.argTypes[l]="offset",d.offsetArgs.push({array:f.array,offset:f.offset}),d.offsetArgIndex.push(l);else throw Error("cwise: Unknown argument type "+e[l]);}if(0>=d.arrayArgs.length)throw Error("cwise: No array arguments specified");if(d.pre.args.length>e.length)throw Error("cwise: Too many arguments in pre() block");if(d.body.args.length>e.length)throw Error("cwise: Too many arguments in body() block");
if(d.post.args.length>e.length)throw Error("cwise: Too many arguments in post() block");d.debug=!!a.printCode||!!a.debug;d.funcName=a.funcName||"cwise";d.blockSize=a.blockSize||64;return g(d)}},{"./lib/thunk.js":42}],41:[function(a,e,h){function b(b,a,c){var d=b.length,g=a.arrayArgs.length;a=0<a.indexArgs.length;var e=[],h=[],p=0,y=0,w,C;for(w=0;w<d;++w)h.push(["i",w,"=0"].join(""));for(C=0;C<g;++C)for(w=0;w<d;++w)y=p,p=b[w],0===w?h.push(["d",C,"s",w,"=t",C,"p",p].join("")):h.push(["d",C,"s",w,"=(t",
C,"p",p,"-s",y,"*t",C,"p",y,")"].join(""));e.push("var "+h.join(","));for(w=d-1;0<=w;--w)p=b[w],e.push(["for(i",w,"=0;i",w,"<s",p,";++i",w,"){"].join(""));e.push(c);for(w=0;w<d;++w){y=p;p=b[w];for(C=0;C<g;++C)e.push(["p",C,"+=d",C,"s",w].join(""));a&&(0<w&&e.push(["index[",y,"]-=s",y].join("")),e.push(["++index[",p,"]"].join("")));e.push("}")}return e.join("\n")}function g(a,c,d,g){for(var e=c.length,k=d.arrayArgs.length,h=d.blockSize,p=0<d.indexArgs.length,y=[],w=0;w<k;++w)y.push(["var offset",w,
"=p",w].join(""));for(w=a;w<e;++w)y.push(["for(var j"+w+"=SS[",c[w],"]|0;j",w,">0;){"].join("")),y.push(["if(j",w,"<",h,"){"].join("")),y.push(["s",c[w],"=j",w].join("")),y.push(["j",w,"=0"].join("")),y.push(["}else{s",c[w],"=",h].join("")),y.push(["j",w,"-=",h,"}"].join("")),p&&y.push(["index[",c[w],"]=j",w].join(""));for(w=0;w<k;++w){h=["offset"+w];for(p=a;p<e;++p)h.push(["j",p,"*t",w,"p",c[p]].join(""));y.push(["p",w,"=(",h.join("+"),")"].join(""))}y.push(b(c,d,g));for(w=a;w<e;++w)y.push("}");
return y.join("\n")}function c(b,a,c){for(var d=b.body,g=[],e=[],h=0;h<b.args.length;++h){var p=b.args[h];if(!(0>=p.count)){var y=new RegExp(p.name,"g"),w="",C=a.arrayArgs.indexOf(h);switch(a.argTypes[h]){case "offset":var A=a.offsetArgIndex.indexOf(h),C=a.offsetArgs[A].array,w="+q"+A;case "array":var w="p"+C+w,B="l"+h,A="a"+C;if(0===a.arrayBlockIndices[C])1===p.count?"generic"===c[C]?p.lvalue?(g.push(["var ",B,"=",A,".get(",w,")"].join("")),d=d.replace(y,B),e.push([A,".set(",w,",",B,")"].join(""))):
d=d.replace(y,[A,".get(",w,")"].join("")):d=d.replace(y,[A,"[",w,"]"].join("")):"generic"===c[C]?(g.push(["var ",B,"=",A,".get(",w,")"].join("")),d=d.replace(y,B),p.lvalue&&e.push([A,".set(",w,",",B,")"].join(""))):(g.push(["var ",B,"=",A,"[",w,"]"].join("")),d=d.replace(y,B),p.lvalue&&e.push([A,"[",w,"]=",B].join("")));else{y=[p.name];p=[w];for(w=0;w<Math.abs(a.arrayBlockIndices[C]);w++)y.push("\\s*\\[([^\\]]+)\\]"),p.push("$"+(w+1)+"*t"+C+"b"+w);y=new RegExp(y.join(""),"g");w=p.join("+");if("generic"===
c[C])throw Error("cwise: Generic arrays not supported in combination with blocks!");d=d.replace(y,[A,"[",w,"]"].join(""))}break;case "scalar":d=d.replace(y,"Y"+a.scalarArgs.indexOf(h));break;case "index":d=d.replace(y,"index");break;case "shape":d=d.replace(y,"shape")}}}return[g.join("\n"),d,e.join("\n")].join("\n").trim()}function d(b){for(var a=Array(b.length),c=!0,d=0;d<b.length;++d){var g=b[d],e=g.match(/\d+/),e=e?e[0]:"";0===g.charAt(0)?a[d]="u"+g.charAt(1)+e:a[d]=g.charAt(0)+e;0<d&&(c=c&&a[d]===
a[d-1])}return c?a[0]:a.join("")}var p=a("uniq");e.exports=function(a,f){for(var e=f[1].length-Math.abs(a.arrayBlockIndices[0])|0,h=Array(a.arrayArgs.length),z=Array(a.arrayArgs.length),k=0;k<a.arrayArgs.length;++k)z[k]=f[2*k],h[k]=f[2*k+1];for(var x=[],v=[],y=[],w=[],C=[],k=0;k<a.arrayArgs.length;++k){0>a.arrayBlockIndices[k]?(y.push(0),w.push(e),x.push(e),v.push(e+a.arrayBlockIndices[k])):(y.push(a.arrayBlockIndices[k]),w.push(a.arrayBlockIndices[k]+e),x.push(0),v.push(a.arrayBlockIndices[k]));
for(var A=[],B=0;B<h[k].length;B++)y[k]<=h[k][B]&&h[k][B]<w[k]&&A.push(h[k][B]-y[k]);C.push(A)}v=["SS"];w=["'use strict'"];A=[];for(B=0;B<e;++B)A.push(["s",B,"=SS[",B,"]"].join(""));for(k=0;k<a.arrayArgs.length;++k){v.push("a"+k);v.push("t"+k);v.push("p"+k);for(B=0;B<e;++B)A.push(["t",k,"p",B,"=t",k,"[",y[k]+B,"]"].join(""));for(B=0;B<Math.abs(a.arrayBlockIndices[k]);++B)A.push(["t",k,"b",B,"=t",k,"[",x[k]+B,"]"].join(""))}for(k=0;k<a.scalarArgs.length;++k)v.push("Y"+k);0<a.shapeArgs.length&&A.push("shape=SS.slice(0)");
if(0<a.indexArgs.length){B=Array(e);for(k=0;k<e;++k)B[k]="0";A.push(["index=[",B.join(","),"]"].join(""))}for(k=0;k<a.offsetArgs.length;++k){x=a.offsetArgs[k];y=[];for(B=0;B<x.offset.length;++B)0!==x.offset[B]&&(1===x.offset[B]?y.push(["t",x.array,"p",B].join("")):y.push([x.offset[B],"*t",x.array,"p",B].join("")));0===y.length?A.push("q"+k+"=0"):A.push(["q",k,"=",y.join("+")].join(""))}k=p([].concat(a.pre.thisVars).concat(a.body.thisVars).concat(a.post.thisVars));A=A.concat(k);w.push("var "+A.join(","));
for(k=0;k<a.arrayArgs.length;++k)w.push("p"+k+"|=0");3<a.pre.body.length&&w.push(c(a.pre,a,z));k=c(a.body,a,z);a:for(B=0,A=C[0].length;B<A;){for(x=1;x<C.length;++x)if(C[x][B]!==C[0][B])break a;++B}B<e?w.push(g(B,C[0],a,k)):w.push(b(C[0],a,k));3<a.post.body.length&&w.push(c(a.post,a,z));a.debug&&console.log("-----Generated cwise routine for ",f,":\n"+w.join("\n")+"\n----------");e=[a.funcName||"unnamed","_cwise_loop_",h[0].join("s"),"m",B,d(z)].join("");return(new Function(["function ",e,"(",v.join(","),
"){",w.join("\n"),"} return ",e].join("")))()}},{uniq:85}],42:[function(a,e,h){var b=a("./compile.js");e.exports=function(a){var c=["'use strict'","var CACHED={}"],d=[];c.push(["return function ",a.funcName+"_cwise_thunk","(",a.shimArgs.join(","),"){"].join(""));for(var e=[],l=[],f=[["array",a.arrayArgs[0],".shape.slice(",Math.max(0,a.arrayBlockIndices[0]),0>a.arrayBlockIndices[0]?","+a.arrayBlockIndices[0]+")":")"].join("")],h=[],t=[],z=0;z<a.arrayArgs.length;++z){var k=a.arrayArgs[z];d.push(["t",
k,"=array",k,".dtype,r",k,"=array",k,".order"].join(""));e.push("t"+k);e.push("r"+k);l.push("t"+k);l.push("r"+k+".join()");f.push("array"+k+".data");f.push("array"+k+".stride");f.push("array"+k+".offset|0");0<z&&(h.push("array"+a.arrayArgs[0]+".shape.length===array"+k+".shape.length+"+(Math.abs(a.arrayBlockIndices[0])-Math.abs(a.arrayBlockIndices[z]))),t.push("array"+a.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[0])+"]===array"+k+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[z])+
"]"))}1<a.arrayArgs.length&&(c.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),c.push("for(var shapeIndex=array"+a.arrayArgs[0]+".shape.length-"+Math.abs(a.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),c.push("if (!("+t.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),c.push("}"));for(z=0;z<a.scalarArgs.length;++z)f.push("scalar"+a.scalarArgs[z]);d.push(["type=[",l.join(","),"].join()"].join(""));d.push("proc=CACHED[type]");
c.push("var "+d.join(","));c.push(["if(!proc){CACHED[type]=proc=compile([",e.join(","),"])}return proc(",f.join(","),")}"].join(""));a.debug&&console.log("-----Generated thunk:\n"+c.join("\n")+"\n----------");return(new Function("compile",c.join("\n")))(b.bind(void 0,a))}},{"./compile.js":41}],43:[function(a,e,h){function b(a,c,d){var e=a[d]|0;if(0>=e)return[];var l=Array(e),f;if(d===a.length-1)for(f=0;f<e;++f)l[f]=c;else for(f=0;f<e;++f)l[f]=b(a,c,d+1);return l}e.exports=function(a,c){"undefined"===
typeof c&&(c=0);switch(typeof a){case "number":if(0<a){var d=a|0,e=c,l,f;l=Array(d);for(f=0;f<d;++f)l[f]=e;return l}break;case "object":if("number"===typeof a.length)return b(a,c,0)}return[]}},{}],44:[function(a,e,h){function b(b){if(0>b)return Number("0/0");for(var a=c[0],g=c.length-1;0<g;--g)a+=c[g]/(b+g);g=b+4.7421875+.5;return.5*Math.log(2*Math.PI)+(b+.5)*Math.log(g)-g+Math.log(a)-Math.log(b)}var g=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,
-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7],c=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3.399464998481189E-5,4.652362892704858E-5,-9.837447530487956E-5,1.580887032249125E-4,-2.1026444172410488E-4,2.1743961811521265E-4,-1.643181065367639E-4,8.441822398385275E-5,-2.6190838401581408E-5,3.6899182659531625E-6];e.exports=function p(a){if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*p(1-a));if(100<a)return Math.exp(b(a));--a;for(var c=g[0],
e=1;9>e;e++)c+=g[e]/(a+e);e=a+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(e,a+.5)*Math.exp(-e)*c};e.exports.log=b},{}],45:[function(a,e,h){e.exports=function(b,a){var c=a[0],d=a[1],e=a[2],l=a[3],f=a[4],h=a[5],t=a[6],z=a[7],k=a[8];b[0]=f*k-h*z;b[1]=e*z-d*k;b[2]=d*h-e*f;b[3]=h*t-l*k;b[4]=c*k-e*t;b[5]=e*l-c*h;b[6]=l*z-f*t;b[7]=d*t-c*z;b[8]=c*f-d*l;return b}},{}],46:[function(a,e,h){e.exports=function(b){var a=new Float32Array(9);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=
b[7];a[8]=b[8];return a}},{}],47:[function(a,e,h){e.exports=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b}},{}],48:[function(a,e,h){e.exports=function(){var b=new Float32Array(9);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b}},{}],49:[function(a,e,h){e.exports=function(b){var a=b[3],c=b[4],d=b[5],e=b[6],l=b[7],f=b[8];return b[0]*(f*c-d*l)+b[1]*(d*e-f*a)+b[2]*(l*a-c*e)}},{}],50:[function(a,e,h){e.exports=function(b){return Math.sqrt(b[0]*
b[0]+b[1]*b[1]+b[2]*b[2]+b[3]*b[3]+b[4]*b[4]+b[5]*b[5]+b[6]*b[6]+b[7]*b[7]+b[8]*b[8])}},{}],51:[function(a,e,h){e.exports=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=0;b[3]=a[2];b[4]=a[3];b[5]=0;b[6]=a[4];b[7]=a[5];b[8]=1;return b}},{}],52:[function(a,e,h){e.exports=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b}},{}],53:[function(a,e,h){e.exports=function(b,a){var c=a[0],d=a[1],e=a[2],l=a[3],f=c+c,h=d+d,t=e+e,c=c*f,z=d*f,d=d*h,k=e*f,x=
e*h,e=e*t,f=l*f,h=l*h,l=l*t;b[0]=1-d-e;b[3]=z-l;b[6]=k+h;b[1]=z+l;b[4]=1-c-e;b[7]=x-f;b[2]=k-h;b[5]=x+f;b[8]=1-c-d;return b}},{}],54:[function(a,e,h){e.exports=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b}},{}],55:[function(a,e,h){e.exports={adjoint:a("./adjoint"),clone:a("./clone"),copy:a("./copy"),create:a("./create"),determinant:a("./determinant"),frob:a("./frob"),fromMat2:a("./from-mat2"),fromMat4:a("./from-mat4"),fromQuat:a("./from-quat"),identity:a("./identity"),
invert:a("./invert"),multiply:a("./multiply"),normalFromMat4:a("./normal-from-mat4"),rotate:a("./rotate"),scale:a("./scale"),str:a("./str"),translate:a("./translate"),transpose:a("./transpose")}},{"./adjoint":45,"./clone":46,"./copy":47,"./create":48,"./determinant":49,"./frob":50,"./from-mat2":51,"./from-mat4":52,"./from-quat":53,"./identity":54,"./invert":56,"./multiply":57,"./normal-from-mat4":58,"./rotate":59,"./scale":60,"./str":61,"./translate":62,"./transpose":63}],56:[function(a,e,h){e.exports=
function(b,a){var c=a[0],d=a[1],e=a[2],l=a[3],f=a[4],h=a[5],t=a[6],z=a[7],k=a[8],x=k*f-h*z,v=-k*l+h*t,y=z*l-f*t,w=c*x+d*v+e*y;if(!w)return null;w=1/w;b[0]=x*w;b[1]=(-k*d+e*z)*w;b[2]=(h*d-e*f)*w;b[3]=v*w;b[4]=(k*c-e*t)*w;b[5]=(-h*c+e*l)*w;b[6]=y*w;b[7]=(-z*c+d*t)*w;b[8]=(f*c-d*l)*w;return b}},{}],57:[function(a,e,h){e.exports=function(b,a,c){var d=a[0],e=a[1],h=a[2],f=a[3],q=a[4],t=a[5],z=a[6],k=a[7];a=a[8];var x=c[0],v=c[1],y=c[2],w=c[3],C=c[4],A=c[5],B=c[6],F=c[7];c=c[8];b[0]=x*d+v*f+y*z;b[1]=x*
e+v*q+y*k;b[2]=x*h+v*t+y*a;b[3]=w*d+C*f+A*z;b[4]=w*e+C*q+A*k;b[5]=w*h+C*t+A*a;b[6]=B*d+F*f+c*z;b[7]=B*e+F*q+c*k;b[8]=B*h+F*t+c*a;return b}},{}],58:[function(a,e,h){e.exports=function(b,a){var c=a[0],d=a[1],e=a[2],h=a[3],f=a[4],q=a[5],t=a[6],z=a[7],k=a[8],x=a[9],v=a[10],y=a[11],w=a[12],C=a[13],A=a[14],B=a[15],F=c*q-d*f,G=c*t-e*f,D=c*z-h*f,u=d*t-e*q,E=d*z-h*q,O=e*z-h*t,U=k*C-x*w,H=k*A-v*w,k=k*B-y*w,I=x*A-v*C,x=x*B-y*C,v=v*B-y*A,y=F*v-G*x+D*I+u*k-E*H+O*U;if(!y)return null;y=1/y;b[0]=(q*v-t*x+z*I)*y;
b[1]=(t*k-f*v-z*H)*y;b[2]=(f*x-q*k+z*U)*y;b[3]=(e*x-d*v-h*I)*y;b[4]=(c*v-e*k+h*H)*y;b[5]=(d*k-c*x-h*U)*y;b[6]=(C*O-A*E+B*u)*y;b[7]=(A*D-w*O-B*G)*y;b[8]=(w*E-C*D+B*F)*y;return b}},{}],59:[function(a,e,h){e.exports=function(b,a,c){var d=a[0],e=a[1],h=a[2],f=a[3],q=a[4],t=a[5],z=a[6],k=a[7];a=a[8];var x=Math.sin(c);c=Math.cos(c);b[0]=c*d+x*f;b[1]=c*e+x*q;b[2]=c*h+x*t;b[3]=c*f-x*d;b[4]=c*q-x*e;b[5]=c*t-x*h;b[6]=z;b[7]=k;b[8]=a;return b}},{}],60:[function(a,e,h){e.exports=function(b,a,c){var d=c[0];c=
c[1];b[0]=d*a[0];b[1]=d*a[1];b[2]=d*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b}},{}],61:[function(a,e,h){e.exports=function(b){return"mat3("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+")"}},{}],62:[function(a,e,h){e.exports=function(b,a,c){var d=a[0],e=a[1],h=a[2],f=a[3],q=a[4],t=a[5],z=a[6],k=a[7];a=a[8];var x=c[0];c=c[1];b[0]=d;b[1]=e;b[2]=h;b[3]=f;b[4]=q;b[5]=t;b[6]=x*d+c*f+z;b[7]=x*e+c*q+k;b[8]=x*h+c*t+a;return b}},
{}],63:[function(a,e,h){e.exports=function(b,a){if(b===a){var c=a[1],d=a[2],e=a[5];b[1]=a[3];b[2]=a[6];b[3]=c;b[5]=a[7];b[6]=d;b[7]=e}else b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8];return b}},{}],64:[function(a,e,h){e.exports=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}},{}],65:[function(a,e,h){var b=a("./identity");e.exports=function(a,c,d,e){var h,f,q,t,
z,k,x,v,y=c[0],w=c[1];c=c[2];q=e[0];t=e[1];f=e[2];x=d[0];e=d[1];h=d[2];if(1E-6>Math.abs(y-x)&&1E-6>Math.abs(w-e)&&1E-6>Math.abs(c-h))return b(a);d=y-x;e=w-e;x=c-h;v=1/Math.sqrt(d*d+e*e+x*x);d*=v;e*=v;x*=v;h=t*x-f*e;f=f*d-q*x;q=q*e-t*d;(v=Math.sqrt(h*h+f*f+q*q))?(v=1/v,h*=v,f*=v,q*=v):q=f=h=0;t=e*q-x*f;z=x*h-d*q;k=d*f-e*h;(v=Math.sqrt(t*t+z*z+k*k))?(v=1/v,t*=v,z*=v,k*=v):k=z=t=0;a[0]=h;a[1]=t;a[2]=d;a[3]=0;a[4]=f;a[5]=z;a[6]=e;a[7]=0;a[8]=q;a[9]=k;a[10]=x;a[11]=0;a[12]=-(h*y+f*w+q*c);a[13]=-(t*y+z*
w+k*c);a[14]=-(d*y+e*w+x*c);a[15]=1;return a}},{"./identity":64}],66:[function(a,e,h){e.exports=function(b,a,c,d,e){a=1/Math.tan(a/2);var h=1/(d-e);b[0]=a/c;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=(e+d)*h;b[11]=-1;b[12]=0;b[13]=0;b[14]=2*e*d*h;b[15]=0;return b}},{}],67:[function(a,e,h){h.read=function(b,a,c,d,e){var h;h=8*e-d-1;var f=(1<<h)-1,q=f>>1,t=-7;e=c?e-1:0;var z=c?-1:1,k=b[a+e];e+=z;c=k&(1<<-t)-1;k>>=-t;for(t+=h;0<t;c=256*c+b[a+e],e+=z,t-=8);h=c&(1<<-t)-1;c>>=
-t;for(t+=d;0<t;h=256*h+b[a+e],e+=z,t-=8);if(0===c)c=1-q;else{if(c===f)return h?NaN:Infinity*(k?-1:1);h+=Math.pow(2,d);c-=q}return(k?-1:1)*h*Math.pow(2,c-d)};h.write=function(b,a,c,d,e,h){var f,q=8*h-e-1,t=(1<<q)-1,z=t>>1,k=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;h=d?0:h-1;var x=d?1:-1,v=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,d=t):(d=Math.floor(Math.log(a)/Math.LN2),1>a*(f=Math.pow(2,-d))&&(d--,f*=2),a=1<=d+z?a+k/f:a+k*Math.pow(2,1-z),2<=a*f&&(d++,f/=2),d+z>=t?
(a=0,d=t):1<=d+z?(a=(a*f-1)*Math.pow(2,e),d+=z):(a=a*Math.pow(2,z-1)*Math.pow(2,e),d=0));for(;8<=e;b[c+h]=a&255,h+=x,a/=256,e-=8);d=d<<e|a;for(q+=e;0<q;b[c+h]=d&255,h+=x,d/=256,q-=8);b[c+h-x]|=128*v}},{}],68:[function(a,e,h){e.exports=function(a,e){e=e||Array(a.length);for(var c=0;c<a.length;++c)e[a[c]]=c;return e}},{}],69:[function(a,e,h){e.exports=function(a){for(var e=Array(a),c=0;c<a;++c)e[c]=c;return e}},{}],70:[function(a,e,h){function b(a){return!!a.constructor&&"function"===typeof a.constructor.isBuffer&&
a.constructor.isBuffer(a)}e.exports=function(a){return null!=a&&(b(a)||"function"===typeof a.readFloatLE&&"function"===typeof a.slice&&b(a.slice(0,0))||!!a._isBuffer)}},{}],71:[function(a,e,h){var b={}.toString;e.exports=Array.isArray||function(a){return"[object Array]"==b.call(a)}},{}],72:[function(a,e,h){e.exports=function(a,c){function d(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==A.alt,A.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==A.shift,A.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==
A.control,A.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==A.meta,A.meta=!!a.metaKey);return b}function e(a,f){var g=b.x(f),h=b.y(f);"buttons"in f&&(a=f.buttons|0);if(a!==y||g!==w||h!==C||d(f))y=a|0,w=g||0,C=h||0,c&&c(y,w,C,A)}function h(a){e(0,a)}function f(){if(y||w||C||A.shift||A.alt||A.meta||A.control)y=w=C=0,A.shift=A.alt=A.control=A.meta=!1,c&&c(0,0,0,A)}function q(a){d(a)&&c&&c(y,w,C,A)}function t(a){0===b.buttons(a)?e(0,a):e(y,a)}function z(a){e(y|b.buttons(a),a)}function k(a){e(y&
~b.buttons(a),a)}function x(){B||(B=!0,a.addEventListener("mousemove",t),a.addEventListener("mousedown",z),a.addEventListener("mouseup",k),a.addEventListener("mouseleave",h),a.addEventListener("mouseenter",h),a.addEventListener("mouseout",h),a.addEventListener("mouseover",h),a.addEventListener("blur",f),a.addEventListener("keyup",q),a.addEventListener("keydown",q),a.addEventListener("keypress",q),a!==window&&(window.addEventListener("blur",f),window.addEventListener("keyup",q),window.addEventListener("keydown",
q),window.addEventListener("keypress",q)))}function v(){B&&(B=!1,a.removeEventListener("mousemove",t),a.removeEventListener("mousedown",z),a.removeEventListener("mouseup",k),a.removeEventListener("mouseleave",h),a.removeEventListener("mouseenter",h),a.removeEventListener("mouseout",h),a.removeEventListener("mouseover",h),a.removeEventListener("blur",f),a.removeEventListener("keyup",q),a.removeEventListener("keydown",q),a.removeEventListener("keypress",q),a!==window&&(window.removeEventListener("blur",
f),window.removeEventListener("keyup",q),window.removeEventListener("keydown",q),window.removeEventListener("keypress",q)))}c||(c=a,a=window);var y=0,w=0,C=0,A={shift:!1,alt:!1,control:!1,meta:!1},B=!1;x();var F={element:a};Object.defineProperties(F,{enabled:{get:function(){return B},set:function(a){a?x():v},enumerable:!0},buttons:{get:function(){return y},enumerable:!0},x:{get:function(){return w},enumerable:!0},y:{get:function(){return C},enumerable:!0},mods:{get:function(){return A},enumerable:!0}});
return F};var b=a("mouse-event")},{"mouse-event":73}],73:[function(a,e,h){function b(a){return a.target||a.srcElement||window}h.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};h.element=b;h.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var c=b(a).getBoundingClientRect();
return a.clientX-c.left}return 0};h.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var c=b(a).getBoundingClientRect();return a.clientY-c.top}return 0}},{}],74:[function(a,e,h){var b=a("to-px");e.exports=function(a,c,d){"function"===typeof a&&(d=!!c,c=a,a=window);var e=b("ex",a),h=function(a){d&&a.preventDefault();var b=a.deltaX||0,g=a.deltaY||0,h=a.deltaZ||0,k=1;switch(a.deltaMode){case 1:k=e;break;case 2:k=window.innerHeight}b*=k;g*=k;h*=k;if(b||g||h)return c(b,g,h,a)};a.addEventListener("wheel",
h);return h}},{"to-px":82}],75:[function(a,e,h){function b(a,b,c){for(var d=0,e=0;e<a;++e)b&1<<e&&(d|=1<<c[e]);return d}function g(a,e,g,h,y,w){function C(a,b){E.push("for(","i"+y[a],"=",b,";","i"+y[a],"<","s"+y[a],";","++","i"+y[a],"){")}function A(a){for(var b=0;b<G;++b)E.push("p"+b,"+=","u"+b+"_"+y[a],";");E.push("}")}function B(){for(var a=1;a<1<<D;++a)E.push(t,"=","e"+a,";","e"+a,"=","y"+a,";","y"+a,"=",t,";")}function F(a,b){if(0>a){for(var c=0;c<G;++c)w[c]?E.push("c"+c+"_0","=","d"+c,".get(",
"p"+c,");"):E.push("c"+c+"_0","=","d"+c,"[","p"+c,"];");for(var e=[],c=0;c<G;++c)e.push("c"+c+"_0");for(c=0;c<h;++c)e.push("x"+c);E.push("b0","=",p,"[",q,"]=phase(",e.join(),");");for(e=1;e<1<<D;++e)E.push("b"+e,"=",p,"[",q,"+","e"+e,"];");c=[];for(e=1;e<1<<D;++e)c.push("(b0!==b"+e+")");E.push("if(",c.join("||"),"){");for(var f=[],c=0;c<D;++c)f.push("i"+c);for(c=0;c<G;++c)for(f.push("c"+c+"_0"),e=1;e<1<<D;++e)w[c]?E.push("c"+c+"_"+e,"=","d"+c,".get(","p"+c,"+","d"+c+"_"+e,");"):E.push("c"+c+"_"+e,
"=","d"+c,"[","p"+c,"+","d"+c+"_"+e,"];"),f.push("c"+c+"_"+e);for(c=0;c<1<<D;++c)f.push("b"+c);for(c=0;c<h;++c)f.push("x"+c);E.push("vertex(",f.join(),");","v0","=",d,"[",q,"]=",l,"++;");c=(1<<D)-1;f="b"+c;for(e=0;e<D;++e)if(0===(b&~(1<<e))){for(var g=c^1<<e,k="b"+g,u=[],t=g;0<t;t=t-1&g)u.push(d+"["+q+"+"+("e"+t)+"]");u.push("v0");for(t=0;t<G;++t)e&1?u.push("c"+t+"_"+c,"c"+t+"_"+g):u.push("c"+t+"_"+g,"c"+t+"_"+c);e&1?u.push(f,k):u.push(k,f);for(t=0;t<h;++t)u.push("x"+t);E.push("if(",f,"!==",k,"){",
"face(",u.join(),")}")}E.push("}",q,"+=1;")}else{for(e=a-1;0<=e;--e)C(e,0);c=[];for(e=0;e<G;++e)w[e]?c.push("d"+e+".get("+("p"+e)+")"):c.push("d"+e+"["+("p"+e)+"]");for(e=0;e<h;++e)c.push("x"+e);E.push(p,"[",q,"++]=phase(",c.join(),");");for(e=0;e<a;++e)A(e);for(e=0;e<G;++e)E.push("p"+e,"+=","u"+e+"_"+y[a],";");E.push("if(","s"+y[a],">0){","i"+y[a],"=1;");F(a-1,b|1<<y[a]);for(e=0;e<G;++e)E.push("p"+e,"+=","u"+e+"_"+y[a],";");a===D-1&&(E.push(q,"=0;"),B());C(a,2);F(a-1,b);a===D-1&&(E.push("if(","i"+
y[D-1],"&1){",q,"=0;}"),B());A(a);E.push("}")}}var G=w.length,D=y.length;if(2>D)throw Error("ndarray-extract-contour: Dimension must be at least 2");for(var u="extractContour"+y.join("_"),E=[],O=[],U=[],H=0;H<G;++H)U.push("a"+H);for(H=0;H<h;++H)U.push("x"+H);for(H=0;H<D;++H)O.push("s"+H+"=a0.shape["+H+"]|0");for(H=0;H<G;++H){O.push("d"+H+"="+("a"+H)+".data","o"+H+"="+("a"+H)+".offset|0");for(var I=0;I<D;++I)O.push("t"+H+"_"+I+"="+("a"+H)+".stride["+I+"]|0")}for(H=0;H<G;++H)for(O.push("p"+H+"="+("o"+
H)),O.push("c"+H+"_0"),I=1;I<1<<D;++I){for(var R=[],J=0;J<D;++J)I&1<<J&&R.push("-"+("t"+H+"_"+J));O.push("d"+H+"_"+I+"=("+R.join("")+")|0");O.push("c"+H+"_"+I+"=0")}for(H=0;H<G;++H)for(I=0;I<D;++I)J=["t"+H+"_"+y[I]],0<I&&J.push("t"+H+"_"+y[I-1]+"*"+("s"+y[I-1])),O.push("u"+H+"_"+y[I]+"=("+J.join("-")+")|0");for(H=0;H<D;++H)O.push("i"+H+"=0");O.push(l+"=0");I=["2"];for(H=D-2;0<=H;--H)I.push("s"+y[H]);O.push(f+"=("+I.join("*")+")|0",p+"=mallocUint32("+f+")",d+"=mallocUint32("+f+")",q+"=0");O.push("b0=0");
for(I=1;I<1<<D;++I){H=[];R=[];for(J=0;J<D;++J)I&1<<J&&(0===R.length?H.push("1"):H.unshift(R.join("*"))),R.push("s"+y[J]);J="";0>H[0].indexOf("s"+y[D-2])&&(J="-");R=b(D,I,y);O.push("e"+R+"=(-"+H.join("-")+")|0","y"+R+"=("+J+H.join("-")+")|0","b"+R+"=0")}O.push("v0=0",t+"=0");F(D-1,0);E.push("freeUint32(",d,");freeUint32(",p,");");u=["'use strict';function ",u,"(",U.join(),"){var ",O.join(),";",E.join(""),"}return ",u].join("");return(new Function("vertex","face","phase","mallocUint32","freeUint32",
u))(a,e,g,c.mallocUint32,c.freeUint32)}var c=a("typedarray-pool");e.exports=function(a){function b(a){throw Error("ndarray-extract-contour: "+a);}"object"!==typeof a&&b("Must specify arguments");var c=a.order;Array.isArray(c)||b("Must specify order");var d=a.arrayArguments||1;1>d&&b("Must have at least one array argument");var e=a.scalarArguments||0;0>e&&b("Scalar arg count must be > 0");"function"!==typeof a.vertex&&b("Must specify vertex creation function");"function"!==typeof a.cell&&b("Must specify cell creation function");
"function"!==typeof a.phase&&b("Must specify phase function");for(var f=a.getters||[],h=Array(d),l=0;l<d;++l)0<=f.indexOf(l)?h[l]=!0:h[l]=!1;return g(a.vertex,a.cell,a.phase,e,c,h)};var d="V",p="P",l="N",f="Q",q="X",t="T"},{"typedarray-pool":84}],76:[function(a,e,h){function b(a,b){return a[0]-b[0]}function g(){var a=this.stride,c=Array(a.length),d;for(d=0;d<c.length;++d)c[d]=[Math.abs(a[d]),d];c.sort(b);a=Array(c.length);for(d=0;d<a.length;++d)a[d]=c[d][1];return a}function c(a,b){var c=["View",
b,"d",a].join("");0>b&&(c="View_Nil"+a);var d="generic"===a;if(-1===b){var e,c=new Function("function "+c+"(a){this.data=a;};var proto="+c+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+c+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+c+"(a){return new "+c+"(a);}");return c()}if(0===
b)return c=new Function("TrivialArray","function "+c+"(a,d) {this.data = a;this.offset = d};var proto="+c+".prototype;proto.dtype='"+a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+c+"_copy() {return new "+c+"(this.data,this.offset)};proto.pick=function "+c+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+c+"_get(){return "+(d?"this.data.get(this.offset)":
"this.data[this.offset]")+"};proto.set=function "+c+"_set(v){return "+(d?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+c+"(a,b,c,d){return new "+c+"(a,d)}"),c(q[a][0]);e=["'use strict'"];var f=p(b),h=f.map(function(a){return"i"+a}),l="this.offset+"+f.map(function(a){return"this.stride["+a+"]*i"+a}).join("+"),A=f.map(function(a){return"b"+a}).join(","),B=f.map(function(a){return"c"+a}).join(",");e.push("function "+c+"(a,"+A+","+B+",d){this.data=a","this.shape=["+
A+"]","this.stride=["+B+"]","this.offset=d|0}","var proto="+c+".prototype","proto.dtype='"+a+"'","proto.dimension="+b);e.push("Object.defineProperty(proto,'size',{get:function "+c+"_size(){return "+f.map(function(a){return"this.shape["+a+"]"}).join("*"),"}})");1===b?e.push("proto.order=[0]"):(e.push("Object.defineProperty(proto,'order',{get:"),4>b?(e.push("function "+c+"_order(){"),2===b?e.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===b&&e.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):
e.push("ORDER})"));e.push("proto.set=function "+c+"_set("+h.join(",")+",v){");d?e.push("return this.data.set("+l+",v)}"):e.push("return this.data["+l+"]=v}");e.push("proto.get=function "+c+"_get("+h.join(",")+"){");d?e.push("return this.data.get("+l+")}"):e.push("return this.data["+l+"]}");e.push("proto.index=function "+c+"_index(",h.join(),"){return "+l+"}");e.push("proto.hi=function "+c+"_hi("+h.join(",")+"){return new "+c+"(this.data,"+f.map(function(a){return["(typeof i",a,"!=='number'||i",a,
"<0)?this.shape[",a,"]:i",a,"|0"].join("")}).join(",")+","+f.map(function(a){return"this.stride["+a+"]"}).join(",")+",this.offset)}");d=f.map(function(a){return"a"+a+"=this.shape["+a+"]"});l=f.map(function(a){return"c"+a+"=this.stride["+a+"]"});e.push("proto.lo=function "+c+"_lo("+h.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+l.join(","));for(d=0;d<b;++d)e.push("if(typeof i"+d+"==='number'&&i"+d+">=0){d=i"+d+"|0;b+=c"+d+"*d;a"+d+"-=d}");e.push("return new "+c+"(this.data,"+f.map(function(a){return"a"+
a}).join(",")+","+f.map(function(a){return"c"+a}).join(",")+",b)}");e.push("proto.step=function "+c+"_step("+h.join(",")+"){var "+f.map(function(a){return"a"+a+"=this.shape["+a+"]"}).join(",")+","+f.map(function(a){return"b"+a+"=this.stride["+a+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(d=0;d<b;++d)e.push("if(typeof i"+d+"==='number'){d=i"+d+"|0;if(d<0){c+=b"+d+"*(a"+d+"-1);a"+d+"=ceil(-a"+d+"/d)}else{a"+d+"=ceil(a"+d+"/d)}b"+d+"*=d}");e.push("return new "+c+"(this.data,"+f.map(function(a){return"a"+
a}).join(",")+","+f.map(function(a){return"b"+a}).join(",")+",c)}");l=Array(b);A=Array(b);for(d=0;d<b;++d)l[d]="a[i"+d+"]",A[d]="b[i"+d+"]";e.push("proto.transpose=function "+c+"_transpose("+h+"){"+h.map(function(a,b){return a+"=("+a+"===undefined?"+b+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+c+"(this.data,"+l.join(",")+","+A.join(",")+",this.offset)}");e.push("proto.pick=function "+c+"_pick("+h+"){var a=[],b=[],c=this.offset");for(d=0;d<b;++d)e.push("if(typeof i"+d+"==='number'&&i"+
d+">=0){c=(c+this.stride["+d+"]*i"+d+")|0}else{a.push(this.shape["+d+"]);b.push(this.stride["+d+"])}");e.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");e.push("return function construct_"+c+"(data,shape,stride,offset){return new "+c+"(data,"+f.map(function(a){return"shape["+a+"]"}).join(",")+","+f.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}");c=new Function("CTOR_LIST","ORDER",e.join("\n"));return c(q[a],g)}function d(a){if(l(a))return"buffer";if(f)switch(Object.prototype.toString.call(a)){case "[object Float64Array]":return"float64";
case "[object Float32Array]":return"float32";case "[object Int8Array]":return"int8";case "[object Int16Array]":return"int16";case "[object Int32Array]":return"int32";case "[object Uint8Array]":return"uint8";case "[object Uint16Array]":return"uint16";case "[object Uint32Array]":return"uint32";case "[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(a)?"array":"generic"}var p=a("iota-array"),l=a("is-buffer"),f="undefined"!==typeof Float64Array,q={float32:[],float64:[],int8:[],int16:[],
int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var a in q)q[a].push(c(a,-1))});e.exports=function(a,b,e,f){if(void 0===a){var g=q.array[0];return g([])}"number"===typeof a&&(a=[a]);void 0===b&&(b=[a.length]);g=b.length;if(void 0===e){e=Array(g);for(var h=g-1,l=1;0<=h;--h)e[h]=l,l*=b[h]}if(void 0===f)for(h=f=0;h<g;++h)0>e[h]&&(f-=(b[h]-1)*e[h]);h=d(a);for(l=q[h];l.length<=g+1;)l.push(c(h,l.length-1));g=l[g+1];return g(a,b,e,f)}},{"iota-array":69,
"is-buffer":70}],77:[function(a,e,h){e.exports=function(a,e){e||(e=[0,""]);a=String(a);var c=parseFloat(a,10);e[0]=c;e[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"";return e}},{}],78:[function(a,e,h){e.exports=function(a){var d=a.length;if(d<b)for(var e=1,h=0;h<d;++h)for(var f=0;f<h;++f)if(a[h]<a[f])e=-e;else{if(a[h]===a[f])return 0}else{for(var q=g.mallocUint8(d),h=0;h<d;++h)q[h]=0;e=1;for(h=0;h<d;++h)if(!q[h]){var t=1;q[h]=1;for(f=a[h];f!==h;f=a[f]){if(q[f])return g.freeUint8(q),0;t+=1;q[f]=1}t&1||(e=
-e)}g.freeUint8(q)}return e};var b=32,g=a("typedarray-pool")},{"typedarray-pool":84}],79:[function(a,e,h){var b=a("typedarray-pool"),g=a("invert-permutation");h.rank=function(a){var d=a.length;switch(d){case 0:case 1:return 0;case 2:return a[1]}var e=b.mallocUint32(d),h=b.mallocUint32(d),f=0,q;g(a,h);for(q=0;q<d;++q)e[q]=a[q];for(q=d-1;0<q;--q)d=h[q],a=e[q],e[q]=e[d],e[d]=a,h[q]=h[a],h[a]=d,f=(f+a)*q;b.freeUint32(h);b.freeUint32(e);return f};h.unrank=function(a,b,e){switch(a){case 0:return e?e:[];
case 1:return e?(e[0]=0,e):[0];case 2:return e?(b?(e[0]=0,e[1]=1):(e[0]=1,e[1]=0),e):b?[0,1]:[1,0]}e=e||Array(a);var g,f,h=1;e[0]=0;for(f=1;f<a;++f)e[f]=f,h=h*f|0;for(f=a-1;0<f;--f)a=b/h|0,b=b-a*h|0,h=h/f|0,g=e[f]|0,e[f]=e[a]|0,e[a]=g|0;return e}},{"invert-permutation":68,"typedarray-pool":84}],80:[function(a,e,h){function b(a){throw Error("resl: "+a);}function g(a,c,d){Object.keys(a).forEach(function(a){0>c.indexOf(a)&&b('invalid parameter "'+a+'" in '+d)})}function c(a,b){this.state=0;this.ready=
!1;this.progress=0;this.name=a;this.cancel=b}var d=["manifest","onDone","onProgress","onError"],p=["type","src","stream","credentials","parser"],l=["onData","onDone"];e.exports=function(a){function e(c,d){if(c in a){var g=a[c];"function"!==typeof g&&b('invalid callback "'+c+'"');return g}return null}function h(a){function b(){if(!(2>l.readyState||1===q.state||-1===q.state)){if(200!==l.status)return k('error loading resource "'+a.name+'"');if(2<l.readyState&&0===q.state){var c;c="binary"===a.type?
l.response:l.responseText;if(g.data)try{p=g.data(c)}catch(e){return k(e)}else p=c}if(3<l.readyState&&0===q.state){if(g.done)try{p=g.done()}catch(e){return k(e)}q.state=1}A[d]=p;q.progress=.75*q.progress+.25;q.ready=a.stream&&!!p||1===q.state;x()}}var d=a.name,e=a.stream,f="binary"===a.type,g=a.parser,l=new XMLHttpRequest,p=null,q=new c(d,function(){1!==q.state&&-1!==q.state&&(l.onreadystatechange=null,l.abort(),q.state=-1)});l.onreadystatechange=e?b:function(){4===l.readyState&&b()};f&&(l.responseType=
"arraybuffer");a.credentials&&(l.withCredentials=!0);l.open("GET",a.src,!0);l.send();return q}function z(a,b){function d(){if(0===q.state)if(p.data)try{t=p.data(b)}catch(a){return k(a)}else t=b}function e(a){d();A[l]=t;q.progress=a.lengthComputable?Math.max(q.progress,a.loaded/a.total):.75*q.progress+.25;x(l)}function f(){d();if(0===q.state){if(p.done)try{t=p.done()}catch(a){return k(a)}q.state=1}q.progress=1;q.ready=!0;A[l]=t;h();x("finish "+l)}function g(){k('error loading asset "'+l+'"')}function h(){a.stream&&
b.removeEventListener("progress",e);"image"===a.type?b.addEventListener("load",f):b.addEventListener("canplay",f);b.removeEventListener("error",g)}var l=a.name,p=a.parser,q=new c(l,function(){1!==q.state&&-1!==q.state&&(q.state=-1,h(),b.src="")}),t=b;a.stream&&b.addEventListener("progress",e);if("image"===a.type)b.addEventListener("load",f);else{var v=!1,m=!1;b.addEventListener("loadedmetadata",function(){m=!0;v&&f()});b.addEventListener("canplay",function(){v=!0;m&&f()})}b.addEventListener("error",
g);b.crossOrigin=a.credentials?"use-credentials":"anonymous";b.src=a.src;return q}function k(a){-1!==B&&1!==B&&(B=-1,G.forEach(function(a){a.cancel()}),C?"string"===typeof a?C(Error("resl: "+a)):C(a):console.error("resl error:",a))}function x(a){if(-1!==B&&1!==B){var b=0,c=0;G.forEach(function(a){a.ready&&(c+=1);b+=a.progress});c===G.length?(B=1,y(A)):w&&w(b/G.length,a)}}"object"===typeof a&&a||b("invalid or missing configuration");g(a,d,"config");var v=a.manifest;"object"===typeof v&&v||b("missing manifest");
var y=e("onDone");y||b("missing onDone() callback");var w=e("onProgress"),C=e("onError"),A={},B=0,F={text:h,binary:function(a){return h(a)},image:function(a){return z(a,document.createElement("img"))},video:function(a){return z(a,document.createElement("video"))},audio:function(a){return z(a,document.createElement("audio"))}},G=Object.keys(v).map(function(a){function c(a,e){if(a in d.parser){var f=d.parser[a];"function"!==typeof f&&b("invalid parser callback "+a+' for asset "'+a+'"');return f}return e}
var d=v[a];"string"===typeof d?d={src:d}:"object"===typeof d&&d||b('invalid asset definition "'+a+'"');g(d,p,'asset "'+a+'"');var e={};"parser"in d&&("function"===typeof d.parser?e={data:d.parser}:"object"===typeof d.parser&&d.parser?(g(e,l,'parser for asset "'+a+'"'),"onData"in e||b('missing onData callback for parser in asset "'+a+'"'),e={data:c("onData"),done:c("onDone")}):b('invalid parser for asset "'+a+'"'));return{name:a,type:function(c,e,f){c in d&&(f=d[c]);0>e.indexOf(f)&&b("invalid "+c+
' "'+f+'" for asset "'+a+'", possible values: '+e);return f}("type",Object.keys(F),"text"),stream:!!d.stream,credentials:!!d.credentials,src:function(c,e,f){c in d?f=d[c]:e&&b("missing "+c+' for asset "'+a+'"');"string"!==typeof f&&b("invalid "+c+' for asset "'+a+'", must be a string');return f}("src",!0,""),parser:e}}).map(function(a){return F[a.type](a)});0===G.length&&setTimeout(function(){x("done")},1)}},{}],81:[function(a,e,h){function b(a,b){var d=a.length,e=["'use strict';"],h="surfaceNets"+
a.join("_")+"d"+b;e.push("var contour=genContour({","order:[",a.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");"generic"===b&&e.push("getters:[0],");for(var k=[],p=[],v=0;v<d;++v)k.push("d"+v),p.push("d"+v);for(v=0;v<1<<d;++v)k.push("v"+v),p.push("v"+v);for(v=0;v<1<<d;++v)k.push("p"+v),p.push("p"+v);k.push("a","b","c");p.push("a","c");e.push("vertex:function vertexFunc(",k.join(),"){");k=[];for(v=0;v<1<<d;++v)k.push("(p"+v+"<<"+v+")");e.push("var m=(",
k.join("+"),")|0;if(m===0||m===",(1<<(1<<d))-1,"){return}");var k=[],y=[];128>=1<<(1<<d)?(e.push("switch(m){"),y=e):e.push("switch(m>>>7){");for(v=0;v<1<<(1<<d);++v){128<1<<(1<<d)&&0===v%128&&(0<k.length&&y.push("}}"),y="vExtra"+k.length,e.push("case ",v>>>7,":",y,"(m&0x7f,",p.join(),");break;"),y=["function ",y,"(m,",p.join(),"){switch(m){"],k.push(y));y.push("case ",v&127,":");for(var w=Array(d),C=Array(d),A=Array(d),B=Array(d),F=0,G=0;G<d;++G)w[G]=[],C[G]=[],A[G]=0,B[G]=0;for(G=0;G<1<<d;++G)for(var D=
0;D<d;++D){var u=G^1<<D;if(!(u>G)&&!(v&1<<u)!==!(v&1<<G)){var E=1;v&1<<u?C[D].push("v"+u+"-v"+G):(C[D].push("v"+G+"-v"+u),E=-E);0>E?(w[D].push("-v"+G+"-v"+u),A[D]+=2):(w[D].push("v"+G+"+v"+u),A[D]-=2);F+=1;for(E=0;E<d;++E)E!==D&&(u&1<<E?B[E]+=1:--B[E])}}G=[];for(D=0;D<d;++D)0===w[D].length?G.push("d"+D+"-0.5"):(u="",0>A[D]?u=A[D]+"*c":0<A[D]&&(u="+"+A[D]+"*c"),G.push("d"+D+"-"+(.5+B[D]/F*.5)+"-"+w[D].length/F*.5+"*("+w[D].join("+")+u+")/("+C[D].join("+")+")"));y.push("a.push([",G.join(),"]);","break;")}e.push("}},");
0<k.length&&y.push("}}");p=[];for(v=0;v<1<<d-1;++v)p.push("v"+v);p.push("c0","c1","p0","p1","a","b","c");e.push("cell:function cellFunc(",p.join(),"){");d=c(d-1);e.push("if(p0){b.push(",d.map(function(a){return"["+a.map(function(a){return"v"+a})+"]"}).join(),")}else{b.push(",d.map(function(a){a=a.slice();a.reverse();return"["+a.map(function(a){return"v"+a})+"]"}).join(),")}}});function ",h,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",
h,";");for(v=0;v<k.length;++v)e.push(k[v].join(""));return(new Function("genContour",e.join("")))(g)}e.exports=function(a,c){if(0>=a.dimension)return{positions:[],cells:[]};if(1===a.dimension){for(var e=d(a,c),g=e.length,h=Array(g),k=Array(g),x=0;x<g;++x)h[x]=[e[x]],k[x]=[x];return{positions:h,cells:k}}e=a.order.join()+"-"+a.dtype;g=p[e];c=+c||0;g||(g=p[e]=b(a.order,a.dtype));return g(a,c)};var g=a("ndarray-extract-contour"),c=a("triangulate-hypercube"),d=a("zero-crossings"),p={}},{"ndarray-extract-contour":75,
"triangulate-hypercube":83,"zero-crossings":87}],82:[function(a,e,h){function b(a,b){var d=c(getComputedStyle(a).getPropertyValue(b));return d[0]*g(d[1],a)}function g(a,c){c=c||document.body;a=(a||"px").trim().toLowerCase();if(c===window||c===document)c=document.body;switch(a){case "%":return c.clientHeight/100;case "ch":case "ex":var e=a,g=c,h=document.createElement("div");h.style["font-size"]="128"+e;g.appendChild(h);e=b(h,"font-size")/128;g.removeChild(h);return e;case "em":return b(c,"font-size");
case "rem":return b(document.body,"font-size");case "vw":return window.innerWidth/100;case "vh":return window.innerHeight/100;case "vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case "vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case "in":return d;case "cm":return d/2.54;case "mm":return d/25.4;case "pt":return d/72;case "pc":return d/6}return 1}var c=a("parse-unit");e.exports=g;var d=96},{"parse-unit":77}],83:[function(a,e,h){e.exports=function(a){if(0>a)return[];
if(0===a)return[[0]];for(var e=Math.round(c(a+1))|0,h=[],f=0;f<e;++f){for(var q=b.unrank(a,f),t=[0],z=0,k=0;k<q.length;++k)z+=1<<q[k],t.push(z);1>g(q)&&(t[0]=z,t[a]=0);h.push(t)}return h};var b=a("permutation-rank"),g=a("permutation-parity"),c=a("gamma")},{gamma:44,"permutation-parity":78,"permutation-rank":79}],84:[function(a,e,h){(function(b,e){function c(a){if(a){var b=C.log2(a.length||a.byteLength);G[b].push(a)}}function d(a){a=C.nextPow2(a);var b=C.log2(a),b=G[b];return 0<b.length?b.pop():new ArrayBuffer(a)}
function p(a){return new Uint8Array(d(a),0,a)}function l(a){return new Uint16Array(d(2*a),0,a)}function f(a){return new Uint32Array(d(4*a),0,a)}function q(a){return new Int8Array(d(a),0,a)}function t(a){return new Int16Array(d(2*a),0,a)}function z(a){return new Int32Array(d(4*a),0,a)}function k(a){return new Float32Array(d(4*a),0,a)}function x(a){return new Float64Array(d(8*a),0,a)}function v(a){return B?new Uint8ClampedArray(d(a),0,a):p(a)}function y(a){return new DataView(d(a),0,a)}function w(a){a=
C.nextPow2(a);var b=C.log2(a),b=D[b];return 0<b.length?b.pop():new e(a)}var C=a("bit-twiddle"),A=a("dup");b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:A([32,0]),UINT16:A([32,0]),UINT32:A([32,0]),INT8:A([32,0]),INT16:A([32,0]),INT32:A([32,0]),FLOAT:A([32,0]),DOUBLE:A([32,0]),DATA:A([32,0]),UINT8C:A([32,0]),BUFFER:A([32,0])});var B="undefined"!==typeof Uint8ClampedArray,F=b.__TYPEDARRAY_POOL;F.UINT8C||(F.UINT8C=A([32,0]));F.BUFFER||(F.BUFFER=A([32,0]));var G=F.DATA,D=F.BUFFER;h.free=function(a){if(e.isBuffer(a))D[C.log2(a.length)].push(a);
else if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),a){var b=C.log2(a.length||a.byteLength)|0;G[b].push(a)}};h.freeUint8=h.freeUint16=h.freeUint32=h.freeInt8=h.freeInt16=h.freeInt32=h.freeFloat32=h.freeFloat=h.freeFloat64=h.freeDouble=h.freeUint8Clamped=h.freeDataView=function(a){c(a.buffer)};h.freeArrayBuffer=c;h.freeBuffer=function(a){D[C.log2(a.length)].push(a)};h.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return d(a);switch(b){case "uint8":return p(a);case "uint16":return l(a);
case "uint32":return f(a);case "int8":return q(a);case "int16":return t(a);case "int32":return z(a);case "float":case "float32":return k(a);case "double":case "float64":return x(a);case "uint8_clamped":return v(a);case "buffer":return w(a);case "data":case "dataview":return y(a);default:return null}};h.mallocArrayBuffer=d;h.mallocUint8=p;h.mallocUint16=l;h.mallocUint32=f;h.mallocInt8=q;h.mallocInt16=t;h.mallocInt32=z;h.mallocFloat32=h.mallocFloat=k;h.mallocFloat64=h.mallocDouble=x;h.mallocUint8Clamped=
v;h.mallocDataView=y;h.mallocBuffer=w;h.clearCache=function(){for(var a=0;32>a;++a)F.UINT8[a].length=0,F.UINT16[a].length=0,F.UINT32[a].length=0,F.INT8[a].length=0,F.INT16[a].length=0,F.INT32[a].length=0,F.FLOAT[a].length=0,F.DOUBLE[a].length=0,F.UINT8C[a].length=0,G[a].length=0,D[a].length=0}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},a("buffer").Buffer)},{"bit-twiddle":38,buffer:39,dup:43}],85:[function(a,e,h){e.exports=function(a,
e,c){if(0===a.length)return a;if(e){c||a.sort(e);c=1;for(var d=a.length,h=a[0],l=a[0],f=1;f<d;++f)l=h,h=a[f],e(h,l)&&(f===c?c++:a[c++]=h);a.length=c;return a}c||a.sort();e=1;c=a.length;d=a[0];h=a[0];for(l=1;l<c;++l)h=d,d=a[l],d!==h&&(l===e?e++:a[e++]=d);a.length=e;return a}},{}],86:[function(a,e,h){e.exports=a("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",
args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":40}],87:[function(a,e,h){e.exports=function(a,c){var d=[];c=+c||0;b(a.hi(a.shape[0]-1),d,c);return d};var b=a("./lib/zc-core")},
{"./lib/zc-core":86}],88:[function(a,e,h){function b(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var g=a("./lib/util/check"),c=a("./lib/util/extend"),d=a("./lib/dynamic"),p=a("./lib/util/raf"),l=a("./lib/util/clock"),f=a("./lib/strings"),q=a("./lib/webgl"),t=a("./lib/extension"),z=a("./lib/limits"),k=a("./lib/buffer"),x=a("./lib/elements"),v=a("./lib/texture"),y=a("./lib/renderbuffer"),w=a("./lib/framebuffer"),C=a("./lib/attribute"),A=a("./lib/shader"),B=a("./lib/read"),F=a("./lib/core"),
G=a("./lib/stats"),D=a("./lib/timer");e.exports=function(a){function e(){if(0===P.length)N&&N.update(),fa=null;else{fa=p.next(e);S();for(var a=P.length-1;0<=a;--a){var b=P[a];b&&b(aa,null,0)}r.flush();N&&N.update()}}function h(){!fa&&0<P.length&&(fa=p.next(e))}function U(){fa&&(p.cancel(e),fa=null)}function H(a){a.preventDefault();ca=!0;U();Y.forEach(function(a){a()})}function I(a){r.getError();ca=!1;ka.restore();ja.restore();ha.restore();la.restore();sa.restore();W.restore();N&&N.restore();X.procs.refresh();
h();da.forEach(function(a){a()})}function R(a){function b(a){var c={},e={};Object.keys(a).forEach(function(b){var f=a[b];d.isDynamic(f)?e[b]=d.unbox(f,b):c[b]=f});return{dynamic:e,"static":c}}function e(a){for(;q.length<a;)q.push(null);return q}g(!!a,"invalid args to regl({...})");g.type(a,"object","invalid args to regl({...})");var f=b(a.context||{}),h=b(a.uniforms||{}),k=b(a.attributes||{}),l=b(function(a){function b(a){if(a in d){var c=d[a];delete d[a];Object.keys(c).forEach(function(b){d[a+"."+
b]=c[b]})}}var d=c({},a);delete d.uniforms;delete d.attributes;delete d.context;"stencil"in d&&d.stencil.op&&(d.stencil.opBack=d.stencil.opFront=d.stencil.op,delete d.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return d}(a));a={gpuTime:0,cpuTime:0,count:0};var f=X.compile(l,k,h,f,a),m=f.draw,n=f.batch,p=f.scope,q=[];return c(function(a,b){var c;ca&&g.raise("context lost");if("function"===typeof a)return p.call(this,null,a,0);if("function"===
typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return m.call(this,a)},{stats:a})}function J(a,b){var c=0;X.procs.poll();var d=b.color;d&&(r.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384);"depth"in b&&(r.clearDepth(+b.depth),c|=
256);"stencil"in b&&(r.clearStencil(b.stencil|0),c|=1024);g(!!c,"called regl.clear with no buffer specified");r.clear(c)}function T(a){g.type(a,"function","regl.frame() callback must be a function");P.push(a);h();return{cancel:function(){function c(){var a=b(P,c);P[a]=P[P.length-1];--P.length;0>=P.length&&U()}var d=b(P,a);g(0<=d,"cannot cancel a frame twice");P[d]=c}}}function L(){var a=ea.viewport,b=ea.scissor_box;a[0]=a[1]=b[0]=b[1]=0;aa.viewportWidth=aa.framebufferWidth=aa.drawingBufferWidth=a[2]=
b[2]=r.drawingBufferWidth;aa.viewportHeight=aa.framebufferHeight=aa.drawingBufferHeight=a[3]=b[3]=r.drawingBufferHeight}function S(){aa.tick+=1;aa.time=n();L();X.procs.poll()}function m(){L();X.procs.refresh();N&&N.update()}function n(){return(l()-xa)/1E3}a=q(a);if(!a)return null;var r=a.gl,M=r.getContextAttributes(),ca=r.isContextLost(),ka=t(r,a);if(!ka)return null;var qa=f(),Z=G(),Q=ka.extensions,N=D(r,Q),xa=l(),na=r.drawingBufferWidth,ra=r.drawingBufferHeight,aa={tick:0,time:0,viewportWidth:na,
viewportHeight:ra,framebufferWidth:na,framebufferHeight:ra,drawingBufferWidth:na,drawingBufferHeight:ra,pixelRatio:a.pixelRatio},ga=z(r,Q),ha=k(r,Z,a),ia=x(r,Q,ha,Z),na=C(r,Q,ga,ha,qa),ja=A(r,qa,Z,a),la=v(r,Q,ga,function(){X.procs.poll()},aa,Z,a),sa=y(r,Q,ga,Z,a),W=w(r,Q,ga,la,sa,Z),X=F(r,qa,Q,ga,ha,ia,la,W,{},na,ja,{elements:null,primitive:4,count:-1,offset:0,instances:-1},aa,N,a),qa=B(r,W,X.procs.poll,aa,M,Q),ea=X.next,V=r.canvas,P=[],Y=[],da=[],ta=[a.onDestroy],fa=null;V&&(V.addEventListener("webglcontextlost",
H,!1),V.addEventListener("webglcontextrestored",I,!1));var oa=W.setFBO=R({framebuffer:d.define.call(null,1,"framebuffer")});m();M=c(R,{clear:function(a){g("object"===typeof a&&a,"regl.clear() takes an object as input");if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)oa(c({framebuffer:a.framebuffer.faces[b]},a),J);else oa(a,J);else J(null,a)},prop:d.define.bind(null,1),context:d.define.bind(null,2),"this":d.define.bind(null,3),draw:R({}),buffer:function(a){return ha.create(a,
34962,!1,!1)},elements:function(a){return ia.create(a,!1)},texture:la.create2D,cube:la.createCube,renderbuffer:sa.create,framebuffer:W.create,framebufferCube:W.createCube,attributes:M,frame:T,on:function(a,b){g.type(b,"function","listener callback must be a function");var c;switch(a){case "frame":return T(b);case "lost":c=Y;break;case "restore":c=da;break;case "destroy":c=ta;break;default:g.raise("invalid event, must be one of frame,lost,restore,destroy")}c.push(b);return{cancel:function(){for(var a=
0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ga,hasExtension:function(a){return 0<=ga.extensions.indexOf(a.toLowerCase())},read:qa,destroy:function(){P.length=0;U();V&&(V.removeEventListener("webglcontextlost",H),V.removeEventListener("webglcontextrestored",I));ja.clear();W.clear();sa.clear();la.clear();ia.clear();ha.clear();N&&N.clear();ta.forEach(function(a){a()})},_gl:r,_refresh:m,poll:function(){S();N&&N.update()},now:n,stats:Z});a.onDone(null,M);return M}},{"./lib/attribute":3,
"./lib/buffer":4,"./lib/core":9,"./lib/dynamic":10,"./lib/elements":11,"./lib/extension":12,"./lib/framebuffer":13,"./lib/limits":14,"./lib/read":15,"./lib/renderbuffer":16,"./lib/shader":17,"./lib/stats":18,"./lib/strings":19,"./lib/texture":20,"./lib/timer":21,"./lib/util/check":22,"./lib/util/clock":23,"./lib/util/extend":25,"./lib/util/raf":32,"./lib/webgl":35}]},{},[1]);
