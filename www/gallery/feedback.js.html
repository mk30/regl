<!DOCTYPE html>
      <html>
        <head>
          <title>example/feedback.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(q,y,c){function g(f,m){if(!y[f]){if(!q[f]){var a="function"==typeof require&&require;if(!m&&a)return a(f,!0);if(l)return l(f,!0);a=Error("Cannot find module '"+f+"'");throw a.code="MODULE_NOT_FOUND",a;}a=y[f]={exports:{}};q[f][0].call(a.exports,function(a){var c=q[f][1][a];return g(c?c:a)},a,a.exports,e$$0,q,y,c)}return y[f].exports}for(var l="function"==typeof require&&require,x=0;x<c.length;x++)g(c[x]);return g})({1:[function(h,q,y){var c=h("../regl")(),g=h("mouse-change")(),l=c.texture(),
x=c({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:l,mouse:function(f){var c=f.pixelRatio;return[g.x*c,f.viewportHeight-g.y*c]},t:function(f){return.01*f.tick}},count:3});c.frame(function(){c.clear({color:[0,0,0,1]});x();l({copy:!0})})},{"../regl":37,"mouse-change":35}],2:[function(h,q,y){function c(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}q.exports=function(g,l,x,f,m){g=x.maxAttributes;l=
Array(g);for(x=0;x<g;++x)l[x]=new c;return{Record:c,scope:{},state:l}}},{}],3:[function(h,q,y){function c(a){return u[Object.prototype.toString.call(a)]|0}function g(a,f){for(var c=0;c<f.length;++c)a[c]=f[c]}function l(a,f,c,g,m,l,x){for(var b=0,e=0;e<c;++e)for(var n=0;n<g;++n)a[b++]=f[m*e+l*n+x]}var x=h("./util/check"),f=h("./util/is-typed-array"),m=h("./util/is-ndarray"),a=h("./util/values"),p=h("./util/pool");y=h("./util/flatten");var C=y.flatten,A=y.shape,u=h("./constants/arraytypes.json"),n=
h("./constants/dtypes.json"),O=h("./constants/usage.json"),z=[];z[5120]=1;z[5122]=2;z[5124]=4;z[5121]=1;z[5123]=2;z[5125]=4;z[5126]=4;q.exports=function(h,u,k){function t(a){this.id=b++;this.buffer=h.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;k.profile&&(this.stats={size:0})}function L(a,b,e){a.byteLength=b.byteLength;h.bufferData(a.type,b,e)}function M(a,b,e,n,k,t){a.usage=e;if(Array.isArray(b)){if(a.dtype=n||5126,0<b.length)if(Array.isArray(b[0])){k=
A(b);for(var h=n=1;h<k.length;++h)n*=k[h];a.dimension=n;b=C(b,k,a.dtype);L(a,b,e);t?a.persistentData=b:p.freeType(b)}else"number"===typeof b[0]?(a.dimension=k,k=p.allocType(a.dtype,b.length),g(k,b),L(a,k,e),t?a.persistentData=k:p.freeType(k)):f(b[0])?(a.dimension=b[0].length,a.dtype=n||c(b[0])||5126,b=C(b,[b.length,b[0].length],a.dtype),L(a,b,e),t?a.persistentData=b:p.freeType(b)):x.raise("invalid buffer data")}else if(f(b))a.dtype=n||c(b),a.dimension=k,L(a,b,e),t&&(a.persistentData=new Uint8Array(new Uint8Array(b.buffer)));
else if(m(b)){k=b.shape;var u=b.stride,h=b.offset,H=0,U=0,I=0,B=0;1===k.length?(H=k[0],U=1,I=u[0],B=0):2===k.length?(H=k[0],U=k[1],I=u[0],B=u[1]):x.raise("invalid shape");a.dtype=n||c(b.data)||5126;a.dimension=U;k=p.allocType(a.dtype,H*U);l(k,b.data,H,U,I,B,h);L(a,k,e);t?a.persistentData=k:p.freeType(k)}else x.raise("invalid buffer data")}function B(a){u.bufferCount--;var b=a.buffer;x(b,"buffer must not be deleted already");h.deleteBuffer(b);a.buffer=null;delete e[a.id]}var b=0,e={};t.prototype.bind=
function(){h.bindBuffer(this.type,this.buffer)};t.prototype.destroy=function(){B(this)};var H=[];k.profile&&(u.getTotalBufferSize=function(){var a=0;Object.keys(e).forEach(function(b){a+=e[b].stats.size});return a});return{create:function(a,b,H,L){function q(a){var b=35044,e=null,c=0,g=0,l=1;Array.isArray(a)||f(a)||m(a)?e=a:"number"===typeof a?c=a|0:a&&(x.type(a,"object","buffer arguments must be an object, a number or an array"),"data"in a&&(x(null===e||Array.isArray(e)||f(e)||m(e),"invalid data for buffer"),
e=a.data),"usage"in a&&(x.parameter(a.usage,O,"invalid buffer usage"),b=O[a.usage]),"type"in a&&(x.parameter(a.type,n,"invalid buffer type"),g=n[a.type]),"dimension"in a&&(x.type(a.dimension,"number","invalid dimension"),l=a.dimension|0),"length"in a&&(x.nni(c,"buffer length must be a nonnegative integer"),c=a.length|0));J.bind();e?M(J,e,b,g,l,L):(h.bufferData(J.type,c,b),J.dtype=g||5121,J.usage=b,J.dimension=l,J.byteLength=c);k.profile&&(J.stats.size=J.byteLength*z[J.dtype]);return q}function y(a,
b){x(b+a.byteLength<=J.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+a.byteLength+" starting from offset "+b+" to a buffer of size "+J.byteLength);h.bufferSubData(J.type,b,a)}u.bufferCount++;var J=new t(b);e[J.id]=J;H||q(a);q._reglType="buffer";q._buffer=J;q.subdata=function(a,b){var e=(b||0)|0,k;J.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var n=p.allocType(J.dtype,a.length);g(n,a);y(n,e);p.freeType(n)}else Array.isArray(a[0])||
f(a[0])?(k=A(a),n=C(a,k,J.dtype),y(n,e),p.freeType(n)):x.raise("invalid buffer data")}else if(f(a))y(a,e);else if(m(a)){k=a.shape;var t=a.stride,V=n=0,h=0,H=0;1===k.length?(n=k[0],V=1,h=t[0],H=0):2===k.length?(n=k[0],V=k[1],h=t[0],H=t[1]):x.raise("invalid shape");k=Array.isArray(a.data)?J.dtype:c(a.data);k=p.allocType(k,n*V);l(k,a.data,n,V,h,H,a.offset);y(k,e);p.freeType(k)}else x.raise("invalid data for buffer subdata");return q};k.profile&&(q.stats=J.stats);q.destroy=function(){B(J)};return q},
createStream:function(a,b){var e=H.pop();e||(e=new t(a));e.bind();M(e,b,35040,0,1,!1);return e},destroyStream:function(a){H.push(a)},clear:function(){a(e).forEach(B);H.forEach(B)},getBuffer:function(a){return a&&a._buffer instanceof t?a._buffer:null},restore:function(){a(e).forEach(function(a){a.buffer=h.createBuffer();h.bindBuffer(a.type,a.buffer);h.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:M}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,
"./util/check":21,"./util/flatten":25,"./util/is-ndarray":27,"./util/is-typed-array":28,"./util/pool":30,"./util/values":33}],4:[function(h,q,y){q.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(h,q,y){q.exports={int8:5120,int16:5122,int32:5124,
uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(h,q,y){q.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(h,q,y){q.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(h,q,y){function c(a){return Array.isArray(a)||A(a)||u(a)}function g(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function l(a,b,e,c){this.thisDep=a;this.contextDep=
b;this.propDep=e;this.append=c}function x(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function f(a){return new l(!1,!1,!1,a)}function m(a,b){var e=a.type;return 0===e?(e=a.data.length,new l(!0,1<=e,2<=e,b)):4===e?(e=a.data,new l(e.thisDep,e.contextDep,e.propDep,b)):new l(3===e,2===e,1===e,b)}var a=h("./util/check"),p=h("./util/codegen"),C=h("./util/loop"),A=h("./util/is-typed-array"),u=h("./util/is-ndarray"),n=h("./util/is-array-like"),O=h("./dynamic"),z=h("./constants/primitives.json"),G=
h("./constants/dtypes.json"),K=["x","y","z","w"],k="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),t={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},
L="constant color, constant alpha;one minus constant color, constant alpha;constant color, one minus constant alpha;one minus constant color, one minus constant alpha;constant alpha, constant color;constant alpha, one minus constant color;one minus constant alpha, constant color;one minus constant alpha, one minus constant color".split(";"),M={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,
always:519},B={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},b={frag:35632,vert:35633},e={cw:2304,ccw:2305},H=new l(!1,!1,!1,function(){});q.exports=function(h,u,q,A,S,y,J,ea,Y,U,I,sa,la,pa,xa){function ba(a){return a.replace(".","_")}function T(a,d,b){var e=ba(a);Ha.push(a);F[e]=v[e]=!!b;Ba[e]=d}function N(a,d,b){var e=ba(a);Ha.push(a);Array.isArray(b)?(v[e]=b.slice(),F[e]=b.slice()):v[e]=F[e]=b;Ca[e]=d}function Da(){var d=
p(),b=d.link,e=d.global;d.id=Pa++;d.batchId="0";var c=b(Na),f=d.shared={props:"a0"};Object.keys(Na).forEach(function(a){f[a]=e.def(c,".",a)});a.optional(function(){d.CHECK=b(a);d.commandStr=a.guessCommand();d.command=b(d.commandStr);d.assert=function(a,d,D){a("if(!(",d,"))",this.CHECK,".commandRaise(",b(D),",",this.command,");")};Ia.invalidBlendCombinations=L});var P=d.next={},g=d.current={};Object.keys(Ca).forEach(function(a){Array.isArray(v[a])&&(P[a]=e.def(f.next,".",a),g[a]=e.def(f.current,".",
a))});var Qa=d.constants={};Object.keys(Ia).forEach(function(a){Qa[a]=e.def(JSON.stringify(Ia[a]))});d.invoke=function(a,D){switch(D.type){case 0:var e=["this",f.context,f.props,d.batchId];return a.def(b(D.data),".call(",e.slice(0,Math.max(D.data.length+1,4)),")");case 1:return a.def(f.props,D.data);case 2:return a.def(f.context,D.data);case 3:return a.def("this",D.data);case 4:return D.data.append(d,a),D.data.ref}};d.attribCache={};var D={};d.scopeAttrib=function(a){a=u.id(a);if(a in D)return D[a];
var d=U.scope[a];d||(d=U.scope[a]=new ta);return D[a]=b(d)};return d}function ua(a){var d=a["static"];a=a.dynamic;var b;if("profile"in d){var e=!!d.profile;b=f(function(a,d){return e});b.enable=e}else if("profile"in a){var c=a.profile;b=m(c,function(a,d){return a.invoke(d,c)})}return b}function ya(d,b){var e=d["static"],c=d.dynamic;if("framebuffer"in e){var v=e.framebuffer;return v?(v=ea.getFramebuffer(v),a.command(v,"invalid framebuffer object"),f(function(a,d){var D=a.link(v),b=a.shared;d.set(b.framebuffer,
".next",D);b=b.context;d.set(b,".framebufferWidth",D+".width");d.set(b,".framebufferHeight",D+".height");return D})):f(function(a,d){var D=a.shared;d.set(D.framebuffer,".next","null");D=D.context;d.set(D,".framebufferWidth",D+".drawingBufferWidth");d.set(D,".framebufferHeight",D+".drawingBufferHeight");return"null"})}if("framebuffer"in c){var P=c.framebuffer;return m(P,function(d,b){var D=d.invoke(b,P),e=d.shared,Z=e.framebuffer,E=b.def(Z,".getFramebuffer(",D,")");a.optional(function(){d.assert(b,
"!"+D+"||"+E,"invalid framebuffer object")});b.set(Z,".next",E);e=e.context;b.set(e,".framebufferWidth",E+"?"+E+".width:"+e+".drawingBufferWidth");b.set(e,".framebufferHeight",E+"?"+E+".height:"+e+".drawingBufferHeight");return E})}return null}function ca(d,b,e){function c(d){if(d in f){var D=f[d];a.commandType(D,"object","invalid "+d,e.commandStr);var r=!0,Z=D.x|0,v=D.y|0,g,k;"width"in D?(g=D.width|0,a.command(0<=g,"invalid "+d,e.commandStr)):r=!1;"height"in D?(k=D.height|0,a.command(0<=k,"invalid "+
d,e.commandStr)):r=!1;return new l(!r&&b&&b.thisDep,!r&&b&&b.contextDep,!r&&b&&b.propDep,function(a,d){var b=a.shared.context,e=g;"width"in D||(e=d.def(b,".","framebufferWidth","-",Z));var r=k;"height"in D||(r=d.def(b,".","framebufferHeight","-",v));return[Z,v,e,r]})}if(d in P){var w=P[d],r=m(w,function(b,D){var e=b.invoke(D,w);a.optional(function(){b.assert(D,e+"&&typeof "+e+'==="object"',"invalid "+d)});var Z=b.shared.context,r=D.def(e,".x|0"),E=D.def(e,".y|0"),c=D.def('"width" in ',e,"?",e,".width|0:",
"(",Z,".","framebufferWidth","-",r,")"),f=D.def('"height" in ',e,"?",e,".height|0:","(",Z,".","framebufferHeight","-",E,")");a.optional(function(){b.assert(D,c+">=0&&"+f+">=0","invalid "+d)});return[r,E,c,f]});b&&(r.thisDep=r.thisDep||b.thisDep,r.contextDep=r.contextDep||b.contextDep,r.propDep=r.propDep||b.propDep);return r}return b?new l(b.thisDep,b.contextDep,b.propDep,function(a,d){var b=a.shared.context;return[0,0,d.def(b,".","framebufferWidth"),d.def(b,".","framebufferHeight")]}):null}var f=
d["static"],P=d.dynamic;if(d=c("viewport")){var v=d;d=new l(d.thisDep,d.contextDep,d.propDep,function(a,d){var b=v.append(a,d),e=a.shared.context;d.set(e,".viewportWidth",b[2]);d.set(e,".viewportHeight",b[3]);return b})}return{viewport:d,scissor_box:c("scissor.box")}}function ja(d){function e(d){if(d in c){var D=u.id(c[d]);a.optional(function(){I.shader(b[d],D,a.guessCommand())});var r=f(function(){return D});r.id=D;return r}if(d in v){var Z=v[d];return m(Z,function(D,e){var r=D.invoke(e,Z),E=e.def(D.shared.strings,
".id(",r,")");a.optional(function(){e(D.shared.shader,".shader(",b[d],",",E,",",D.command,");")});return E})}return null}var c=d["static"],v=d.dynamic,g=e("frag"),P=e("vert"),k=null;x(g)&&x(P)?(k=I.program(P.id,g.id),d=f(function(a,d){return a.link(k)})):d=new l(g&&g.thisDep||P&&P.thisDep,g&&g.contextDep||P&&P.contextDep,g&&g.propDep||P&&P.propDep,function(d,b){var e=d.shared.shader,Z;Z=g?g.append(d,b):b.def(e,".","frag");var r;r=P?P.append(d,b):b.def(e,".","vert");var E=e+".program("+r+","+Z;a.optional(function(){E+=
","+d.command});return b.def(E+")")});return{frag:g,vert:P,progVar:d,program:k}}function ma(d,b){function e(d,D){if(d in v){var r=v[d]|0;a.command(!D||0<=r,"invalid "+d,b.commandStr);return f(function(a,d){D&&(a.OFFSET=r);return r})}if(d in g){var Z=g[d];return m(Z,function(b,e){var r=b.invoke(e,Z);D&&(b.OFFSET=r,a.optional(function(){b.assert(e,r+">=0","invalid "+d)}));return r})}return D&&P?f(function(a,d){a.OFFSET="0";return 0}):null}var v=d["static"],g=d.dynamic,P=function(){if("elements"in v){var d=
v.elements;c(d)?d=y.getElements(y.create(d,!0)):d&&(d=y.getElements(d),a.command(d,"invalid elements",b.commandStr));var e=f(function(a,b){if(d){var e=a.link(d);return a.ELEMENTS=e}return a.ELEMENTS=null});e.value=d;return e}if("elements"in g){var r=g.elements;return m(r,function(d,b){var e=d.shared,D=e.isBufferArgs,e=e.elements,E=d.invoke(b,r),c=b.def("null"),D=b.def(D,"(",E,")"),f=d.cond(D).then(c,"=",e,".createStream(",E,");")["else"](c,"=",e,".getElements(",E,");");a.optional(function(){d.assert(f["else"],
"!"+E+"||"+c,"invalid elements")});b.entry(f);b.exit(d.cond(D).then(e,".destroyStream(",c,");"));return d.ELEMENTS=c})}return null}(),k=e("offset",!0);return{elements:P,primitive:function(){if("primitive"in v){var d=v.primitive;a.commandParameter(d,z,"invalid primitve",b.commandStr);return f(function(a,b){return z[d]})}if("primitive"in g){var e=g.primitive;return m(e,function(d,b){var r=d.constants.primTypes,E=d.invoke(b,e);a.optional(function(){d.assert(b,E+" in "+r,"invalid primitive, must be one of "+
Object.keys(z))});return b.def(r,"[",E,"]")})}return P?x(P)?P.value?f(function(a,d){return d.def(a.ELEMENTS,".primType")}):f(function(){return 4}):new l(P.thisDep,P.contextDep,P.propDep,function(a,d){var b=a.ELEMENTS;return d.def(b,"?",b,".primType:",4)}):null}(),count:function(){if("count"in v){var d=v.count|0;a.command("number"===typeof d&&0<=d,"invalid vertex count",b.commandStr);return f(function(){return d})}if("count"in g){var e=g.count;return m(e,function(d,b){var r=d.invoke(b,e);a.optional(function(){d.assert(b,
"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")});return r})}if(P){if(x(P)){if(P)return k?new l(k.thisDep,k.contextDep,k.propDep,function(d,b){var e=b.def(d.ELEMENTS,".vertCount-",d.OFFSET);a.optional(function(){d.assert(b,e+">=0","invalid vertex offset/element buffer too small")});return e}):f(function(a,d){return d.def(a.ELEMENTS,".vertCount")});var r=f(function(){return-1});a.optional(function(){r.MISSING=!0});return r}var Z=new l(P.thisDep||k.thisDep,P.contextDep||
k.contextDep,P.propDep||k.propDep,function(a,d){var b=a.ELEMENTS;return a.OFFSET?d.def(b,"?",b,".vertCount-",a.OFFSET,":-1"):d.def(b,"?",b,".vertCount:-1")});a.optional(function(){Z.DYNAMIC=!0});return Z}return null}(),instances:e("instances",!1),offset:k}}function na(d,b){var c=d["static"],v=d.dynamic,g={};Ha.forEach(function(d){function r(a,b){if(d in c){var e=a(c[d]);g[k]=f(function(){return e})}else if(d in v){var E=v[d];g[k]=m(E,function(a,d){return b(a,d,a.invoke(d,E))})}}var k=ba(d);switch(d){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return r(function(e){a.commandType(e,
"boolean",d,b.commandStr);return e},function(b,e,r){a.optional(function(){b.assert(e,"typeof "+r+'==="boolean"',"invalid flag "+d,b.commandStr)});return r});case "depth.func":return r(function(e){a.commandParameter(e,M,"invalid "+d,b.commandStr);return M[e]},function(b,e,r){var c=b.constants.compareFuncs;a.optional(function(){b.assert(e,r+" in "+c,"invalid "+d+", must be one of "+Object.keys(M))});return e.def(c,"[",r,"]")});case "depth.range":return r(function(d){a.command(n(d)&&2===d.length&&"number"===
typeof d[0]&&"number"===typeof d[1]&&d[0]<=d[1],"depth range is 2d array",b.commandStr);return d},function(d,b,e){a.optional(function(){d.assert(b,d.shared.isArrayLike+"("+e+")&&"+e+".length===2&&typeof "+e+'[0]==="number"&&typeof '+e+'[1]==="number"&&'+e+"[0]<="+e+"[1]","depth range must be a 2d array")});var r=b.def("+",e,"[0]"),c=b.def("+",e,"[1]");return[r,c]});case "blend.func":return r(function(d){a.commandType(d,"object","blend.func",b.commandStr);var e="srcRGB"in d?d.srcRGB:d.src,r="srcAlpha"in
d?d.srcAlpha:d.src,c="dstRGB"in d?d.dstRGB:d.dst;d="dstAlpha"in d?d.dstAlpha:d.dst;a.commandParameter(e,t,k+".srcRGB",b.commandStr);a.commandParameter(r,t,k+".srcAlpha",b.commandStr);a.commandParameter(c,t,k+".dstRGB",b.commandStr);a.commandParameter(d,t,k+".dstAlpha",b.commandStr);a.command(-1===L.indexOf(e+", "+c),"unallowed blending combination (srcRGB, dstRGB) = ("+e+", "+c+")",b.commandStr);return[t[e],t[c],t[r],t[d]]},function(b,e,r){function c(f,v){var g=e.def('"',f,v,'" in ',r,"?",r,".",f,
v,":",r,".",f);a.optional(function(){b.assert(e,g+" in "+E,"invalid "+d+"."+f+v+", must be one of "+Object.keys(t))});return g}var E=b.constants.blendFuncs;a.optional(function(){b.assert(e,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var f=c("src","RGB"),v=c("dst","RGB");a.optional(function(){b.assert(e,b.constants.invalidBlendCombinations+".indexOf("+f+'+", "+'+v+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var g=e.def(E,"[",f,"]"),k=e.def(E,"[",
c("src","Alpha"),"]"),m=e.def(E,"[",v,"]"),l=e.def(E,"[",c("dst","Alpha"),"]");return[g,m,k,l]});case "blend.equation":return r(function(e){if("string"===typeof e)return a.commandParameter(e,da,"invalid "+d,b.commandStr),[da[e],da[e]];if("object"===typeof e)return a.commandParameter(e.rgb,da,d+".rgb",b.commandStr),a.commandParameter(e.alpha,da,d+".alpha",b.commandStr),[da[e.rgb],da[e.alpha]];a.commandRaise("invalid blend.equation",b.commandStr)},function(b,e,r){var c=b.constants.blendEquations,E=
e.def(),f=e.def(),v=b.cond("typeof ",r,'==="string"');a.optional(function(){function a(d,e,r){b.assert(d,r+" in "+c,"invalid "+e+", must be one of "+Object.keys(da))}a(v.then,d,r);b.assert(v["else"],r+"&&typeof "+r+'==="object"',"invalid "+d);a(v["else"],d+".rgb",r+".rgb");a(v["else"],d+".alpha",r+".alpha")});v.then(E,"=",f,"=",c,"[",r,"];");v["else"](E,"=",c,"[",r,".rgb];",f,"=",c,"[",r,".alpha];");e(v);return[E,f]});case "blend.color":return r(function(d){a.command(n(d)&&4===d.length,"blend.color must be a 4d array",
b.commandStr);return C(4,function(a){return+d[a]})},function(d,b,e){a.optional(function(){d.assert(b,d.shared.isArrayLike+"("+e+")&&"+e+".length===4","blend.color must be a 4d array")});return C(4,function(d){return b.def("+",e,"[",d,"]")})});case "stencil.mask":return r(function(d){a.commandType(d,"number",k,b.commandStr);return d|0},function(d,b,e){a.optional(function(){d.assert(b,"typeof "+e+'==="number"',"invalid stencil.mask")});return b.def(e,"|0")});case "stencil.func":return r(function(e){a.commandType(e,
"object",k,b.commandStr);var r=e.cmp||"keep",c=e.ref||0;e="mask"in e?e.mask:-1;a.commandParameter(r,M,d+".cmp",b.commandStr);a.commandType(c,"number",d+".ref",b.commandStr);a.commandType(e,"number",d+".mask",b.commandStr);return[M[r],c,e]},function(d,b,e){var r=d.constants.compareFuncs;a.optional(function(){function a(){d.assert(b,Array.prototype.join.call(arguments,""),"invalid stencil.func")}a(e+"&&typeof ",e,'==="object"');a('!("cmp" in ',e,")||(",e,".cmp in ",r,")")});var c=b.def('"cmp" in ',
e,"?",r,"[",e,".cmp]",":",7680),E=b.def(e,".ref|0"),f=b.def('"mask" in ',e,"?",e,".mask|0:-1");return[c,E,f]});case "stencil.opFront":case "stencil.opBack":return r(function(e){a.commandType(e,"object",k,b.commandStr);var r=e.fail||"keep",c=e.zfail||"keep";e=e.zpass||"keep";a.commandParameter(r,B,d+".fail",b.commandStr);a.commandParameter(c,B,d+".zfail",b.commandStr);a.commandParameter(e,B,d+".zpass",b.commandStr);return["stencil.opBack"===d?1029:1028,B[r],B[c],B[e]]},function(b,e,r){function c(f){a.optional(function(){b.assert(e,
'!("'+f+'" in '+r+")||("+r+"."+f+" in "+E+")","invalid "+d+"."+f+", must be one of "+Object.keys(B))});return e.def('"',f,'" in ',r,"?",E,"[",r,".",f,"]:",7680)}var E=b.constants.stencilOps;a.optional(function(){b.assert(e,r+"&&typeof "+r+'==="object"',"invalid "+d)});return["stencil.opBack"===d?1029:1028,c("fail"),c("zfail"),c("zpass")]});case "polygonOffset.offset":return r(function(d){a.commandType(d,"object",k,b.commandStr);var e=d.factor|0;d=d.units|0;a.commandType(e,"number",k+".factor",b.commandStr);
a.commandType(d,"number",k+".units",b.commandStr);return[e,d]},function(b,e,r){a.optional(function(){b.assert(e,r+"&&typeof "+r+'==="object"',"invalid "+d)});var c=e.def(r,".factor|0"),E=e.def(r,".units|0");return[c,E]});case "cull.face":return r(function(d){var e=0;"front"===d?e=1028:"back"===d&&(e=1029);a.command(!!e,k,b.commandStr);return e},function(d,b,e){a.optional(function(){d.assert(b,e+'==="front"||'+e+'==="back"',"invalid cull.face")});return b.def(e,'==="front"?',1028,":",1029)});case "lineWidth":return r(function(d){a.command("number"===
typeof d&&d>=A.lineWidthDims[0]&&d<=A.lineWidthDims[1],"invalid line width, must positive number between "+A.lineWidthDims[0]+" and "+A.lineWidthDims[1],b.commandStr);return d},function(d,b,e){a.optional(function(){d.assert(b,"typeof "+e+'==="number"&&'+e+">="+A.lineWidthDims[0]+"&&"+e+"<="+A.lineWidthDims[1],"invalid line width")});return e});case "frontFace":return r(function(d){a.commandParameter(d,e,k,b.commandStr);return e[d]},function(d,b,e){a.optional(function(){d.assert(b,e+'==="cw"||'+e+
'==="ccw"',"invalid frontFace, must be one of cw,ccw")});return b.def(e+'==="cw"?2304:2305')});case "colorMask":return r(function(d){a.command(n(d)&&4===d.length,"color.mask must be length 4 array",b.commandStr);return d.map(function(d){return!!d})},function(d,b,e){a.optional(function(){d.assert(b,d.shared.isArrayLike+"("+e+")&&"+e+".length===4","invalid color.mask")});return C(4,function(d){return"!!"+e+"["+d+"]"})});case "sample.coverage":return r(function(d){a.command("object"===typeof d&&d,k,
b.commandStr);var e="value"in d?d.value:1;d=!!d.invert;a.command("number"===typeof e&&0<=e&&1>=e,"sample.coverage.value must be a number between 0 and 1",b.commandStr);return[e,d]},function(d,b,e){a.optional(function(){d.assert(b,e+"&&typeof "+e+'==="object"',"invalid sample.coverage")});var r=b.def('"value" in ',e,"?+",e,".value:1"),c=b.def("!!",e,".invert");return[r,c]})}});return g}function oa(d,b){var e=d["static"],c=d.dynamic,v={};Object.keys(e).forEach(function(d){var r=e[d],c;if("number"===
typeof r||"boolean"===typeof r)c=f(function(){return r});else if("function"===typeof r){var g=r._reglType;"texture2d"===g||"textureCube"===g?c=f(function(d){return d.link(r)}):"framebuffer"===g||"framebufferCube"===g?(a.command(0<r.color.length,'missing color attachment for framebuffer sent to uniform "'+d+'"',b.commandStr),c=f(function(d){return d.link(r.color[0])})):a.commandRaise('invalid data for uniform "'+d+'"',b.commandStr)}else n(r)?c=f(function(b){return b.global.def("[",C(r.length,function(e){a.command("number"===
typeof r[e]||"boolean"===typeof r[e],"invalid uniform "+d,b.commandStr);return r[e]}),"]")}):a.commandRaise('invalid or missing data for uniform "'+d+'"',b.commandStr);c.value=r;v[d]=c});Object.keys(c).forEach(function(d){var a=c[d];v[d]=m(a,function(d,b){return d.invoke(b,a)})});return v}function qa(b,e){var v=b["static"],g=b.dynamic,k={};Object.keys(v).forEach(function(b){var r=v[b],g=u.id(b),m=new ta;if(c(r))m.state=1,m.buffer=S.getBuffer(S.create(r,34962,!1,!0)),m.type=0;else{var l=S.getBuffer(r);
if(l)m.state=1,m.buffer=l,m.type=0;else if(a.command("object"===typeof r&&r,"invalid data for attribute "+b,e.commandStr),r.constant){var w=r.constant;m.buffer="null";m.state=2;"number"===typeof w?m.x=w:(a.command(n(w)&&0<w.length&&4>=w.length,"invalid constant for attribute "+b,e.commandStr),K.forEach(function(d,a){a<w.length&&(m[d]=w[a])}))}else{l=c(r.buffer)?S.getBuffer(S.create(r.buffer,34962,!1,!0)):S.getBuffer(r.buffer);a.command(!!l,'missing buffer for attribute "'+b+'"',e.commandStr);var x=
r.offset|0;a.command(0<=x,'invalid offset for attribute "'+b+'"',e.commandStr);var h=r.stride|0;a.command(0<=h&&256>h,'invalid stride for attribute "'+b+'", must be integer betweeen [0, 255]',e.commandStr);var t=r.size|0;a.command(!("size"in r)||0<t&&4>=t,'invalid size for attribute "'+b+'", must be 1,2,3,4',e.commandStr);var p=!!r.normalized,H=0;"type"in r&&(a.commandParameter(r.type,G,"invalid type for attribute "+b,e.commandStr),H=G[r.type]);var F=r.divisor|0;"divisor"in r&&(a.command(0===F||d,
'cannot specify divisor for attribute "'+b+'", instancing not supported',e.commandStr),a.command(0<=F,'invalid divisor for attribute "'+b+'"',e.commandStr));a.optional(function(){var d=e.commandStr,c="buffer offset divisor normalized type size stride".split(" ");Object.keys(r).forEach(function(e){a.command(0<=c.indexOf(e),'unknown parameter "'+e+'" for attribute pointer "'+b+'" (valid parameters are '+c+")",d)})});m.buffer=l;m.state=1;m.size=t;m.normalized=p;m.type=H||l.dtype;m.offset=x;m.stride=
h;m.divisor=F}}k[b]=f(function(d,a){var b=d.attribCache;if(g in b)return b[g];var e={isStream:!1};Object.keys(m).forEach(function(d){e[d]=m[d]});m.buffer&&(e.buffer=d.link(m.buffer),e.type=e.type||e.buffer+".dtype");return b[g]=e})});Object.keys(g).forEach(function(d){var b=g[d];k[d]=m(b,function(e,r){function c(d){r(k[d],"=",f,".",d,"|0;")}var f=e.invoke(r,b),E=e.shared,v=E.isBufferArgs,g=E.buffer;a.optional(function(){e.assert(r,f+"&&(typeof "+f+'==="object"||typeof '+f+'==="function")&&('+v+"("+
f+")||"+g+".getBuffer("+f+")||"+g+".getBuffer("+f+".buffer)||"+v+"("+f+'.buffer)||("constant" in '+f+"&&(typeof "+f+'.constant==="number"||'+E.isArrayLike+"("+f+".constant))))",'invalid dynamic attribute "'+d+'"')});var k={isStream:r.def(!1)},m=new ta;m.state=1;Object.keys(m).forEach(function(d){k[d]=r.def(""+m[d])});var l=k.buffer,w=k.type;r("if(",v,"(",f,")){",k.isStream,"=true;",l,"=",g,".createStream(",34962,",",f,");",w,"=",l,".dtype;","}else{",l,"=",g,".getBuffer(",f,");","if(",l,"){",w,"=",
l,".dtype;",'}else if("constant" in ',f,"){",k.state,"=",2,";","if(typeof "+f+'.constant === "number"){',k[K[0]],"=",f,".constant;",K.slice(1).map(function(d){return k[d]}).join("="),"=0;","}else{",K.map(function(d,a){return k[d]+"="+f+".constant.length>="+a+"?"+f+".constant["+a+"]:0;"}).join(""),"}}else{","if(",v,"(",f,".buffer)){",l,"=",g,".createStream(",34962,",",f,".buffer);","}else{",l,"=",g,".getBuffer(",f,".buffer);","}",w,'="type" in ',f,"?",E.glTypes,"[",f,".type]:",l,".dtype;",k.normalized,
"=!!",f,".normalized;");c("size");c("offset");c("stride");c("divisor");r("}}");r.exit("if(",k.isStream,"){",g,".destroyStream(",l,");","}");return k})});return k}function za(d){var a=d["static"],b=d.dynamic,e={};Object.keys(a).forEach(function(d){var b=a[d];e[d]=f(function(d,a){return"number"===typeof b||"boolean"===typeof b?""+b:d.link(b)})});Object.keys(b).forEach(function(d){var a=b[d];e[d]=m(a,function(d,b){return d.invoke(b,a)})});return e}function X(d,b,e,c,f){function v(d){var a=l[d];a&&(n[d]=
a)}var g=d["static"],k=d.dynamic;a.optional(function(){function d(e){Object.keys(e).forEach(function(d){a.command(0<=b.indexOf(d),'unknown parameter "'+d+'"',f.commandStr)})}var b="framebuffer vert frag elements primitive offset count instances profile".split(" ").concat(Ha);d(g);d(k)});var m=ya(d,f),l=ca(d,m,f),w=ma(d,f),n=na(d,f),x=ja(d,f);v("viewport");v(ba("scissor.box"));var h=0<Object.keys(n).length,m={framebuffer:m,draw:w,shader:x,state:n,dirty:h};m.profile=ua(d,f);m.uniforms=oa(e,f);m.attributes=
qa(b,f);m.context=za(c,f);return m}function Q(d,a,b){var e=d.shared.context,c=d.scope();Object.keys(b).forEach(function(f){a.save(e,"."+f);c(e,".",f,"=",b[f].append(d,a),";")});a(c)}function ga(d,a,b,e){var c=d.shared,f=c.gl,v=c.framebuffer,g;w&&(g=a.def(c.extensions,".webgl_draw_buffers"));var k=d.constants,c=k.drawBuffer,k=k.backBuffer;d=b?b.append(d,a):a.def(v,".next");e||a("if(",d,"!==",v,".cur){");a("if(",d,"){",f,".bindFramebuffer(",36160,",",d,".framebuffer);");w&&a(g,".drawBuffersWEBGL(",
c,"[",d,".colorAttachments.length]);");a("}else{",f,".bindFramebuffer(",36160,",null);");w&&a(g,".drawBuffersWEBGL(",k,");");a("}",v,".cur=",d,";");e||a("}")}function W(d,a,b){var e=d.shared,c=e.gl,f=d.current,g=d.next,k=e.current,m=e.next,l=d.cond(k,".dirty");Ha.forEach(function(a){a=ba(a);if(!(a in b.state)){var e,E;if(a in g){e=g[a];E=f[a];var w=C(v[a].length,function(d){return l.def(e,"[",d,"]")});l(d.cond(w.map(function(d,a){return d+"!=="+E+"["+a+"]"}).join("||")).then(c,".",Ca[a],"(",w,");",
w.map(function(d,a){return E+"["+a+"]="+d}).join(";"),";"))}else e=l.def(m,".",a),w=d.cond(e,"!==",k,".",a),l(w),a in Ba?w(d.cond(e).then(c,".enable(",Ba[a],");")["else"](c,".disable(",Ba[a],");"),k,".",a,"=",e,";"):w(c,".",Ca[a],"(",e,");",k,".",a,"=",e,";")}});0===Object.keys(b.state).length&&l(k,".dirty=false;");a(l)}function R(d,a,b,e){var c=d.shared,f=d.current,v=c.current,k=c.gl;g(Object.keys(b)).forEach(function(c){var g=b[c];if(!e||e(g)){var m=g.append(d,a);if(Ba[c]){var l=Ba[c];x(g)?m?a(k,
".enable(",l,");"):a(k,".disable(",l,");"):a(d.cond(m).then(k,".enable(",l,");")["else"](k,".disable(",l,");"));a(v,".",c,"=",m,";")}else if(n(m)){var w=f[c];a(k,".",Ca[c],"(",m,");",m.map(function(d,a){return w+"["+a+"]="+d}).join(";"),";")}else a(k,".",Ca[c],"(",m,");",v,".",c,"=",m,";")}})}function aa(a,b){d&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function fa(d,a,b,e,c){function f(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function g(d){h=
a.def();d(h,"=",f(),";");"string"===typeof c?d(l,".count+=",c,";"):d(l,".count++;");pa&&(e?(t=a.def(),d(t,"=",n,".getNumPendingQueries();")):d(n,".beginQuery(",l,");"))}function v(d){d(l,".cpuTime+=",f(),"-",h,";");pa&&(e?d(n,".pushScopeStats(",t,",",n,".getNumPendingQueries(),",l,");"):d(n,".endQuery();"))}function k(d){var b=a.def(w,".profile");a(w,".profile=",d,";");a.exit(w,".profile=",b,";")}var m=d.shared,l=d.stats,w=m.current,n=m.timer;b=b.profile;var h,t;if(b){if(x(b)){b.enable?(g(a),v(a.exit),
k("true")):k("false");return}b=b.append(d,a);k(b)}else b=a.def(w,".profile");m=d.block();g(m);a("if(",b,"){",m,"}");d=d.block();v(d);a.exit("if(",b,"){",d,"}")}function Aa(b,e,c,f,g){function v(d){switch(d){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function k(a,c,f){function g(){e("if(!",n,".buffer){",l,".enableVertexAttribArray(",w,");}");var a=f.type,v;v=f.size?e.def(f.size,"||",c):c;e("if(",n,
".type!==",a,"||",n,".size!==",v,"||",t.map(function(d){return n+"."+d+"!=="+f[d]}).join("||"),"){",l,".bindBuffer(",34962,",",x,".buffer);",l,".vertexAttribPointer(",[w,v,a,f.normalized,f.stride,f.offset],");",n,".type=",a,";",n,".size=",v,";",t.map(function(d){return n+"."+d+"="+f[d]+";"}).join(""),"}");d&&(a=f.divisor,e("if(",n,".divisor!==",a,"){",b.instancing,".vertexAttribDivisorANGLE(",[w,a],");",n,".divisor=",a,";}"))}function v(){e("if(",n,".buffer){",l,".disableVertexAttribArray(",w,");",
"}if(",K.map(function(d,a){return n+"."+d+"!=="+h[a]}).join("||"),"){",l,".vertexAttrib4f(",w,",",h,");",K.map(function(d,a){return n+"."+d+"="+h[a]+";"}).join(""),"}")}var l=m.gl,w=e.def(a,".location"),n=e.def(m.attributes,"[",w,"]");a=f.state;var x=f.buffer,h=[f.x,f.y,f.z,f.w],t=["buffer","normalized","offset","stride"];1===a?g():2===a?v():(e("if(",a,"===",1,"){"),g(),e("}else{"),v(),e("}"))}var m=b.shared;f.forEach(function(d){var f=d.name,m=c.attributes[f],l;if(m){if(!g(m))return;l=m.append(b,
e)}else{if(!g(H))return;var w=b.scopeAttrib(f);a.optional(function(){b.assert(e,w+".state","missing attribute "+f)});l={};Object.keys(new ta).forEach(function(d){l[d]=e.def(w,".",d)})}k(b.link(d),v(d.info.type),l)})}function ha(d,b,e,c,f){for(var v=d.shared,g=v.gl,k,m=0;m<c.length;++m){var l=c[m],w=l.name,h=l.info.type,t=e.uniforms[w],l=d.link(l)+".location",p;if(t){if(!f(t))continue;if(x(t)){var F=t.value;a.command(null!==F&&"undefined"!==typeof F,'missing uniform "'+w+'"',d.commandStr);if(35678===
h||35680===h)a.command("function"===typeof F&&(35678===h&&("texture2d"===F._reglType||"framebuffer"===F._reglType)||35680===h&&("textureCube"===F._reglType||"framebufferCube"===F._reglType)),"invalid texture for uniform "+w,d.commandStr),t=d.link(F._texture||F.color[0]._texture),b(g,".uniform1i(",l,",",t+".bind());"),b.exit(t,".unbind();");else if(35674===h||35675===h||35676===h){a.optional(function(){a.command(n(F),"invalid matrix for uniform "+w,d.commandStr);a.command(35674===h&&4===F.length||
35675===h&&9===F.length||35676===h&&16===F.length,"invalid length for matrix uniform "+w,d.commandStr)});var t=d.global.def("new Float32Array(["+Array.prototype.slice.call(F)+"])"),B=2;35675===h?B=3:35676===h&&(B=4);b(g,".uniformMatrix",B,"fv(",l,",false,",t,");")}else{switch(h){case 5126:a.commandType(F,"number","uniform "+w,d.commandStr);k="1f";break;case 35664:a.command(n(F)&&2===F.length,"uniform "+w,d.commandStr);k="2f";break;case 35665:a.command(n(F)&&3===F.length,"uniform "+w,d.commandStr);
k="3f";break;case 35666:a.command(n(F)&&4===F.length,"uniform "+w,d.commandStr);k="4f";break;case 35670:a.commandType(F,"boolean","uniform "+w,d.commandStr);k="1i";break;case 5124:a.commandType(F,"number","uniform "+w,d.commandStr);k="1i";break;case 35671:a.command(n(F)&&2===F.length,"uniform "+w,d.commandStr);k="2i";break;case 35667:a.command(n(F)&&2===F.length,"uniform "+w,d.commandStr);k="2i";break;case 35672:a.command(n(F)&&3===F.length,"uniform "+w,d.commandStr);k="3i";break;case 35668:a.command(n(F)&&
3===F.length,"uniform "+w,d.commandStr);k="3i";break;case 35673:a.command(n(F)&&4===F.length,"uniform "+w,d.commandStr);k="4i";break;case 35669:a.command(n(F)&&4===F.length,"uniform "+w,d.commandStr),k="4i"}b(g,".uniform",k,"(",l,",",n(F)?Array.prototype.slice.call(F):F,");")}continue}else p=t.append(d,b)}else{if(!f(H))continue;p=b.def(v.uniforms,"[",u.id(w),"]")}35678===h?b("if(",p,"&&",p,'._reglType==="framebuffer"){',p,"=",p,".color[0];","}"):35680===h&&b("if(",p,"&&",p,'._reglType==="framebufferCube"){',
p,"=",p,".color[0];","}");a.optional(function(){function a(e,c){d.assert(b,e,'bad data or missing for uniform "'+w+'".  '+c)}function e(d){a("typeof "+p+'==="'+d+'"',"invalid type, expected "+d)}function c(b,e){a(v.isArrayLike+"("+p+")&&"+p+".length==="+b,"invalid vector, should have length "+b,d.commandStr)}function f(b){a("typeof "+p+'==="function"&&'+p+'._reglType==="texture'+(3553===b?"2d":"Cube")+'"',"invalid texture type",d.commandStr)}switch(h){case 5124:e("number");break;case 35667:c(2,"number");
break;case 35668:c(3,"number");break;case 35669:c(4,"number");break;case 5126:e("number");break;case 35664:c(2,"number");break;case 35665:c(3,"number");break;case 35666:c(4,"number");break;case 35670:e("boolean");break;case 35671:c(2,"boolean");break;case 35672:c(3,"boolean");break;case 35673:c(4,"boolean");break;case 35674:c(4,"number");break;case 35675:c(9,"number");break;case 35676:c(16,"number");break;case 35678:f(3553);break;case 35680:f(34067)}});t=1;switch(h){case 35678:case 35680:t=b.def(p,
"._texture");b(g,".uniform1i(",l,",",t,".bind());");b.exit(t,".unbind();");continue;case 5124:case 35670:k="1i";break;case 35667:case 35671:k="2i";t=2;break;case 35668:case 35672:k="3i";t=3;break;case 35669:case 35673:k="4i";t=4;break;case 5126:k="1f";break;case 35664:k="2f";t=2;break;case 35665:k="3f";t=3;break;case 35666:k="4f";t=4;break;case 35674:k="Matrix2fv";break;case 35675:k="Matrix3fv";break;case 35676:k="Matrix4fv"}b(g,".uniform",k,"(",l,",");if("M"===k.charAt(0)){var l=Math.pow(h-35674+
2,2),U=d.global.def("new Float32Array(",l,")");b("false,(Array.isArray(",p,")||",p," instanceof Float32Array)?",p,":(",C(l,function(d){return U+"["+d+"]="+p+"["+d+"]"}),",",U,")")}else 1<t?b(C(t,function(d){return p+"["+d+"]"})):b(p);b(");")}}function va(b,e,c,f){function v(d){var a=n[d];return a?a.contextDep&&f.contextDynamic||a.propDep?a.append(b,c):a.append(b,e):e.def(w,".",d)}function k(){function d(){c(u,".drawElementsInstancedANGLE(",[t,p,B,F+"<<(("+B+"-5121)>>1)",H],");")}function a(){c(u,
".drawArraysInstancedANGLE(",[t,F,p,H],");")}h?U?d():(c("if(",h,"){"),d(),c("}else{"),a(),c("}")):a()}function g(){function d(){c(l+".drawElements("+[t,p,B,F+"<<(("+B+"-5121)>>1)"]+");")}function a(){c(l+".drawArrays("+[t,F,p]+");")}h?U?d():(c("if(",h,"){"),d(),c("}else{"),a(),c("}")):a()}var m=b.shared,l=m.gl,w=m.draw,n=f.draw,h=function(){var d=n.elements,a=e;if(d){if(d.contextDep&&f.contextDynamic||d.propDep)a=c;d=d.append(b,a)}else d=a.def(w,".","elements");d&&a("if("+d+")"+l+".bindBuffer(34963,"+
d+".buffer.buffer);");return d}(),t=v("primitive"),F=v("offset"),p=function(){var d=n.count,v,k=e;if(d){if(d.contextDep&&f.contextDynamic||d.propDep)k=c;v=d.append(b,k);a.optional(function(){d.MISSING&&b.assert(e,"false","missing vertex count");d.DYNAMIC&&b.assert(k,v+">=0","missing vertex count")})}else v=k.def(w,".","count"),a.optional(function(){b.assert(k,v+">=0","missing vertex count")});return v}();if("number"===typeof p){if(0===p)return}else c("if(",p,"){"),c.exit("}");var H,u;d&&(H=v("instances"),
u=b.instancing);var B=h+".type",U=n.elements&&x(n.elements);d&&("number"!==typeof H||0<=H)?"string"===typeof H?(c("if(",H,">0){"),k(),c("}else if(",H,"<0){"),g(),c("}")):k():g()}function Ea(b,e,c,f,v){var k=Da();v=k.proc("body",v);a.optional(function(){k.commandStr=e.commandStr;k.command=k.link(e.commandStr)});d&&(k.instancing=v.def(k.shared.extensions,".angle_instanced_arrays"));b(k,v,c,f);return k.compile().body}function Ga(d,a,b,e){aa(d,a);Aa(d,a,b,e.attributes,function(){return!0});ha(d,a,b,e.uniforms,
function(){return!0});va(d,a,a,b)}function Ja(d,a){var b=d.proc("draw",1);aa(d,b);Q(d,b,a.context);ga(d,b,a.framebuffer);W(d,b,a);R(d,b,a.state);fa(d,b,a,!1,!0);var e=a.shader.progVar.append(d,b);b(d.shared.gl,".useProgram(",e,".program);");if(a.shader.program)Ga(d,b,a,a.shader.program);else{var c=d.global.def("{}"),f=b.def(e,".id"),k=b.def(c,"[",f,"]");b(d.cond(k).then(k,".call(this,a0);")["else"](k,"=",c,"[",f,"]=",d.link(function(b){return Ea(Ga,d,a,b,1)}),"(",e,");",k,".call(this,a0);"))}0<Object.keys(a.state).length&&
b(d.shared.current,".dirty=true;")}function Fa(d,a,b,e){function c(){return!0}d.batchId="a1";aa(d,a);Aa(d,a,b,e.attributes,c);ha(d,a,b,e.uniforms,c);va(d,a,a,b)}function Ka(d,a,b,e){function c(d){return d.contextDep&&k||d.propDep}function f(d){return!c(d)}aa(d,a);var k=b.contextDep,v=a.def(),g=a.def();d.shared.props=g;d.batchId=v;var m=d.scope(),l=d.scope();a(m.entry,"for(",v,"=0;",v,"<","a1",";++",v,"){",g,"=","a0","[",v,"];",l,"}",m.exit);b.needsContext&&Q(d,l,b.context);b.needsFramebuffer&&ga(d,
l,b.framebuffer);R(d,l,b.state,c);b.profile&&c(b.profile)&&fa(d,l,b,!1,!0);e?(Aa(d,m,b,e.attributes,f),Aa(d,l,b,e.attributes,c),ha(d,m,b,e.uniforms,f),ha(d,l,b,e.uniforms,c),va(d,m,l,b)):(a=d.global.def("{}"),e=b.shader.progVar.append(d,l),g=l.def(e,".id"),m=l.def(a,"[",g,"]"),l(d.shared.gl,".useProgram(",e,".program);","if(!",m,"){",m,"=",a,"[",g,"]=",d.link(function(a){return Ea(Fa,d,b,a,2)}),"(",e,");}",m,".call(this,a0[",v,"],",v,");"))}function La(d,a){function b(d){return d.contextDep&&c||d.propDep}
var e=d.proc("batch",2);d.batchId="0";aa(d,e);var c=!1,f=!0;Object.keys(a.context).forEach(function(d){c=c||a.context[d].propDep});c||(Q(d,e,a.context),f=!1);var k=a.framebuffer,v=!1;k?(k.propDep?c=v=!0:k.contextDep&&c&&(v=!0),v||ga(d,e,k)):ga(d,e,null);a.state.viewport&&a.state.viewport.propDep&&(c=!0);W(d,e,a);R(d,e,a.state,function(d){return!b(d)});a.profile&&b(a.profile)||fa(d,e,a,!1,"a1");a.contextDep=c;a.needsContext=f;a.needsFramebuffer=v;f=a.shader.progVar;if(f.contextDep&&c||f.propDep)Ka(d,
e,a,null);else if(f=f.append(d,e),e(d.shared.gl,".useProgram(",f,".program);"),a.shader.program)Ka(d,e,a,a.shader.program);else{var k=d.global.def("{}"),v=e.def(f,".id"),g=e.def(k,"[",v,"]");e(d.cond(g).then(g,".call(this,a0,a1);")["else"](g,"=",k,"[",v,"]=",d.link(function(b){return Ea(Ka,d,a,b,2)}),"(",f,");",g,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&e(d.shared.current,".dirty=true;")}function Ma(d,a){function b(f){var k=a.shader[f];k&&e.set(c.shader,"."+f,k.append(d,e))}var e=d.proc("scope",
3);d.batchId="a2";var c=d.shared,f=c.current;Q(d,e,a.context);a.framebuffer&&a.framebuffer.append(d,e);g(Object.keys(a.state)).forEach(function(b){var f=a.state[b].append(d,e);n(f)?f.forEach(function(a,c){e.set(d.next[b],"["+c+"]",a)}):e.set(c.next,"."+b,f)});fa(d,e,a,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(b){var f=a.draw[b];f&&e.set(c.draw,"."+b,""+f.append(d,e))});Object.keys(a.uniforms).forEach(function(b){e.set(c.uniforms,"["+u.id(b)+"]",a.uniforms[b].append(d,
e))});Object.keys(a.attributes).forEach(function(b){var c=a.attributes[b].append(d,e),f=d.scopeAttrib(b);Object.keys(new ta).forEach(function(d){e.set(f,"."+d,c[d])})});b("vert");b("frag");0<Object.keys(a.state).length&&(e(f,".dirty=true;"),e.exit(f,".dirty=true;"));e("a1(",d.shared.context,",a0,",d.batchId,");")}function Oa(d){if("object"===typeof d&&!n(d)){for(var a=Object.keys(d),b=0;b<a.length;++b)if(O.isDynamic(d[a[b]]))return!0;return!1}}function wa(d,a,b){function e(d,a){k.forEach(function(b){var e=
c[b];O.isDynamic(e)&&(e=d.invoke(a,e),a(w,".",b,"=",e,";"))})}var c=a["static"][b];if(c&&Oa(c)){var f=d.global,k=Object.keys(c),v=!1,g=!1,l=!1,w=d.global.def("{}");k.forEach(function(a){var b=c[a];if(O.isDynamic(b))"function"===typeof b&&(b=c[a]=O.unbox(b)),a=m(b,null),v=v||a.thisDep,l=l||a.propDep,g=g||a.contextDep;else{f(w,".",a,"=");switch(typeof b){case "number":f(b);break;case "string":f('"',b,'"');break;case "object":Array.isArray(b)&&f("[",b.join(),"]");break;default:f(d.link(b))}f(";")}});
a.dynamic[b]=new O.DynamicVariable(4,{thisDep:v,contextDep:g,propDep:l,ref:w,append:e});delete a["static"][b]}}var ta=U.Record,da={add:32774,subtract:32778,"reverse subtract":32779};q.ext_blend_minmax&&(da.min=32775,da.max=32776);var d=q.angle_instanced_arrays,w=q.webgl_draw_buffers,v={dirty:!0,profile:xa.profile},F={},Ha=[],Ba={},Ca={};T("dither",3024);T("blend.enable",3042);N("blend.color","blendColor",[0,0,0,0]);N("blend.equation","blendEquationSeparate",[32774,32774]);N("blend.func","blendFuncSeparate",
[1,0,1,0]);T("depth.enable",2929,!0);N("depth.func","depthFunc",513);N("depth.range","depthRange",[0,1]);N("depth.mask","depthMask",!0);N("colorMask","colorMask",[!0,!0,!0,!0]);T("cull.enable",2884);N("cull.face","cullFace",1029);N("frontFace","frontFace",2305);N("lineWidth","lineWidth",1);T("polygonOffset.enable",32823);N("polygonOffset.offset","polygonOffset",[0,0]);T("sample.alpha",32926);T("sample.enable",32928);N("sample.coverage","sampleCoverage",[1,!1]);T("stencil.enable",2960);N("stencil.mask",
"stencilMask",-1);N("stencil.func","stencilFunc",[519,0,-1]);N("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);N("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);T("scissor.enable",3089);N("scissor.box","scissor",[0,0,h.drawingBufferWidth,h.drawingBufferHeight]);N("viewport","viewport",[0,0,h.drawingBufferWidth,h.drawingBufferHeight]);var Na={gl:h,context:la,strings:u,next:F,current:v,draw:sa,elements:y,buffer:S,shader:I,attributes:U.state,uniforms:Y,framebuffer:ea,extensions:q,
timer:pa,isBufferArgs:c},Ia={primTypes:z,compareFuncs:M,blendFuncs:t,blendEquations:da,stencilOps:B,glTypes:G,orientationType:e};a.optional(function(){Na.isArrayLike=n});w&&(Ia.backBuffer=[1029],Ia.drawBuffer=C(A.maxDrawbuffers,function(d){return 0===d?[0]:C(d,function(d){return 36064+d})}));var Pa=0;return{next:F,current:v,procs:function(){var d=Da(),a=d.proc("poll"),b=d.proc("refresh"),e=d.block();a(e);b(e);var c=d.shared,f=c.gl,k=c.next,g=c.current;e(g,".dirty=false;");ga(d,a);ga(d,b,null,!0);
var m=h.getExtension("angle_instanced_arrays"),l;m&&(l=d.link(m));for(var w=0;w<A.maxAttributes;++w){var t=b.def(c.attributes,"[",w,"]"),F=d.cond(t,".buffer");F.then(f,".enableVertexAttribArray(",w,");",f,".bindBuffer(",34962,",",t,".buffer.buffer);",f,".vertexAttribPointer(",w,",",t,".size,",t,".type,",t,".normalized,",t,".stride,",t,".offset);")["else"](f,".disableVertexAttribArray(",w,");",f,".vertexAttrib4f(",w,",",t,".x,",t,".y,",t,".z,",t,".w);",t,".buffer=null;");b(F);m&&b(l,".vertexAttribDivisorANGLE(",
w,",",t,".divisor);")}Object.keys(Ba).forEach(function(c){var v=Ba[c],m=e.def(k,".",c),l=d.block();l("if(",m,"){",f,".enable(",v,")}else{",f,".disable(",v,")}",g,".",c,"=",m,";");b(l);a("if(",m,"!==",g,".",c,"){",l,"}")});Object.keys(Ca).forEach(function(c){var m=Ca[c],l=v[c],w,t,h=d.block();h(f,".",m,"(");n(l)?(m=l.length,w=d.global.def(k,".",c),t=d.global.def(g,".",c),h(C(m,function(d){return w+"["+d+"]"}),");",C(m,function(d){return t+"["+d+"]="+w+"["+d+"];"}).join("")),a("if(",C(m,function(d){return w+
"["+d+"]!=="+t+"["+d+"]"}).join("||"),"){",h,"}")):(w=e.def(k,".",c),t=e.def(g,".",c),h(w,");",g,".",c,"=",w,";"),a("if(",w,"!==",t,"){",h,"}"));b(h)});return d.compile()}(),compile:function(d,a,b,e,c){var f=Da();f.stats=f.link(c);Object.keys(a["static"]).forEach(function(d){wa(f,a,d)});k.forEach(function(a){wa(f,d,a)});b=X(d,a,b,e,f);Ja(f,b);Ma(f,b);La(f,b);return f.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/check":21,"./util/codegen":23,"./util/is-array-like":26,
"./util/is-ndarray":27,"./util/is-typed-array":28,"./util/loop":29}],9:[function(h,q,y){function c(c,g){this.id=x++;this.type=c;this.data=g}function g(c){if(0===c.length)return[];var m=c.charAt(0),a=c.charAt(c.length-1);if(1<c.length&&m===a&&('"'===m||"'"===m))return['"'+c.substr(1,c.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(m=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(c))return g(c.substr(0,m.index)).concat(g(m[1])).concat(g(c.substr(m.index+m[0].length)));m=c.split(".");
if(1===m.length)return['"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];c=[];for(a=0;a<m.length;++a)c=c.concat(g(m[a]));return c}function l(c){return"["+g(c).join("][")+"]"}var x=0;q.exports={DynamicVariable:c,define:function(f,g){return new c(f,l(g+""))},isDynamic:function(f){return"function"===typeof f&&!f._reglType||f instanceof c},unbox:function(f,g){return"function"===typeof f?new c(0,f):f},accessor:l}},{}],10:[function(h,q,y){var c=h("./util/check"),g=h("./util/is-typed-array"),l=h("./util/is-ndarray"),
x=h("./util/values"),f=h("./constants/primitives.json"),m=h("./constants/usage.json");q.exports=function(a,h,C,A){function u(a){this.id=G++;z[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function n(f,k,m,n,b,e,x){f.buffer.bind();if(k){var u=x;x||g(k)&&(!l(k)||g(k.data))||(u=h.oes_element_index_uint?5125:5123);C._initBuffer(f.buffer,k,m,u,3)}else a.bufferData(34963,e,m),f.buffer.dtype=u||5121,f.buffer.usage=m,f.buffer.dimension=3,f.buffer.byteLength=e;u=x;if(!x){switch(f.buffer.dtype){case 5121:case 5120:u=
5121;break;case 5123:case 5122:u=5123;break;case 5125:case 5124:u=5125;break;default:c.raise("unsupported type for element array")}f.buffer.dtype=u}f.type=u;c(5125!==u||!!h.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");k=b;0>k&&(k=f.buffer.byteLength,5123===u?k>>=1:5125===u&&(k>>=2));f.vertCount=k;k=n;0>n&&(k=4,n=f.buffer.dimension,1===n&&(k=0),2===n&&(k=1),3===n&&(k=4));f.primType=k}function q(a){A.elementsCount--;c(null!==a.buffer,"must not double destroy elements");
delete z[a.id];a.buffer.destroy();a.buffer=null}var z={},G=0,K={uint8:5121,uint16:5123};h.oes_element_index_uint&&(K.uint32=5125);u.prototype.bind=function(){this.buffer.bind()};var k=[];return{create:function(a,k){function h(a){if(a)if("number"===typeof a)x(a),b.primType=4,b.vertCount=a|0,b.type=5121;else{var k=null,t=35044,p=-1,u=-1,C=0,q=0;if(Array.isArray(a)||g(a)||l(a))k=a;else if(c.type(a,"object","invalid arguments for elements"),"data"in a&&(k=a.data,c(Array.isArray(k)||g(k)||l(k),"invalid data for element buffer")),
"usage"in a&&(c.parameter(a.usage,m,"invalid element buffer usage"),t=m[a.usage]),"primitive"in a&&(c.parameter(a.primitive,f,"invalid element buffer primitive"),p=f[a.primitive]),"count"in a&&(c("number"===typeof a.count&&0<=a.count,"invalid vertex count for elements"),u=a.count|0),"type"in a&&(c.parameter(a.type,K,"invalid buffer type"),q=K[a.type]),"length"in a)C=a.length|0;else if(C=u,5123===q||5122===q)C*=2;else if(5125===q||5124===q)C*=4;n(b,k,t,p,u,C,q)}else x(),b.primType=4,b.vertCount=0,
b.type=5121;return h}var x=C.create(null,34963,!0),b=new u(x._buffer);A.elementsCount++;h(a);h._reglType="elements";h._elements=b;h.subdata=function(a,b){x.subdata(a,b);return h};h.destroy=function(){q(b)};return h},createStream:function(a){var c=k.pop();c||(c=new u(C.create(null,34963,!0,!1)._buffer));n(c,a,35040,-1,-1,0,0);return c},destroyStream:function(a){k.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof u?a._elements:null},clear:function(){x(z).forEach(q)}}}},
{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/check":21,"./util/is-ndarray":27,"./util/is-typed-array":28,"./util/values":33}],11:[function(h,q,y){var c=h("./util/check");q.exports=function(g,l){function h(a){c.type(a,"string","extension name must be string");a=a.toLowerCase();var m;try{m=f[a]=g.getExtension(a)}catch(l){}return!!m}for(var f={},m=0;m<l.extensions.length;++m){var a=l.extensions[m];if(!h(a))return l.onDestroy(),l.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),
null}l.optionalExtensions.forEach(h);return{extensions:f,restore:function(){Object.keys(f).forEach(function(a){if(!h(a))throw Error("(regl): error restoring extension "+a);})}}}},{"./util/check":21}],12:[function(h,q,y){var c=h("./util/check"),g=h("./util/values"),l=h("./util/extend"),x=[6408],f=[];f[6408]=4;var m=[];m[5121]=1;m[5126]=4;m[36193]=2;var a=[32854,32855,36194,35907,34842,34843,34836],p={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",
36061:"unsupported"};q.exports=function(h,q,u,n,O,z){function G(a,b,e){this.target=a;this.texture=b;this.renderbuffer=e;var c=a=0;b?(a=b.width,c=b.height):e&&(a=e.width,c=e.height);this.width=a;this.height=c}function K(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function k(a,b,e){if(a){if(a.texture){a=a.texture._texture;var f=Math.max(1,a.height);c(Math.max(1,a.width)===b&&f===e,"inconsistent width/height for supplied texture")}else a=a.renderbuffer._renderbuffer,
c(a.width===b&&a.height===e,"inconsistent width/height for renderbuffer");a.refCount+=1}}function t(a,b){b&&(b.texture?h.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):h.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer))}function L(a){var b=3553,e=null,f=null,k=a;"object"===typeof a&&(k=a.data,"target"in a&&(b=a.target|0));c.type(k,"function","invalid attachment data");a=k._reglType;"texture2d"===a?(e=k,c(3553===b)):"textureCube"===a?(e=k,c(34069<=
b&&34075>b,"invalid cube map target")):"renderbuffer"===a?(f=k,b=36161):c.raise("invalid regl object for attachment");return new G(b,e,f)}function M(a,b,e,c,f){if(e)return a=n.create2D({width:a,height:b,format:c,type:f}),a._texture.refCount=0,new G(3553,a,null);a=O.create({width:a,height:b,format:c});a._renderbuffer.refCount=0;return new G(36161,null,a)}function B(a){return a&&(a.texture||a.renderbuffer)}function b(a,b,e){a&&(a.texture?a.texture.resize(b,e):a.renderbuffer&&a.renderbuffer.resize(b,
e))}function e(){this.id=ea++;Y[this.id]=this;this.framebuffer=h.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function H(a){a.colorAttachments.forEach(K);K(a.depthAttachment);K(a.stencilAttachment);K(a.depthStencilAttachment)}function V(a){var b=a.framebuffer;c(b,"must not double destroy framebuffer");h.deleteFramebuffer(b);a.framebuffer=null;z.framebufferCount--;delete Y[a.id]}function y(a){var b;
h.bindFramebuffer(36160,a.framebuffer);var e=a.colorAttachments;for(b=0;b<e.length;++b)t(36064+b,e[b]);for(b=e.length;b<u.maxColorAttachments;++b)h.framebufferTexture2D(36160,36064+b,3553,null,0);h.framebufferTexture2D(36160,33306,3553,null,0);h.framebufferTexture2D(36160,36096,3553,null,0);h.framebufferTexture2D(36160,36128,3553,null,0);t(36096,a.depthAttachment);t(36128,a.stencilAttachment);t(33306,a.depthStencilAttachment);a=h.checkFramebufferStatus(36160);36053!==a&&c.raise("framebuffer configuration not supported, status = "+
p[a]);h.bindFramebuffer(36160,ka.next);ka.cur=ka.next;h.getError()}function ra(g,h){function n(b,e){var g;c(ka.next!==t,"can not update framebuffer which is currently in use");var l=q.webgl_draw_buffers,h=0,p=0,C=!0,G=!0;g=null;var z=!0,O="rgba",V="uint8",K=1,I=null,U=null,ra=null,ea=!1;if("number"===typeof b)h=b|0,p=e|0||h;else if(b){c.type(b,"object","invalid arguments for framebuffer");"shape"in b?(p=b.shape,c(Array.isArray(p)&&2<=p.length,"invalid shape for framebuffer"),h=p[0],p=p[1]):("radius"in
b&&(h=p=b.radius),"width"in b&&(h=b.width),"height"in b&&(p=b.height));if("color"in b||"colors"in b)g=b.color||b.colors,Array.isArray(g)&&c(1===g.length||l,"multiple render targets not supported");if(!g){"colorCount"in b&&(K=b.colorCount|0,c(0<K,"invalid color buffer count"));"colorTexture"in b&&(z=!!b.colorTexture,O="rgba4");if("colorType"in b){V=b.colorType;if(z)c(q.oes_texture_float||!("float"===V||"float32"===V),"you must enable OES_texture_float in order to use floating point framebuffer objects"),
c(q.oes_texture_half_float||!("half float"===V||"float16"===V),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects");else if("half float"===V||"float16"===V)c(q.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),O="rgba16f";else if("float"===V||"float32"===V)c(q.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),O="rgba32f";c.oneOf(V,
J,"invalid color type")}if("colorFormat"in b)if(O=b.colorFormat,0<=S.indexOf(O))z=!0;else if(0<=ia.indexOf(O))z=!1;else if(z)c.oneOf(b.colorFormat,S,"invalid color format for texture");else c.oneOf(b.colorFormat,ia,"invalid color format for renderbuffer")}if("depthTexture"in b||"depthStencilTexture"in b)ea=!(!b.depthTexture&&!b.depthStencilTexture),c(!ea||q.webgl_depth_texture,"webgl_depth_texture extension not supported");"depth"in b&&("boolean"===typeof b.depth?C=b.depth:(I=b.depth,G=!1));"stencil"in
b&&("boolean"===typeof b.stencil?G=b.stencil:(U=b.stencil,C=!1));"depthStencil"in b&&("boolean"===typeof b.depthStencil?C=G=b.depthStencil:(ra=b.depthStencil,G=C=!1))}else h=p=1;var Q=l=null,Y=null,W=null;if(Array.isArray(g))l=g.map(L);else if(g)l=[L(g)];else for(l=Array(K),g=0;g<K;++g)l[g]=M(h,p,z,O,V);c(q.webgl_draw_buffers||1>=l.length,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers.");c(l.length<=u.maxColorAttachments,"too many color attachments, not supported");
h=h||l[0].width;p=p||l[0].height;I?Q=L(I):C&&!G&&(Q=M(h,p,ea,"depth","uint32"));U?Y=L(U):G&&!C&&(Y=M(h,p,!1,"stencil","uint8"));ra?W=L(ra):!I&&!U&&G&&C&&(W=M(h,p,ea,"depth stencil","depth stencil"));c(1>=!!I+!!U+!!ra,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");C=null;for(g=0;g<l.length;++g)k(l[g],h,p),c(!l[g]||l[g].texture&&0<=x.indexOf(l[g].texture._texture.format)||l[g].renderbuffer&&0<=a.indexOf(l[g].renderbuffer._renderbuffer.format),"framebuffer color attachment "+
g+" is invalid"),l[g]&&l[g].texture&&(G=f[l[g].texture._texture.format]*m[l[g].texture._texture.type],null===C?C=G:c(C===G,"all color attachments much have the same number of bits per pixel."));k(Q,h,p);c(!Q||Q.texture&&6402===Q.texture._texture.format||Q.renderbuffer&&33189===Q.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object");k(Y,h,p);c(!Y||Y.renderbuffer&&36168===Y.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object");k(W,h,p);
c(!W||W.texture&&34041===W.texture._texture.format||W.renderbuffer&&34041===W.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object");H(t);t.width=h;t.height=p;t.colorAttachments=l;t.depthAttachment=Q;t.stencilAttachment=Y;t.depthStencilAttachment=W;n.color=l.map(B);n.depth=B(Q);n.stencil=B(Y);n.depthStencil=B(W);n.width=t.width;n.height=t.height;y(t);return n}var t=new e;z.framebufferCount++;n(g,h);return l(n,{resize:function(a,e){c(ka.next!==t,"can not resize a framebuffer which is currently in use");
var f=a|0,k=e|0||f;if(f===t.width&&k===t.height)return n;for(var g=t.colorAttachments,l=0;l<g.length;++l)b(g[l],f,k);b(t.depthAttachment,f,k);b(t.stencilAttachment,f,k);b(t.depthStencilAttachment,f,k);t.width=n.width=f;t.height=n.height=k;y(t);return n},_reglType:"framebuffer",_framebuffer:t,destroy:function(){V(t);H(t)},bind:function(a){ka.setFBO({framebuffer:n},a)}})}var ka={cur:null,next:null,dirty:!1,setFBO:null},S=["rgba"],ia=["rgba4","rgb565","rgb5 a1"];q.ext_srgb&&ia.push("srgba");q.ext_color_buffer_half_float&&
ia.push("rgba16f","rgb16f");q.webgl_color_buffer_float&&ia.push("rgba32f");var J=["uint8"];q.oes_texture_half_float&&J.push("half float","float16");q.oes_texture_float&&J.push("float","float32");var ea=0,Y={};return l(ka,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof e)?a:null},create:ra,createCube:function(a){function b(a){var f;c(0>e.indexOf(ka.next),"can not update framebuffer which is currently in use");var k=q.webgl_draw_buffers,
g={color:null},m=0,h=null;f="rgba";var t="uint8",p=1;if("number"===typeof a)m=a|0;else if(a){c.type(a,"object","invalid arguments for framebuffer");"shape"in a?(m=a.shape,c(Array.isArray(m)&&2<=m.length,"invalid shape for framebuffer"),c(m[0]===m[1],"cube framebuffer must be square"),m=m[0]):("radius"in a&&(m=a.radius|0),"width"in a?(m=a.width|0,"height"in a&&c(a.height===m,"must be square")):"height"in a&&(m=a.height|0));if("color"in a||"colors"in a)h=a.color||a.colors,Array.isArray(h)&&c(1===h.length||
k,"multiple render targets not supported");h||("colorCount"in a&&(p=a.colorCount|0,c(0<p,"invalid color buffer count")),"colorType"in a&&(c.oneOf(a.colorType,J,"invalid color type"),t=a.colorType),"colorFormat"in a&&(f=a.colorFormat,c.oneOf(a.colorFormat,S,"invalid color format for texture")));"depth"in a&&(g.depth=a.depth);"stencil"in a&&(g.stencil=a.stencil);"depthStencil"in a&&(g.depthStencil=a.depthStencil)}else m=1;if(h)if(Array.isArray(h))for(a=[],f=0;f<h.length;++f)a[f]=h[f];else a=[h];else for(a=
Array(p),h={radius:m,format:f,type:t},f=0;f<p;++f)a[f]=n.createCube(h);g.color=Array(a.length);for(f=0;f<a.length;++f)p=a[f],c("function"===typeof p&&"textureCube"===p._reglType,"invalid cube map"),m=m||p.width,c(p.width===m&&p.height===m,"invalid cube map shape"),g.color[f]={target:34069,data:a[f]};for(f=0;6>f;++f){for(p=0;p<a.length;++p)g.color[p].target=34069+f;0<f&&(g.depth=e[0].depth,g.stencil=e[0].stencil,g.depthStencil=e[0].depthStencil);if(e[f])e[f](g);else e[f]=ra(g)}return l(b,{width:m,
height:m,color:a})}var e=Array(6);b(a);return l(b,{faces:e,resize:function(a){var f=a|0;c(0<f&&f<=u.maxCubeMapSize,"invalid radius for cube fbo");if(f===b.width)return b;var k=b.color;for(a=0;a<k.length;++a)k[a].resize(f);for(a=0;6>a;++a)e[a].resize(f);b.width=b.height=f;return b},_reglType:"framebufferCube",destroy:function(){e.forEach(function(a){a.destroy()})}})},clear:function(){g(Y).forEach(V)},restore:function(){g(Y).forEach(function(a){a.framebuffer=h.createFramebuffer();y(a)})}})}},{"./util/check":21,
"./util/extend":24,"./util/values":33}],13:[function(h,q,y){q.exports=function(c,g){var l=1;g.ext_texture_filter_anisotropic&&(l=c.getParameter(34047));var h=1,f=1;g.webgl_draw_buffers&&(h=c.getParameter(34852),f=c.getParameter(36063));return{colorBits:[c.getParameter(3410),c.getParameter(3411),c.getParameter(3412),c.getParameter(3413)],depthBits:c.getParameter(3414),stencilBits:c.getParameter(3415),subpixelBits:c.getParameter(3408),extensions:Object.keys(g).filter(function(c){return!!g[c]}),maxAnisotropic:l,
maxDrawbuffers:h,maxColorAttachments:f,pointSizeDims:c.getParameter(33901),lineWidthDims:c.getParameter(33902),maxViewportDims:c.getParameter(3386),maxCombinedTextureUnits:c.getParameter(35661),maxCubeMapSize:c.getParameter(34076),maxRenderbufferSize:c.getParameter(34024),maxTextureUnits:c.getParameter(34930),maxTextureSize:c.getParameter(3379),maxAttributes:c.getParameter(34921),maxVertexUniforms:c.getParameter(36347),maxVertexTextureUnits:c.getParameter(35660),maxVaryingVectors:c.getParameter(36348),
maxFragmentUniforms:c.getParameter(36349),glsl:c.getParameter(35724),renderer:c.getParameter(7937),vendor:c.getParameter(7936),version:c.getParameter(7938)}}},{}],14:[function(h,q,y){var c=h("./util/check"),g=h("./util/is-typed-array");q.exports=function(l,h,f,m,a,p){function q(u){var n;null===h.next?(c(a.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),n=5121):(c(null!==h.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),
n=h.next.colorAttachments[0].texture._texture.type,p.oes_texture_float?c(5121===n||5126===n,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):c(5121===n,"Reading from a framebuffer is only allowed for the type 'uint8'"));var C=0,z=0,G=m.framebufferWidth,A=m.framebufferHeight,k=null;g(u)?k=u:u&&(c.type(u,"object","invalid arguments to regl.read()"),C=u.x|0,z=u.y|0,c(0<=C&&C<m.framebufferWidth,"invalid x offset for regl.read"),c(0<=z&&z<m.framebufferHeight,"invalid y offset for regl.read"),
G=(u.width||m.framebufferWidth-C)|0,A=(u.height||m.framebufferHeight-z)|0,k=u.data||null);k&&(5121===n?c(k instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===n&&c(k instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"));c(0<G&&G+C<=m.framebufferWidth,"invalid width for read pixels");c(0<A&&A+z<=m.framebufferHeight,"invalid height for read pixels");f();u=G*A*4;k||(5121===n?k=new Uint8Array(u):
5126===n&&(k=k||new Float32Array(u)));c.isTypedArray(k,"data buffer for regl.read() must be a typedarray");c(k.byteLength>=u,"data buffer for regl.read() too small");l.pixelStorei(3333,4);l.readPixels(C,z,G,A,6408,n,k);return k}function A(a){var c;h.setFBO({framebuffer:a.framebuffer},function(){c=q(a)});return c}return function(a){return a&&"framebuffer"in a?A(a):q(a)}}},{"./util/check":21,"./util/is-typed-array":28}],15:[function(h,q,y){var c=h("./util/check"),g=h("./util/values"),l=[];l[32854]=
2;l[32855]=2;l[36194]=2;l[33189]=2;l[36168]=1;l[34041]=4;l[35907]=4;l[34836]=16;l[34842]=8;l[34843]=6;q.exports=function(h,f,m,a,p){function q(a){this.id=O++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;p.profile&&(this.stats={size:0})}function A(f){var g=f.renderbuffer;c(g,"must not double destroy renderbuffer");h.bindRenderbuffer(36161,null);h.deleteRenderbuffer(g);f.renderbuffer=null;f.refCount=0;delete z[f.id];a.renderbufferCount--}var u={rgba4:32854,rgb565:36194,
"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};f.ext_srgb&&(u.srgba=35907);f.ext_color_buffer_half_float&&(u.rgba16f=34842,u.rgb16f=34843);f.webgl_color_buffer_float&&(u.rgba32f=34836);var n=[];Object.keys(u).forEach(function(a){n[u[a]]=a});var O=0,z={};q.prototype.decRef=function(){0>=--this.refCount&&A(this)};p.profile&&(a.getTotalRenderbufferSize=function(){var a=0;Object.keys(z).forEach(function(c){a+=z[c].stats.size});return a});return{create:function(f,g){function k(a,f){var g=
0,b=0,e=32854;"object"===typeof a&&a?("shape"in a?(b=a.shape,c(Array.isArray(b)&&2<=b.length,"invalid renderbuffer shape"),g=b[0]|0,b=b[1]|0):("radius"in a&&(g=b=a.radius|0),"width"in a&&(g=a.width|0),"height"in a&&(b=a.height|0)),"format"in a&&(c.parameter(a.format,u,"invalid renderbuffer format"),e=u[a.format])):"number"===typeof a?(g=a|0,b="number"===typeof f?f|0:g):a?c.raise("invalid arguments to renderbuffer constructor"):g=b=1;c(0<g&&0<b&&g<=m.maxRenderbufferSize&&b<=m.maxRenderbufferSize,"invalid renderbuffer size");
if(g!==t.width||b!==t.height||e!==t.format)return k.width=t.width=g,k.height=t.height=b,t.format=e,h.bindRenderbuffer(36161,t.renderbuffer),h.renderbufferStorage(36161,e,g,b),p.profile&&(t.stats.size=l[t.format]*t.width*t.height),k.format=n[t.format],k}var t=new q(h.createRenderbuffer());z[t.id]=t;a.renderbufferCount++;k(f,g);k.resize=function(a,f){var g=a|0,b=f|0||g;if(g===t.width&&b===t.height)return k;c(0<g&&0<b&&g<=m.maxRenderbufferSize&&b<=m.maxRenderbufferSize,"invalid renderbuffer size");k.width=
t.width=g;k.height=t.height=b;h.bindRenderbuffer(36161,t.renderbuffer);h.renderbufferStorage(36161,t.format,g,b);p.profile&&(t.stats.size=l[t.format]*t.width*t.height);return k};k._reglType="renderbuffer";k._renderbuffer=t;p.profile&&(k.stats=t.stats);k.destroy=function(){t.decRef()};return k},clear:function(){g(z).forEach(A)},restore:function(){g(z).forEach(function(a){a.renderbuffer=h.createRenderbuffer();h.bindRenderbuffer(36161,a.renderbuffer);h.renderbufferStorage(36161,a.format,a.width,a.height)});
h.bindRenderbuffer(36161,null)}}}},{"./util/check":21,"./util/values":33}],16:[function(h,q,y){var c=h("./util/check"),g=h("./util/values");q.exports=function(l,h,f,m){function a(a,c,f,g){this.name=a;this.id=c;this.location=f;this.info=g}function p(a,c){for(var f=0;f<a.length;++f)if(a[f].id===c.id){a[f].location=c.location;return}a.push(c)}function q(a,f,g){var m=35632===a?n:O,p=m[f];if(!p){var b=h.str(f),p=l.createShader(a);l.shaderSource(p,b);l.compileShader(p);c.shaderError(l,p,b,a,g);m[f]=p}return p}
function A(a,c){this.id=y++;this.fragId=a;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[];m.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(f,g){var n,u;n=q(35632,f.fragId);u=q(35633,f.vertId);var z=f.program=l.createProgram();l.attachShader(z,n);l.attachShader(z,u);l.linkProgram(z);c.linkError(l,z,h.str(f.fragId),h.str(f.vertId),g);var b=l.getProgramParameter(z,35718);m.profile&&(f.stats.uniformsCount=b);var e=f.uniforms;for(n=0;n<b;++n)if(u=l.getActiveUniform(z,
n))if(1<u.size)for(var H=0;H<u.size;++H){var V=u.name.replace("[0]","["+H+"]");p(e,new a(V,h.id(V),l.getUniformLocation(z,V),u))}else p(e,new a(u.name,h.id(u.name),l.getUniformLocation(z,u.name),u));b=l.getProgramParameter(z,35721);m.profile&&(f.stats.attributesCount=b);e=f.attributes;for(n=0;n<b;++n)(u=l.getActiveAttrib(z,n))&&p(e,new a(u.name,h.id(u.name),l.getAttribLocation(z,u.name),u))}var n={},O={},z={},G=[],y=0;m.profile&&(f.getMaxUniformsCount=function(){var a=0;G.forEach(function(c){c.stats.uniformsCount>
a&&(a=c.stats.uniformsCount)});return a},f.getMaxAttributesCount=function(){var a=0;G.forEach(function(c){c.stats.attributesCount>a&&(a=c.stats.attributesCount)});return a});return{clear:function(){var a=l.deleteShader.bind(l);g(n).forEach(a);n={};g(O).forEach(a);O={};G.forEach(function(a){l.deleteProgram(a.program)});G.length=0;z={};f.shaderCount=0},program:function(a,g,m){c.command(0<=a,"missing vertex shader",m);c.command(0<=g,"missing fragment shader",m);var l=z[g];l||(l=z[g]={});var h=l[a];h||
(h=new A(g,a),f.shaderCount++,u(h,m),l[a]=h,G.push(h));return h},restore:function(){n={};O={};for(var a=0;a<G.length;++a)u(G[a])},shader:q,frag:-1,vert:-1}}},{"./util/check":21,"./util/values":33}],17:[function(h,q,y){q.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(h,q,y){q.exports=function(){var c={"":0},g=[""];return{id:function(l){var h=c[l];if(h)return h;h=c[l]=g.length;
g.push(l);return h},str:function(c){return g[c]}}}},{}],19:[function(h,q,y){function c(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function g(a){return Array.isArray(a)&&0!==a.length&&z(a[0])?!0:!1}function l(a){return Object.prototype.toString.call(a)}function x(a){if(!a)return!1;var b=l(a);return 0<=M.indexOf(b)?!0:c(a)||g(a)||u(a)}function f(a,b){36193===a.type?(a.data=O(b),n.freeType(b)):a.data=b}function m(a,c,f,g,k,m){a="undefined"!==typeof b[a]?b[a]:L[a]*B[c];m&&(a*=
6);if(k){for(g=0;1<=f;)g+=a*f*f,f/=2;return g}return a*f*g}var a=h("./util/check"),p=h("./util/extend"),C=h("./util/values"),A=h("./util/is-typed-array"),u=h("./util/is-ndarray"),n=h("./util/pool"),O=h("./util/to-half-float"),z=h("./util/is-array-like"),G=h("./util/flatten");y=h("./constants/arraytypes.json");var K=h("./constants/arraytypes.json"),k=[9984,9986,9985,9987],t=[0,6409,6410,6407,6408],L={};L[6409]=L[6406]=L[6402]=1;L[34041]=L[6410]=2;L[6407]=L[35904]=3;L[6408]=L[35906]=4;var M=Object.keys(y).concat(["[object HTMLCanvasElement]",
"[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),B=[];B[5121]=1;B[5126]=4;B[36193]=2;B[5123]=2;B[5125]=4;var b=[];b[32854]=2;b[32855]=2;b[36194]=2;b[34041]=4;b[33776]=.5;b[33777]=.5;b[33778]=1;b[33779]=1;b[35986]=.5;b[35987]=1;b[34798]=1;b[35840]=.5;b[35841]=.25;b[35842]=.5;b[35843]=.25;b[36196]=.5;q.exports=function(b,h,q,B,y,M,S){function ia(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=
1;this.channels=this.height=this.width=this.colorSpace=0}function J(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function ea(d,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.type(b.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),d.premultiplyAlpha=b.premultiplyAlpha);
"flipY"in b&&(a.type(b.flipY,"boolean","invalid texture flip"),d.flipY=b.flipY);"alignment"in b&&(a.oneOf(b.alignment,[1,2,4,8],"invalid texture unpack alignment"),d.unpackAlignment=b.alignment);"colorSpace"in b&&(a.parameter(b.colorSpace,W,"invalid colorSpace"),d.colorSpace=W[b.colorSpace]);if("type"in b){var e=b.type;a(h.oes_texture_float||!("float"===e||"float32"===e),"you must enable the OES_texture_float extension in order to use floating point textures.");a(h.oes_texture_half_float||!("half float"===
e||"float16"===e),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures.");a(h.webgl_depth_texture||!("uint16"===e||"uint32"===e||"depth stencil"===e),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures.");a.parameter(e,R,"invalid texture type");d.type=R[e]}var c=d.width,f=d.height,g=d.channels,e=!1;"shape"in b?(a(Array.isArray(b.shape)&&2<=b.shape.length,"shape must be an array"),c=b.shape[0],f=b.shape[1],3===b.shape.length&&
(g=b.shape[2],a(0<g&&4>=g,"invalid number of channels"),e=!0),a(0<=c&&c<=q.maxTextureSize,"invalid width"),a(0<=f&&f<=q.maxTextureSize,"invalid height")):("radius"in b&&(c=f=b.radius,a(0<=c&&c<=q.maxTextureSize,"invalid radius")),"width"in b&&(c=b.width,a(0<=c&&c<=q.maxTextureSize,"invalid width")),"height"in b&&(f=b.height,a(0<=f&&f<=q.maxTextureSize,"invalid height")),"channels"in b&&(g=b.channels,a(0<g&&4>=g,"invalid number of channels"),e=!0));d.width=c|0;d.height=f|0;d.channels=g|0;c=!1;"format"in
b&&(c=b.format,a(h.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),a.parameter(c,aa,"invalid texture format"),f=d.internalformat=aa[c],d.format=Ka[f],c in R&&!("type"in b)&&(d.type=R[c]),c in fa&&(d.compressed=!0),c=!0);!e&&c?d.channels=L[d.format]:e&&!c?d.channels!==t[d.format]&&(d.format=d.internalformat=t[d.channels]):c&&e&&a(d.channels===L[d.format],"number of channels inconsistent with specified format")}}
function Y(a){b.pixelStorei(37440,a.flipY);b.pixelStorei(37441,a.premultiplyAlpha);b.pixelStorei(37443,a.colorSpace);b.pixelStorei(3317,a.unpackAlignment)}function U(){ia.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function I(d,b){var e=null;x(b)?e=b:b&&(a.type(b,"object","invalid pixel data type"),ea(d,b),"x"in b&&(d.xOffset=b.x|0),"y"in b&&(d.yOffset=b.y|0),x(b.data)&&(e=b.data));a(!d.compressed||e instanceof Uint8Array,"compressed texture data must be stored in a uint8array");
if(b.copy){a(!e,"can not specify copy and data field for the same texture");var k=y.viewportWidth,h=y.viewportHeight;d.width=d.width||k-d.xOffset;d.height=d.height||h-d.yOffset;d.needsCopy=!0;a(0<=d.xOffset&&d.xOffset<k&&0<=d.yOffset&&d.yOffset<h&&0<d.width&&d.width<=k&&0<d.height&&d.height<=h,"copy texture read out of bounds")}else if(!e)d.width=d.width||1,d.height=d.height||1,d.channels=d.channels||4;else if(A(e))d.channels=d.channels||4,d.data=e,"type"in b||5121!==d.type||(d.type=K[Object.prototype.toString.call(e)]|
0);else if(c(e)){d.channels=d.channels||4;k=e;h=k.length;switch(d.type){case 5121:case 5123:case 5125:case 5126:h=n.allocType(d.type,h);h.set(k);d.data=h;break;case 36193:d.data=O(k);break;default:a.raise("unsupported texture type, must specify a typed array")}d.alignment=1;d.needsFree=!0}else if(u(e)){k=e.data;Array.isArray(k)||5121!==d.type||(d.type=K[Object.prototype.toString.call(k)]|0);var h=e.shape,m=e.stride,p,C,H,B;3===h.length?(H=h[2],B=m[2]):(a(2===h.length,"invalid ndarray pixel data, must be 2 or 3D"),
B=H=1);p=h[0];C=h[1];h=m[0];m=m[1];d.alignment=1;d.width=p;d.height=C;d.channels=H;d.format=d.internalformat=t[H];d.needsFree=!0;p=B;e=e.offset;H=d.width;B=d.height;C=d.channels;for(var r=n.allocType(36193===d.type?5126:d.type,H*B*C),E=0,J=0;J<B;++J)for(var M=0;M<H;++M)for(var S=0;S<C;++S)r[E++]=k[h*M+m*J+p*S+e];f(d,r)}else if("[object HTMLCanvasElement]"===l(e)||"[object CanvasRenderingContext2D]"===l(e))"[object HTMLCanvasElement]"===l(e)?d.element=e:d.element=e.canvas,d.width=d.element.width,d.height=
d.element.height,d.channels=4;else if("[object HTMLImageElement]"===l(e))d.element=e,d.width=e.naturalWidth,d.height=e.naturalHeight,d.channels=4;else if("[object HTMLVideoElement]"===l(e))d.element=e,d.width=e.videoWidth,d.height=e.videoHeight,d.channels=4;else if(g(e)){k=d.width||e[0].length;h=d.height||e.length;m=d.channels;m=z(e[0][0])?m||e[0][0].length:m||1;p=G.shape(e);H=1;for(B=0;B<p.length;++B)H*=p[B];H=n.allocType(36193===d.type?5126:d.type,H);G.flatten(e,p,"",H);f(d,H);d.alignment=1;d.width=
k;d.height=h;d.channels=m;d.format=d.internalformat=t[m];d.needsFree=!0}5126===d.type?a(0<=q.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):36193===d.type&&a(0<=q.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}function sa(a,c,f,g,k){var h=a.element,m=a.data,l=a.internalformat,n=a.format,p=a.type,r=a.width,t=a.height;Y(a);h?b.texSubImage2D(c,k,f,g,n,p,h):a.compressed?b.compressedTexSubImage2D(c,k,f,g,l,r,t,m):a.needsCopy?
(B(),b.copyTexSubImage2D(c,k,f,g,a.xOffset,a.yOffset,r,t)):b.texSubImage2D(c,k,f,g,r,t,n,p,m)}function la(){return La.pop()||new U}function pa(a){a.needsFree&&n.freeType(a.data);U.call(a);La.push(a)}function xa(){ia.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function ba(a,b,e){var c=a.images[0]=la();a.mipmask=1;c.width=a.width=b;c.height=a.height=e;c.channels=a.channels=4}function T(d,b){var e=null;if(x(b))e=d.images[0]=la(),J(e,d),I(e,b),d.mipmask=1;else if(ea(d,
b),Array.isArray(b.mipmap))for(var c=b.mipmap,f=0;f<c.length;++f)e=d.images[f]=la(),J(e,d),e.width>>=f,e.height>>=f,I(e,c[f]),d.mipmask|=1<<f;else e=d.images[0]=la(),J(e,d),I(e,b),d.mipmask=1;J(d,d.images[0]);(d.compressed&&33776===d.internalformat||33777===d.internalformat||33778===d.internalformat||33779===d.internalformat)&&a(0===d.width%4&&0===d.height%4,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function N(a,c){for(var f=a.images,g=0;g<
f.length&&f[g];++g){var k=f[g],h=c,m=g,l=k.element,n=k.data,p=k.internalformat,r=k.format,t=k.type,u=k.width,q=k.height;Y(k);l?b.texImage2D(h,m,r,r,t,l):k.compressed?b.compressedTexImage2D(h,m,p,u,q,0,n):k.needsCopy?(B(),b.copyTexImage2D(h,m,r,k.xOffset,k.yOffset,u,q,0)):b.texImage2D(h,m,r,u,q,0,r,t,n)}}function Da(){var a=Ma.pop()||new xa;ia.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ua(a){for(var b=a.images,e=0;e<b.length;++e)b[e]&&pa(b[e]),b[e]=null;Ma.push(a)}function ya(){this.magFilter=
this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ca(b,e){if("min"in e){var c=e.min;a.parameter(c,ga);b.minFilter=ga[c];0<=k.indexOf(b.minFilter)&&(b.genMipmaps=!0)}"mag"in e&&(c=e.mag,a.parameter(c,Q),b.magFilter=Q[c]);var c=b.wrapS,f=b.wrapT;if("wrap"in e){var g=e.wrap;"string"===typeof g?(a.parameter(g,X),c=f=X[g]):Array.isArray(g)&&(a.parameter(g[0],X),a.parameter(g[1],X),c=X[g[0]],f=X[g[1]])}else"wrapS"in e&&(c=e.wrapS,a.parameter(c,
X),c=X[c]),"wrapT"in e&&(f=e.wrapT,a.parameter(f,X),f=X[f]);b.wrapS=c;b.wrapT=f;"anisotropic"in e&&(c=e.anisotropic,a("number"===typeof c&&1<=c&&c<=q.maxAnisotropic,"aniso samples must be between 1 and "),b.anisotropic=e.anisotropic);if("mipmap"in e){c=!1;switch(typeof e.mipmap){case "string":a.parameter(e.mipmap,za,"invalid mipmap hint");b.mipmapHint=za[e.mipmap];c=b.genMipmaps=!0;break;case "boolean":c=b.genMipmaps=e.mipmap;break;case "object":a(Array.isArray(e.mipmap),"invalid mipmap type");b.genMipmaps=
!1;c=!0;break;default:a.raise("invalid mipmap type")}!c||"min"in e||(b.minFilter=9984)}}function ja(a,c){b.texParameteri(c,10241,a.minFilter);b.texParameteri(c,10240,a.magFilter);b.texParameteri(c,10242,a.wrapS);b.texParameteri(c,10243,a.wrapT);h.ext_texture_filter_anisotropic&&b.texParameteri(c,34046,a.anisotropic);a.genMipmaps&&(b.hint(33170,a.mipmapHint),b.generateMipmap(c))}function ma(a){ia.call(this);this.mipmask=0;this.internalformat=6408;this.id=Oa++;this.refCount=1;this.target=a;this.texture=
b.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new ya;S.profile&&(this.stats={size:0})}function na(a){b.activeTexture(33984);b.bindTexture(a.target,a.texture)}function oa(){var a=da[0];a?b.bindTexture(a.target,a.texture):b.bindTexture(3553,null)}function qa(d){var c=d.texture;a(c,"must not double destroy texture");var f=d.unit,g=d.target;0<=f&&(b.activeTexture(33984+f),b.bindTexture(g,null),da[f]=null);b.deleteTexture(c);d.texture=null;d.params=null;d.pixels=null;d.refCount=0;delete wa[d.id];
M.textureCount--}var za={"don't care":4352,"dont care":4352,nice:4354,fast:4353},X={repeat:10497,clamp:33071,mirror:33648},Q={nearest:9728,linear:9729},ga=p({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Q),W={none:0,browser:37444},R={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},aa={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},fa={};h.ext_srgb&&
(aa.srgb=35904,aa.srgba=35906);h.oes_texture_float&&(R.float32=R["float"]=5126);h.oes_texture_half_float&&(R.float16=R["half float"]=36193);h.webgl_depth_texture&&(p(aa,{depth:6402,"depth stencil":34041}),p(R,{uint16:5123,uint32:5125,"depth stencil":34042}));h.webgl_compressed_texture_s3tc&&p(fa,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});h.webgl_compressed_texture_atc&&p(fa,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});
h.webgl_compressed_texture_pvrtc&&p(fa,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});h.webgl_compressed_texture_etc1&&(fa["rgb etc1"]=36196);var Aa=Array.prototype.slice.call(b.getParameter(34467));Object.keys(fa).forEach(function(a){var b=fa[a];0<=Aa.indexOf(b)&&(aa[a]=b)});var ha=Object.keys(aa);q.textureFormats=ha;var va=[];Object.keys(aa).forEach(function(a){va[aa[a]]=a});var Ea=[];Object.keys(R).forEach(function(a){Ea[R[a]]=a});var Ga=
[];Object.keys(Q).forEach(function(a){Ga[Q[a]]=a});var Ja=[];Object.keys(ga).forEach(function(a){Ja[ga[a]]=a});var Fa=[];Object.keys(X).forEach(function(a){Fa[X[a]]=a});var Ka=ha.reduce(function(a,b){var e=aa[b];6409===e||6406===e||6409===e||6410===e||6402===e||34041===e?a[e]=e:32855===e||0<=b.indexOf("rgba")?a[e]=6408:a[e]=6407;return a},{}),La=[],Ma=[],Oa=0,wa={},ta=q.maxTextureUnits,da=Array(ta).map(function(){return null});p(ma.prototype,{bind:function(){this.bindCount+=1;var d=this.unit;if(0>
d){for(var c=0;c<ta;++c){var f=da[c];if(f){if(0<f.bindCount)continue;f.unit=-1}da[c]=this;d=c;break}d>=ta&&a.raise("insufficient number of texture units");S.profile&&M.maxTextureUnits<d+1&&(M.maxTextureUnits=d+1);this.unit=d;b.activeTexture(33984+d);b.bindTexture(this.target,this.texture)}return d},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&qa(this)}});S.profile&&(M.getTotalTextureSize=function(){var a=0;Object.keys(wa).forEach(function(b){a+=wa[b].stats.size});return a});
return{create2D:function(d,c){function f(b,d){var e=g.texInfo;ya.call(e);var c=Da();"number"===typeof b?"number"===typeof d?ba(c,b|0,d|0):ba(c,b|0,b|0):b?(a.type(b,"object","invalid arguments to regl.texture"),ca(e,b),T(c,b)):ba(c,1,1);e.genMipmaps&&(c.mipmask=(c.width<<1)-1);g.mipmask=c.mipmask;J(g,c);a.texture2D(e,c,q);g.internalformat=c.internalformat;f.width=c.width;f.height=c.height;na(g);N(c,3553);ja(e,3553);oa();ua(c);S.profile&&(g.stats.size=m(g.internalformat,g.type,c.width,c.height,e.genMipmaps,
!1));f.format=va[g.internalformat];f.type=Ea[g.type];f.mag=Ga[e.magFilter];f.min=Ja[e.minFilter];f.wrapS=Fa[e.wrapS];f.wrapT=Fa[e.wrapT];return f}var g=new ma(3553);wa[g.id]=g;M.textureCount++;f(d,c);f.subimage=function(b,d,e,c){a(!!b,"must specify image data");d|=0;e|=0;c|=0;var k=la();J(k,g);k.width=0;k.height=0;I(k,b);k.width=k.width||(g.width>>c)-d;k.height=k.height||(g.height>>c)-e;a(g.type===k.type&&g.format===k.format&&g.internalformat===k.internalformat,"incompatible format for texture.subimage");
a(0<=d&&0<=e&&d+k.width<=g.width&&e+k.height<=g.height,"texture.subimage write out of bounds");a(g.mipmask&1<<c,"missing mipmap data");a(k.data||k.element||k.needsCopy,"missing image data");na(g);sa(k,3553,d,e,c);oa();pa(k);return f};f.resize=function(a,d){var c=a|0,k=d|0||c;if(c===g.width&&k===g.height)return f;f.width=g.width=c;f.height=g.height=k;na(g);for(var h=0;g.mipmask>>h;++h)b.texImage2D(3553,h,g.format,c>>h,k>>h,0,g.format,g.type,null);oa();S.profile&&(g.stats.size=m(g.internalformat,g.type,
c,k,!1,!1));return f};f._reglType="texture2d";f._texture=g;S.profile&&(f.stats=g.stats);f.destroy=function(){g.decRef()};return f},createCube:function(d,c,f,g,k,h){function l(b,d,e,c,f,g){var k,h=n.texInfo;ya.call(h);for(k=0;6>k;++k)p[k]=Da();if("number"!==typeof b&&b)if("object"===typeof b)if(d)T(p[0],b),T(p[1],d),T(p[2],e),T(p[3],c),T(p[4],f),T(p[5],g);else if(ca(h,b),ea(n,b),"faces"in b)for(b=b.faces,a(Array.isArray(b)&&6===b.length,"cube faces must be a length 6 array"),k=0;6>k;++k)a("object"===
typeof b[k]&&!!b[k],"invalid input for cube map face"),J(p[k],n),T(p[k],b[k]);else for(k=0;6>k;++k)T(p[k],b);else a.raise("invalid arguments to cube map");else for(b=b|0||1,k=0;6>k;++k)ba(p[k],b,b);J(n,p[0]);n.mipmask=h.genMipmaps?(p[0].width<<1)-1:p[0].mipmask;a.textureCube(n,h,p,q);n.internalformat=p[0].internalformat;l.width=p[0].width;l.height=p[0].height;na(n);for(k=0;6>k;++k)N(p[k],34069+k);ja(h,34067);oa();S.profile&&(n.stats.size=m(n.internalformat,n.type,l.width,l.height,h.genMipmaps,!0));
l.format=va[n.internalformat];l.type=Ea[n.type];l.mag=Ga[h.magFilter];l.min=Ja[h.minFilter];l.wrapS=Fa[h.wrapS];l.wrapT=Fa[h.wrapT];for(k=0;6>k;++k)ua(p[k]);return l}var n=new ma(34067);wa[n.id]=n;M.cubeCount++;var p=Array(6);l(d,c,f,g,k,h);l.subimage=function(b,d,e,c,f){a(!!d,"must specify image data");a("number"===typeof b&&b===(b|0)&&0<=b&&6>b,"invalid face");e|=0;c|=0;f|=0;var g=la();J(g,n);g.width=0;g.height=0;I(g,d);g.width=g.width||(n.width>>f)-e;g.height=g.height||(n.height>>f)-c;a(n.type===
g.type&&n.format===g.format&&n.internalformat===g.internalformat,"incompatible format for texture.subimage");a(0<=e&&0<=c&&e+g.width<=n.width&&c+g.height<=n.height,"texture.subimage write out of bounds");a(n.mipmask&1<<f,"missing mipmap data");a(g.data||g.element||g.needsCopy,"missing image data");na(n);sa(g,34069+b,e,c,f);oa();pa(g);return l};l.resize=function(a){a|=0;if(a!==n.width){l.width=n.width=a;l.height=n.height=a;na(n);for(var d=0;6>d;++d)for(var c=0;n.mipmask>>c;++c)b.texImage2D(34069+d,
c,n.format,a>>c,a>>c,0,n.format,n.type,null);oa();S.profile&&(n.stats.size=m(n.internalformat,n.type,l.width,l.height,!1,!0));return l}};l._reglType="textureCube";l._texture=n;S.profile&&(l.stats=n.stats);l.destroy=function(){n.decRef()};return l},clear:function(){for(var a=0;a<ta;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),da[a]=null;C(wa).forEach(qa);M.cubeCount=0;M.textureCount=0},getTexture:function(a){return null},restore:function(){C(wa).forEach(function(a){a.texture=b.createTexture();
b.bindTexture(a.target,a.texture);for(var c=0;32>c;++c)if(0!==(a.mipmask&1<<c))if(3553===a.target)b.texImage2D(3553,c,a.internalformat,a.width>>c,a.height>>c,0,a.internalformat,a.type,null);else for(var f=0;6>f;++f)b.texImage2D(34069+f,c,a.internalformat,a.width>>c,a.height>>c,0,a.internalformat,a.type,null);ja(a.texInfo,a.target)})}}}},{"./constants/arraytypes.json":4,"./util/check":21,"./util/extend":24,"./util/flatten":25,"./util/is-array-like":26,"./util/is-ndarray":27,"./util/is-typed-array":28,
"./util/pool":30,"./util/to-half-float":32,"./util/values":33}],20:[function(h,q,y){q.exports=function(c,g){function h(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function q(a,c,f){var g=p.pop()||new h;g.startQueryIndex=a;g.endQueryIndex=c;g.sum=0;g.stats=f;C.push(g)}var f=g.ext_disjoint_timer_query;if(!f)return null;var m=[],a=[],p=[],C=[],A=[],u=[];return{beginQuery:function(c){var g=m.pop()||f.createQueryEXT();f.beginQueryEXT(35007,g);a.push(g);q(a.length-1,a.length,
c)},endQuery:function(){f.endQueryEXT(35007)},pushScopeStats:q,update:function(){var c,g;c=a.length;if(0!==c){u.length=Math.max(u.length,c+1);A.length=Math.max(A.length,c+1);A[0]=0;var h=u[0]=0;for(g=c=0;g<a.length;++g){var l=a[g];f.getQueryObjectEXT(l,34919)?(h+=f.getQueryObjectEXT(l,34918),m.push(l)):a[c++]=l;A[g+1]=h;u[g+1]=c}a.length=c;for(g=c=0;g<C.length;++g){var h=C[g],q=h.startQueryIndex,l=h.endQueryIndex;h.sum+=A[l]-A[q];q=u[q];l=u[l];l===q?(h.stats.gpuTime+=h.sum/1E6,p.push(h)):(h.startQueryIndex=
q,h.endQueryIndex=l,C[c++]=h)}C.length=c}},getNumPendingQueries:function(){return a.length},clear:function(){m.push.apply(m,a);for(var c=0;c<m.length;c++)f.deleteQueryEXT(m[c]);a.length=0;m.length=0},restore:function(){a.length=0;m.length=0}}}},{}],21:[function(h,q,y){function c(a){return"undefined"!==typeof btoa?btoa(a):"base64:"+a}function g(a){a=Error("(regl) "+a);console.error(a);throw a;}function l(a,e){a||g(e)}function x(a){return a?": "+a:""}function f(a,e,c){0>e.indexOf(a)&&g("invalid value"+
x(c)+". must be one of: "+e)}function m(a,e){for(a+="";a.length<e;)a=" "+a;return a}function a(){this.name="unknown";this.lines=[];this.index={};this.hasErrors=!1}function p(a,e){this.number=a;this.line=e;this.errors=[]}function C(a,e,c){this.file=a;this.line=e;this.message=c}function A(){var a=Error(),a=(a.stack||a).toString(),e=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(a);return e?e[1]:(a=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(a))?a[1]:"unknown"}function u(){var a=Error(),a=(a.stack||a).toString(),
e=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(a);return e?e[1]:(a=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(a))?a[1]:"unknown"}function n(b,e){var f=b.split("\n"),g=1,k=0,h={unknown:new a,0:new a};h.unknown.name=h[0].name=e||A();h.unknown.lines.push(new p(0,""));for(var l=0;l<f.length;++l){var m=f[l],n=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(m);if(n)switch(n[1]){case "line":if(n=/(\d+)(\s+\d+)?/.exec(n[2]))g=n[1]|0,n[2]&&(k=n[2]|0,k in h||(h[k]=new a));break;case "define":if(n=/SHADER_NAME(_B64)?\s+(.*)$/.exec(n[2]))h[k].name=
n[1]?c(n[2]):n[2]}h[k].lines.push(new p(g++,m))}Object.keys(h).forEach(function(a){var b=h[a];b.lines.forEach(function(a){b.index[a.number]=a})});return h}function O(a){var e=[];a.split("\n").forEach(function(a){if(!(5>a.length)){var b=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(a);b?e.push(new C(b[1]|0,b[2]|0,b[3].trim())):0<a.length&&e.push(new C("unknown",0,a))}});return e}function z(a,e){e.forEach(function(e){var c=a[e.file];if(c){var f=c.index[e.line];if(f){f.errors.push(e);c.hasErrors=!0;return}}a.unknown.hasErrors=
!0;a.unknown.lines[0].errors.push(e)})}function G(a){a._commandRef=A()}function K(a,e){var c=u();g(a+" in command "+(e||A())+("unknown"===c?"":" called from "+c))}function k(a,e,c,f){typeof a!==e&&K("invalid parameter type"+x(c)+". expected "+e+", got "+typeof a,f||A())}function t(a,e){return 32820===a||32819===a||33635===a?2:34042===a?4:B[a]*e}var L=h("./is-typed-array");h=h("./extend");var M="gl canvas container attributes pixelRatio extensions optionalExtensions profile onDone".split(" "),B={};
B[5120]=B[5121]=1;B[5122]=B[5123]=B[36193]=B[33635]=B[32819]=B[32820]=2;B[5124]=B[5125]=B[5126]=B[34042]=4;q.exports=h(l,{optional:function(a){a()},raise:g,commandRaise:K,command:function(a,e,c){a||K(e,c||A())},parameter:function(a,e,c){a in e||g("unknown parameter ("+a+")"+x(c)+". possible values: "+Object.keys(e).join())},commandParameter:function(a,e,c,f){a in e||K("unknown parameter ("+a+")"+x(c)+". possible values: "+Object.keys(e).join(),f||A())},constructor:function(a){Object.keys(a).forEach(function(a){0>
M.indexOf(a)&&g('invalid regl constructor argument "'+a+'". must be one of '+M)})},type:function(a,e,c){typeof a!==e&&g("invalid parameter type"+x(c)+". expected "+e+", got "+typeof a)},commandType:k,isTypedArray:function(a,e){L(a)||g("invalid parameter type"+x(e)+". must be a typed array")},nni:function(a,e){0<=a&&(a|0)===a||g("invalid parameter type, ("+a+")"+x(e)+". must be a nonnegative integer")},oneOf:f,shaderError:function(a,e,c,f,g){if(!a.getShaderParameter(e,a.COMPILE_STATUS)){e=a.getShaderInfoLog(e);
a=f===a.FRAGMENT_SHADER?"fragment":"vertex";k(c,"string",a+" shader source must be a string",g);var h=n(c,g);c=O(e);z(h,c);Object.keys(h).forEach(function(a){function b(a,e){c.push(a);f.push(e||"")}var e=h[a];if(e.hasErrors){var c=[""],f=[""];b("file number "+a+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold");e.lines.forEach(function(a){if(0<a.errors.length){b(m(a.number,4)+"|  ","background-color:yellow; font-weight:bold");b(a.line+"\n","color:red; background-color:yellow; font-weight:bold");
var e=0;a.errors.forEach(function(c){c=c.message;var f=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(c);if(f){var g=f[1];c=f[2];switch(g){case "assign":g="="}e=Math.max(a.line.indexOf(g,e),0)}else e=0;b(m("| ",6));b(m("^^^",e+3)+"\n","font-weight:bold");b(m("| ",6));b(c+"\n","font-weight:bold")});b(m("| ",6)+"\n")}else b(m(a.number,4)+"|  "),b(a.line+"\n","color:red")});"undefined"!==typeof document?(f[0]=c.join("%c"),console.log.apply(console,f)):console.log(c.join(""))}});l.raise("Error compiling "+a+" shader, "+
h[0].name)}},linkError:function(a,e,c,f,g){a.getProgramParameter(e,a.LINK_STATUS)||(a=a.getProgramInfoLog(e),c=n(c,g),f='Error linking program with vertex shader, "'+n(f,g)[0].name+'", and fragment shader "'+c[0].name+'"',"undefined"!==typeof document?console.log("%c"+f+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+"\n"+a),l.raise(f))},callSite:u,saveCommandRef:G,saveDrawInfo:function(a,e,c,f){function g(a){return a?f.id(a):0}function k(a,b){Object.keys(b).forEach(function(b){a[f.id(b)]=
!0})}G(a);a._fragId=g(a["static"].frag);a._vertId=g(a["static"].vert);var h=a._uniformSet={};k(h,e["static"]);k(h,e.dynamic);e=a._attributeSet={};k(e,c["static"]);k(e,c.dynamic);a._hasCount="count"in a["static"]||"count"in a.dynamic||"elements"in a["static"]||"elements"in a.dynamic},framebufferFormat:function(a,e,c){a.texture?f(a.texture._texture.internalformat,e,"unsupported texture format for attachment"):f(a.renderbuffer._renderbuffer.format,c,"unsupported renderbuffer format for attachment")},
guessCommand:A,texture2D:function(a,e,c){var f=e.width,g=e.height,k=e.channels;l(0<f&&f<=c.maxTextureSize&&0<g&&g<=c.maxTextureSize,"invalid texture shape");33071===a.wrapS&&33071===a.wrapT||l(!(f&f-1)&&!!f&&!(g&g-1)&&!!g,"incompatible wrap mode for texture, both width and height must be power of 2");1===e.mipmask?1!==f&&1!==g&&l(9984!==a.minFilter&&9986!==a.minFilter&&9985!==a.minFilter&&9987!==a.minFilter,"min filter requires mipmap"):(l(!(f&f-1)&&!!f&&!(g&g-1)&&!!g,"texture must be a square power of 2 to support mipmapping"),
l(e.mipmask===(f<<1)-1,"missing or incomplete mipmap data"));5126===e.type&&(0>c.extensions.indexOf("oes_texture_float_linear")&&l(9728===a.minFilter&&9728===a.magFilter,"filter not supported, must enable oes_texture_float_linear"),l(!a.genMipmaps,"mipmap generation not supported with float textures"));var h=e.images;for(c=0;16>c;++c)if(h[c]){var m=f>>c,n=g>>c;l(e.mipmask&1<<c,"missing mipmap data");var p=h[c];l(p.width===m&&p.height===n,"invalid shape for mip images");l(p.format===e.format&&p.internalformat===
e.internalformat&&p.type===e.type,"incompatible type for mip image");p.compressed||p.data&&l(p.data.byteLength===m*n*Math.max(t(p.type,k),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}else a.genMipmaps||l(0===(e.mipmask&1<<c),"extra mipmap data");e.compressed&&l(!a.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(a,e,c,f){var g=a.width,k=a.height,h=a.channels;l(0<g&&g<=f.maxTextureSize&&0<k&&k<=f.maxTextureSize,
"invalid texture shape");l(g===k,"cube map must be square");l(33071===e.wrapS&&33071===e.wrapT,"wrap mode not supported by cube map");for(f=0;f<c.length;++f){var m=c[f];l(m.width===g&&m.height===k,"inconsistent cube map face shape");e.genMipmaps&&(l(!m.compressed,"can not generate mipmap for compressed textures"),l(1===m.mipmask,"can not specify mipmaps and generate mipmaps"));for(var n=m.images,p=0;16>p;++p){var u=n[p];if(u){var q=g>>p,x=k>>p;l(m.mipmask&1<<p,"missing mipmap data");l(u.width===q&&
u.height===x,"invalid shape for mip images");l(u.format===a.format&&u.internalformat===a.internalformat&&u.type===a.type,"incompatible type for mip image");u.compressed||u.data&&l(u.data.byteLength===q*x*Math.max(t(u.type,h),u.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}})},{"./extend":24,"./is-typed-array":28}],22:[function(h,q,y){q.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},
{}],23:[function(h,q,y){function c(c){return Array.prototype.slice.call(c)}function g(g){return c(g).join("")}var l=h("./extend");q.exports=function(){function h(){var a=[],f=[];return l(function(){a.push.apply(a,c(arguments))},{def:function(){var g="v"+m++;f.push(g);0<arguments.length&&(a.push(g,"="),a.push.apply(a,c(arguments)),a.push(";"));return g},toString:function(){return g([0<f.length?"var "+f+";":"",g(a)])}})}function f(){function a(c,k){g(c,k,"=",f.def(c,k),";")}var f=h(),g=h(),m=f.toString,
p=g.toString;return l(function(){f.apply(f,c(arguments))},{def:f.def,entry:f,exit:g,save:a,set:function(c,g,h){a(c,g);f(c,g,"=",h,";")},toString:function(){return m()+p()}})}var m=0,a=[],p=[],q=h(),A={};return{global:q,link:function(c){for(var f=0;f<p.length;++f)if(p[f]===c)return a[f];f="g"+m++;a.push(f);p.push(c);return f},block:h,proc:function(a,c){function h(){var a="a"+m.length;m.push(a);return a}var m=[];c=c||0;for(var p=0;p<c;++p)h();var p=f(),q=p.toString;return A[a]=l(p,{arg:h,toString:function(){return g(["function(",
m.join(),"){",q(),"}"])}})},scope:f,cond:function(){var a=g(arguments),h=f(),m=f(),p=h.toString,q=m.toString;return l(h,{then:function(){h.apply(h,c(arguments));return this},"else":function(){m.apply(m,c(arguments));return this},toString:function(){var c=q();c&&(c="else{"+c+"}");return g(["if(",a,"){",p(),"}",c])}})},compile:function(){var c=['"use strict";',q,"return {"];Object.keys(A).forEach(function(a){c.push('"',a,'":',A[a].toString(),",")});c.push("}");var f=g(c).replace(/;/g,";\n").replace(/}/g,
"}\n").replace(/{/g,"{\n");return Function.apply(null,a.concat(f)).apply(null,p)}}}},{"./extend":24}],24:[function(h,q,y){q.exports=function(c,g){for(var h=Object.keys(g),q=0;q<h.length;++q)c[h[q]]=g[h[q]];return c}},{}],25:[function(h,q,y){function c(c,f,g,a,h,l){for(var q=0;q<f;++q)for(var u=c[q],n=0;n<g;++n)for(var y=u[n],z=0;z<a;++z)h[l++]=y[z]}function g(h,f,m,a,l){for(var q=1,A=m+1;A<f.length;++A)q*=f[A];var u=f[m];if(4===f.length-m){var n=f[m+1],y=f[m+2];f=f[m+3];for(A=0;A<u;++A)c(h[A],n,y,
f,a,l),l+=q}else for(A=0;A<u;++A)g(h[A],f,m+1,a,l),l+=q}var l=h("./pool");q.exports={shape:function(c){for(var f=[];c.length;c=c[0])f.push(c.length);return f},flatten:function(h,f,m,a){var p=1;if(f.length)for(var q=0;q<f.length;++q)p*=f[q];else p=0;m=a||l.allocType(m,p);switch(f.length){case 0:break;case 1:a=f[0];for(f=0;f<a;++f)m[f]=h[f];break;case 2:a=f[0];f=f[1];for(q=p=0;q<a;++q)for(var A=h[q],u=0;u<f;++u)m[p++]=A[u];break;case 3:c(h,f[0],f[1],f[2],m,0);break;default:g(h,f,0,m,0)}return m}}},
{"./pool":30}],26:[function(h,q,y){var c=h("./is-typed-array");q.exports=function(g){return Array.isArray(g)||c(g)}},{"./is-typed-array":28}],27:[function(h,q,y){var c=h("./is-typed-array");q.exports=function(g){return!!g&&"object"===typeof g&&Array.isArray(g.shape)&&Array.isArray(g.stride)&&"number"===typeof g.offset&&g.shape.length===g.stride.length&&(Array.isArray(g.data)||c(g.data))}},{"./is-typed-array":28}],28:[function(h,q,y){var c=h("../constants/arraytypes.json");q.exports=function(g){return Object.prototype.toString.call(g)in
c}},{"../constants/arraytypes.json":4}],29:[function(h,q,y){q.exports=function(c,g){for(var h=Array(c),q=0;q<c;++q)h[q]=g(q);return h}},{}],30:[function(h,q,y){function c(c){var g,a;g=(65535<c)<<4;c>>>=g;a=(255<c)<<3;c>>>=a;g|=a;a=(15<c)<<2;c>>>=a;g|=a;a=(3<c)<<1;return g|a|c>>>a>>1}function g(f){a:{for(var g=16;268435456>=g;g*=16)if(f<=g){f=g;break a}f=0}g=x[c(f)>>2];return 0<g.length?g.pop():new ArrayBuffer(f)}function l(f){x[c(f.byteLength)>>2].push(f)}var x=h("./loop")(8,function(){return[]});
q.exports={alloc:g,free:l,allocType:function(c,h){var a=null;switch(c){case 5120:a=new Int8Array(g(h),0,h);break;case 5121:a=new Uint8Array(g(h),0,h);break;case 5122:a=new Int16Array(g(2*h),0,h);break;case 5123:a=new Uint16Array(g(2*h),0,h);break;case 5124:a=new Int32Array(g(4*h),0,h);break;case 5125:a=new Uint32Array(g(4*h),0,h);break;case 5126:a=new Float32Array(g(4*h),0,h);break;default:return null}return a.length!==h?a.subarray(0,h):a},freeType:function(c){l(c.buffer)}}},{"./loop":29}],31:[function(h,
q,y){q.exports={next:"function"===typeof requestAnimationFrame?function(c){return requestAnimationFrame(c)}:function(c){return setTimeout(c,16)},cancel:"function"===typeof cancelAnimationFrame?function(c){return cancelAnimationFrame(c)}:clearTimeout}},{}],32:[function(h,q,y){var c=h("./pool"),g=new Float32Array(1),l=new Uint32Array(g.buffer);q.exports=function(h){for(var f=c.allocType(5123,h.length),m=0;m<h.length;++m)if(isNaN(h[m]))f[m]=65535;else if(Infinity===h[m])f[m]=31744;else if(-Infinity===
h[m])f[m]=64512;else{g[0]=h[m];var a=l[0],p=a>>>31<<15,q=(a<<1>>>24)-127,a=a>>13&1023;f[m]=-24>q?p:-14>q?p+(a+1024>>-14-q):15<q?p+31744:p+(q+15<<10)+a}return f}},{"./pool":30}],33:[function(h,q,y){q.exports=function(c){return Object.keys(c).map(function(g){return c[g]})}},{}],34:[function(h,q,y){function c(a,c,f){function g(){var c=window.innerWidth,l=window.innerHeight;a!==document.body&&(l=a.getBoundingClientRect(),c=l.right-l.left,l=l.bottom-l.top);h.width=f*c;h.height=f*l;m(h.style,{width:c+"px",
height:l+"px"})}var h=document.createElement("canvas");m(h.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(h);a===document.body&&(h.style.position="absolute",m(a.style,{margin:0,padding:0}));window.addEventListener("resize",g,!1);g();return{canvas:h,onDestroy:function(){window.removeEventListener("resize",g);a.removeChild(h)}}}function g(a,c){function f(g){try{return a.getContext(g,c)}catch(h){return null}}return f("webgl")||f("experimental-webgl")||f("webgl-experimental")}function l(a){if("string"===
typeof a)return a.split();f(Array.isArray(a),"invalid extension array");return a}function x(a){return"string"===typeof a?(f("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(a)):a}var f=h("./util/check"),m=h("./util/extend");q.exports=function(a){var h=a||{},m,q,u,n;a={};var y=[],z=[],G="undefined"===typeof window?1:window.devicePixelRatio,K=!1,k=function(a){a&&f.raise(a)},t=function(){};"string"===typeof h?(f("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),
m=document.querySelector(h),f(m,"invalid query string for element")):"object"===typeof h?"string"===typeof h.nodeName&&"function"===typeof h.appendChild&&"function"===typeof h.getBoundingClientRect?m=h:"function"===typeof h.drawArrays||"function"===typeof h.drawElements?(n=h,u=n.canvas):(f.constructor(h),"gl"in h?n=h.gl:"canvas"in h?u=x(h.canvas):"container"in h&&(q=x(h.container)),"attributes"in h&&(a=h.attributes,f.type(a,"object","invalid context attributes")),"extensions"in h&&(y=l(h.extensions)),
"optionalExtensions"in h&&(z=l(h.optionalExtensions)),"onDone"in h&&(f.type(h.onDone,"function","invalid or missing onDone callback"),k=h.onDone),"profile"in h&&(K=!!h.profile),"pixelRatio"in h&&(G=+h.pixelRatio,f(0<G,"invalid pixel ratio"))):f.raise("invalid arguments to regl");m&&("canvas"===m.nodeName.toLowerCase()?u=m:q=m);if(!n){if(!u){f("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");m=c(q||document.body,k,G);if(!m)return null;u=m.canvas;t=m.onDestroy}n=
g(u,a)}return n?{gl:n,canvas:u,container:q,extensions:y,optionalExtensions:z,pixelRatio:G,profile:K,onDone:k,onDestroy:t}:(t(),k("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/check":21,"./util/extend":24}],35:[function(h,q,y){q.exports=function(g,h){function q(a){var c=!1;"altKey"in a&&(c=c||a.altKey!==k.alt,k.alt=!!a.altKey);"shiftKey"in a&&(c=c||a.shiftKey!==k.shift,k.shift=!!a.shiftKey);"ctrlKey"in a&&(c=c||a.ctrlKey!==k.control,k.control=
!!a.ctrlKey);"metaKey"in a&&(c=c||a.metaKey!==k.meta,k.meta=!!a.metaKey);return c}function f(a,f){var b=c.x(f),e=c.y(f);"buttons"in f&&(a=f.buttons|0);if(a!==z||b!==G||e!==K||q(f))z=a|0,G=b||0,K=e||0,h&&h(z,G,K,k)}function m(a){f(0,a)}function a(){if(z||G||K||k.shift||k.alt||k.meta||k.control)z=G=K=0,k.shift=k.alt=k.control=k.meta=!1,h&&h(0,0,0,k)}function p(a){q(a)&&h&&h(z,G,K,k)}function y(a){0===c.buttons(a)?f(0,a):f(z,a)}function A(a){f(z|c.buttons(a),a)}function u(a){f(z&~c.buttons(a),a)}function n(){t||
(t=!0,g.addEventListener("mousemove",y),g.addEventListener("mousedown",A),g.addEventListener("mouseup",u),g.addEventListener("mouseleave",m),g.addEventListener("mouseenter",m),g.addEventListener("mouseout",m),g.addEventListener("mouseover",m),g.addEventListener("blur",a),g.addEventListener("keyup",p),g.addEventListener("keydown",p),g.addEventListener("keypress",p),g!==window&&(window.addEventListener("blur",a),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",
p)))}function O(){t&&(t=!1,g.removeEventListener("mousemove",y),g.removeEventListener("mousedown",A),g.removeEventListener("mouseup",u),g.removeEventListener("mouseleave",m),g.removeEventListener("mouseenter",m),g.removeEventListener("mouseout",m),g.removeEventListener("mouseover",m),g.removeEventListener("blur",a),g.removeEventListener("keyup",p),g.removeEventListener("keydown",p),g.removeEventListener("keypress",p),g!==window&&(window.removeEventListener("blur",a),window.removeEventListener("keyup",
p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}h||(h=g,g=window);var z=0,G=0,K=0,k={shift:!1,alt:!1,control:!1,meta:!1},t=!1;n();var L={element:g};Object.defineProperties(L,{enabled:{get:function(){return t},set:function(a){a?n():O},enumerable:!0},buttons:{get:function(){return z},enumerable:!0},x:{get:function(){return G},enumerable:!0},y:{get:function(){return K},enumerable:!0},mods:{get:function(){return k},enumerable:!0}});return L};var c=h("mouse-event")},
{"mouse-event":36}],36:[function(h,q,y){function c(c){return c.target||c.srcElement||window}y.buttons=function(c){if("object"===typeof c){if("buttons"in c)return c.buttons;if("which"in c){c=c.which;if(2===c)return 4;if(3===c)return 2;if(0<c)return 1<<c-1}else if("button"in c){c=c.button;if(1===c)return 4;if(2===c)return 2;if(0<=c)return 1<<c}}return 0};y.element=c;y.x=function(g){if("object"===typeof g){if("offsetX"in g)return g.offsetX;var h=c(g).getBoundingClientRect();return g.clientX-h.left}return 0};
y.y=function(g){if("object"===typeof g){if("offsetY"in g)return g.offsetY;var h=c(g).getBoundingClientRect();return g.clientY-h.top}return 0}},{}],37:[function(h,q,y){function c(a,c){for(var f=0;f<a.length;++f)if(a[f]===c)return f;return-1}var g=h("./lib/util/check"),l=h("./lib/util/extend"),x=h("./lib/dynamic"),f=h("./lib/util/raf"),m=h("./lib/util/clock"),a=h("./lib/strings"),p=h("./lib/webgl"),C=h("./lib/extension"),A=h("./lib/limits"),u=h("./lib/buffer"),n=h("./lib/elements"),O=h("./lib/texture"),
z=h("./lib/renderbuffer"),G=h("./lib/framebuffer"),K=h("./lib/attribute"),k=h("./lib/shader"),t=h("./lib/read"),L=h("./lib/core"),M=h("./lib/stats"),B=h("./lib/timer");q.exports=function(b){function e(){if(0===R.length)N&&N.update(),ha=null;else{ha=f.next(e);ea();for(var a=R.length-1;0<=a;--a){var b=R[a];b&&b(ca,null,0)}I.flush();N&&N.update()}}function h(){!ha&&0<R.length&&(ha=f.next(e))}function q(){ha&&(f.cancel(e),ha=null)}function y(a){a.preventDefault();la=!0;q();aa.forEach(function(a){a()})}
function ra(a){I.getError();la=!1;pa.restore();oa.restore();ma.restore();qa.restore();za.restore();X.restore();N&&N.restore();Q.procs.refresh();h();fa.forEach(function(a){a()})}function ka(a){function b(a){var c={},e={};Object.keys(a).forEach(function(b){var f=a[b];x.isDynamic(f)?e[b]=x.unbox(f,b):c[b]=f});return{dynamic:e,"static":c}}function c(a){for(;q.length<a;)q.push(null);return q}g(!!a,"invalid args to regl({...})");g.type(a,"object","invalid args to regl({...})");var e=b(a.context||{}),f=
b(a.uniforms||{}),h=b(a.attributes||{}),k=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=l({},a);delete c.uniforms;delete c.attributes;delete c.context;"stencil"in c&&c.stencil.op&&(c.stencil.opBack=c.stencil.opFront=c.stencil.op,delete c.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));a={gpuTime:0,cpuTime:0,count:0};var e=Q.compile(k,h,f,e,a),m=e.draw,n=e.batch,
p=e.scope,q=[];return l(function(a,b){var e;la&&g.raise("context lost");if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(e=0;e<a;++e)p.call(this,null,b,e);else if(Array.isArray(a))for(e=0;e<a.length;++e)p.call(this,a[e],b,e);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return m.call(this,a)},{stats:a})}function S(a,
b){var c=0;Q.procs.poll();var e=b.color;e&&(I.clearColor(+e[0]||0,+e[1]||0,+e[2]||0,+e[3]||0),c|=16384);"depth"in b&&(I.clearDepth(+b.depth),c|=256);"stencil"in b&&(I.clearStencil(b.stencil|0),c|=1024);g(!!c,"called regl.clear with no buffer specified");I.clear(c)}function ia(a){g.type(a,"function","regl.frame() callback must be a function");R.push(a);h();return{cancel:function(){function b(){var a=c(R,b);R[a]=R[R.length-1];--R.length;0>=R.length&&q()}var e=c(R,a);g(0<=e,"cannot cancel a frame twice");
R[e]=b}}}function J(){var a=ga.viewport,b=ga.scissor_box;a[0]=a[1]=b[0]=b[1]=0;ca.viewportWidth=ca.framebufferWidth=ca.drawingBufferWidth=a[2]=b[2]=I.drawingBufferWidth;ca.viewportHeight=ca.framebufferHeight=ca.drawingBufferHeight=a[3]=b[3]=I.drawingBufferHeight}function ea(){ca.tick+=1;ca.time=U();J();Q.procs.poll()}function Y(){J();Q.procs.refresh();N&&N.update()}function U(){return(m()-Da)/1E3}b=p(b);if(!b)return null;var I=b.gl,sa=I.getContextAttributes(),la=I.isContextLost(),pa=C(I,b);if(!pa)return null;
var xa=a(),ba=M(),T=pa.extensions,N=B(I,T),Da=m(),ua=I.drawingBufferWidth,ya=I.drawingBufferHeight,ca={tick:0,time:0,viewportWidth:ua,viewportHeight:ya,framebufferWidth:ua,framebufferHeight:ya,drawingBufferWidth:ua,drawingBufferHeight:ya,pixelRatio:b.pixelRatio},ja=A(I,T),ma=u(I,ba,b),na=n(I,T,ma,ba),ua=K(I,T,ja,ma,xa),oa=k(I,xa,ba,b),qa=O(I,T,ja,function(){Q.procs.poll()},ca,ba,b),za=z(I,T,ja,ba,b),X=G(I,T,ja,qa,za,ba),Q=L(I,xa,T,ja,ma,na,qa,X,{},ua,oa,{elements:null,primitive:4,count:-1,offset:0,
instances:-1},ca,N,b),xa=t(I,X,Q.procs.poll,ca,sa,T),ga=Q.next,W=I.canvas,R=[],aa=[],fa=[],Aa=[b.onDestroy],ha=null;W&&(W.addEventListener("webglcontextlost",y,!1),W.addEventListener("webglcontextrestored",ra,!1));var va=X.setFBO=ka({framebuffer:x.define.call(null,1,"framebuffer")});Y();sa=l(ka,{clear:function(a){g("object"===typeof a&&a,"regl.clear() takes an object as input");if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)va(l({framebuffer:a.framebuffer.faces[b]},
a),S);else va(a,S);else S(null,a)},prop:x.define.bind(null,1),context:x.define.bind(null,2),"this":x.define.bind(null,3),draw:ka({}),buffer:function(a){return ma.create(a,34962,!1,!1)},elements:function(a){return na.create(a,!1)},texture:qa.create2D,cube:qa.createCube,renderbuffer:za.create,framebuffer:X.create,framebufferCube:X.createCube,attributes:sa,frame:ia,on:function(a,b){g.type(b,"function","listener callback must be a function");var c;switch(a){case "frame":return ia(b);case "lost":c=aa;
break;case "restore":c=fa;break;case "destroy":c=Aa;break;default:g.raise("invalid event, must be one of frame,lost,restore,destroy")}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ja,hasExtension:function(a){return 0<=ja.extensions.indexOf(a.toLowerCase())},read:xa,destroy:function(){R.length=0;q();W&&(W.removeEventListener("webglcontextlost",y),W.removeEventListener("webglcontextrestored",ra));oa.clear();X.clear();za.clear();
qa.clear();na.clear();ma.clear();N&&N.clear();Aa.forEach(function(a){a()})},_gl:I,_refresh:Y,poll:function(){ea();N&&N.update()},now:U,stats:ba});b.onDone(null,sa);return sa}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/check":21,"./lib/util/clock":22,
"./lib/util/extend":24,"./lib/util/raf":31,"./lib/webgl":34}]},{},[1]);

        </script>
        </body>
      </html>